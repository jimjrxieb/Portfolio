{
  "success": true,
  "findings": [
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Runs with UID <= 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "file": "GP-copilot/conftest-policies/fixtures/secure-deployment.yaml",
      "line": 25,
      "rule_id": "KSV020",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'secure-container' of Deployment 'secure-app' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 25,
          "EndLine": 62,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "        - name: secure-container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: secure-container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "          image: ghcr.io/jimjrxieb/portfolio-ui:v1.2.3  # Specific version tag from trusted registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: ghcr.io/jimjrxieb/portfolio-ui:v1.2.3  \u001b[38;5;239m# Specific version tag from trusted registry",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "          imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "            runAsNonRoot: true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "            runAsUser: 1000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m1000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "            runAsGroup: 1000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m1000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            privileged: false",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mfalse",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "            allowPrivilegeEscalation: false",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 34,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Runs with GID <= 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "file": "GP-copilot/conftest-policies/fixtures/secure-deployment.yaml",
      "line": 25,
      "rule_id": "KSV021",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'secure-container' of Deployment 'secure-app' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 25,
          "EndLine": 62,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "        - name: secure-container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: secure-container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "          image: ghcr.io/jimjrxieb/portfolio-ui:v1.2.3  # Specific version tag from trusted registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: ghcr.io/jimjrxieb/portfolio-ui:v1.2.3  \u001b[38;5;239m# Specific version tag from trusted registry",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "          imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "            runAsNonRoot: true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "            runAsUser: 1000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m1000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "            runAsGroup: 1000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m1000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            privileged: false",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mfalse",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "            allowPrivilegeEscalation: false",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 34,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Runtime/Default Seccomp profile not set",
      "description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
      "file": "GP-copilot/conftest-policies/fixtures/secure-deployment.yaml",
      "line": 25,
      "rule_id": "KSV030",
      "remediation": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv030"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV030",
        "AVDID": "AVD-KSV-0030",
        "Title": "Runtime/Default Seccomp profile not set",
        "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
        "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
        "Namespace": "builtin.kubernetes.KSV030",
        "Query": "data.builtin.kubernetes.KSV030.deny",
        "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv030"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 25,
          "EndLine": 62,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "        - name: secure-container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: secure-container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "          image: ghcr.io/jimjrxieb/portfolio-ui:v1.2.3  # Specific version tag from trusted registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: ghcr.io/jimjrxieb/portfolio-ui:v1.2.3  \u001b[38;5;239m# Specific version tag from trusted registry",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "          imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "            runAsNonRoot: true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "            runAsUser: 1000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m1000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "            runAsGroup: 1000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m1000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            privileged: false",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mfalse",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "            allowPrivilegeEscalation: false",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 34,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "Seccomp policies disabled",
      "description": "A program inside the container can bypass Seccomp protection policies.",
      "file": "GP-copilot/conftest-policies/fixtures/secure-deployment.yaml",
      "line": null,
      "rule_id": "KSV104",
      "remediation": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv104"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV104",
        "AVDID": "AVD-KSV-0104",
        "Title": "Seccomp policies disabled",
        "Description": "A program inside the container can bypass Seccomp protection policies.",
        "Message": "container \"secure-container\" of deployment \"secure-app\" in \"portfolio\" namespace should specify a seccomp profile",
        "Namespace": "builtin.kubernetes.KSV104",
        "Query": "data.builtin.kubernetes.KSV104.deny",
        "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "Can elevate its own privileges",
      "description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 18,
      "rule_id": "KSV001",
      "remediation": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv001"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV001",
        "AVDID": "AVD-KSV-0001",
        "Title": "Can elevate its own privileges",
        "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
        "Message": "Container 'bad-container' of Deployment 'vulnerable-app' should set 'securityContext.allowPrivilegeEscalation' to false",
        "Namespace": "builtin.kubernetes.KSV001",
        "Query": "data.builtin.kubernetes.KSV001.deny",
        "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv001"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 18,
          "EndLine": 26,
          "Code": {
            "Lines": [
              {
                "Number": 18,
                "Content": "        - name: bad-container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: bad-container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "          image: nginx:latest  # Violation: latest tag",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: nginx:latest  # Violation\u001b[0m: latest tag",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "            runAsUser: 0  # Violation: running as root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsUser: 0  # Violation\u001b[0m: running as root",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "            privileged: true  # Violation: privileged mode",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mprivileged: true  # Violation\u001b[0m: privileged mode",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "            allowPrivilegeEscalation: true  # Violation: privilege escalation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\u001b[0m: privilege escalation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "            readOnlyRootFilesystem: false  # Violation: writable filesystem",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\u001b[0m: writable filesystem",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "              add: [\"SYS_ADMIN\"]  # Violation: dangerous capability",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33madd\u001b[0m: [\u001b[38;5;37m\"SYS_ADMIN\"\u001b[0m\u001b[38;5;33m]  # Violation\u001b[0m: dangerous capability",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "Can elevate its own privileges",
      "description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 29,
      "rule_id": "KSV001",
      "remediation": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv001"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV001",
        "AVDID": "AVD-KSV-0001",
        "Title": "Can elevate its own privileges",
        "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
        "Message": "Container 'disallowed-registry' of Deployment 'vulnerable-app' should set 'securityContext.allowPrivilegeEscalation' to false",
        "Namespace": "builtin.kubernetes.KSV001",
        "Query": "data.builtin.kubernetes.KSV001.deny",
        "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv001"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 29,
          "EndLine": 32,
          "Code": {
            "Lines": [
              {
                "Number": 29,
                "Content": "        - name: disallowed-registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: disallowed-registry",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "          image: docker.io/ubuntu:20.04  # Violation: disallowed registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\u001b[0m: disallowed registry",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            runAsNonRoot: false  # Violation: allows root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot: false  # Violation\u001b[0m: allows root",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Default capabilities: some containers do not drop all",
      "description": "The container should drop all default capabilities and add only those that are needed for its execution.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 18,
      "rule_id": "KSV003",
      "remediation": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
        "https://avd.aquasec.com/misconfig/ksv003"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV003",
        "AVDID": "AVD-KSV-0003",
        "Title": "Default capabilities: some containers do not drop all",
        "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
        "Message": "Container 'bad-container' of Deployment 'vulnerable-app' should add 'ALL' to 'securityContext.capabilities.drop'",
        "Namespace": "builtin.kubernetes.KSV003",
        "Query": "data.builtin.kubernetes.KSV003.deny",
        "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
          "https://avd.aquasec.com/misconfig/ksv003"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 18,
          "EndLine": 26,
          "Code": {
            "Lines": [
              {
                "Number": 18,
                "Content": "        - name: bad-container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: bad-container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "          image: nginx:latest  # Violation: latest tag",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: nginx:latest  # Violation\u001b[0m: latest tag",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "            runAsUser: 0  # Violation: running as root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsUser: 0  # Violation\u001b[0m: running as root",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "            privileged: true  # Violation: privileged mode",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mprivileged: true  # Violation\u001b[0m: privileged mode",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "            allowPrivilegeEscalation: true  # Violation: privilege escalation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\u001b[0m: privilege escalation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "            readOnlyRootFilesystem: false  # Violation: writable filesystem",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\u001b[0m: writable filesystem",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "              add: [\"SYS_ADMIN\"]  # Violation: dangerous capability",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33madd\u001b[0m: [\u001b[38;5;37m\"SYS_ADMIN\"\u001b[0m\u001b[38;5;33m]  # Violation\u001b[0m: dangerous capability",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Default capabilities: some containers do not drop all",
      "description": "The container should drop all default capabilities and add only those that are needed for its execution.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 29,
      "rule_id": "KSV003",
      "remediation": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
        "https://avd.aquasec.com/misconfig/ksv003"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV003",
        "AVDID": "AVD-KSV-0003",
        "Title": "Default capabilities: some containers do not drop all",
        "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
        "Message": "Container 'disallowed-registry' of Deployment 'vulnerable-app' should add 'ALL' to 'securityContext.capabilities.drop'",
        "Namespace": "builtin.kubernetes.KSV003",
        "Query": "data.builtin.kubernetes.KSV003.deny",
        "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
          "https://avd.aquasec.com/misconfig/ksv003"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 29,
          "EndLine": 32,
          "Code": {
            "Lines": [
              {
                "Number": 29,
                "Content": "        - name: disallowed-registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: disallowed-registry",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "          image: docker.io/ubuntu:20.04  # Violation: disallowed registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\u001b[0m: disallowed registry",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            runAsNonRoot: false  # Violation: allows root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot: false  # Violation\u001b[0m: allows root",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "SYS_ADMIN capability added",
      "description": "SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 18,
      "rule_id": "KSV005",
      "remediation": "Remove the SYS_ADMIN capability from 'containers[].securityContext.capabilities.add'.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-capabilities-add-index-sys-admin/",
        "https://avd.aquasec.com/misconfig/ksv005"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV005",
        "AVDID": "AVD-KSV-0005",
        "Title": "SYS_ADMIN capability added",
        "Description": "SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.",
        "Message": "Container 'bad-container' of Deployment 'vulnerable-app' should not include 'SYS_ADMIN' in 'securityContext.capabilities.add'",
        "Namespace": "builtin.kubernetes.KSV005",
        "Query": "data.builtin.kubernetes.KSV005.deny",
        "Resolution": "Remove the SYS_ADMIN capability from 'containers[].securityContext.capabilities.add'.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv005",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-capabilities-add-index-sys-admin/",
          "https://avd.aquasec.com/misconfig/ksv005"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 18,
          "EndLine": 26,
          "Code": {
            "Lines": [
              {
                "Number": 18,
                "Content": "        - name: bad-container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: bad-container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "          image: nginx:latest  # Violation: latest tag",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: nginx:latest  # Violation\u001b[0m: latest tag",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "            runAsUser: 0  # Violation: running as root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsUser: 0  # Violation\u001b[0m: running as root",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "            privileged: true  # Violation: privileged mode",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mprivileged: true  # Violation\u001b[0m: privileged mode",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "            allowPrivilegeEscalation: true  # Violation: privilege escalation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\u001b[0m: privilege escalation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "            readOnlyRootFilesystem: false  # Violation: writable filesystem",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\u001b[0m: writable filesystem",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "              add: [\"SYS_ADMIN\"]  # Violation: dangerous capability",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33madd\u001b[0m: [\u001b[38;5;37m\"SYS_ADMIN\"\u001b[0m\u001b[38;5;33m]  # Violation\u001b[0m: dangerous capability",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "CPU not limited",
      "description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 18,
      "rule_id": "KSV011",
      "remediation": "Set a limit value under 'containers[].resources.limits.cpu'.",
      "references": [
        "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
        "https://avd.aquasec.com/misconfig/ksv011"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV011",
        "AVDID": "AVD-KSV-0011",
        "Title": "CPU not limited",
        "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
        "Message": "Container 'bad-container' of Deployment 'vulnerable-app' should set 'resources.limits.cpu'",
        "Namespace": "builtin.kubernetes.KSV011",
        "Query": "data.builtin.kubernetes.KSV011.deny",
        "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
        "References": [
          "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
          "https://avd.aquasec.com/misconfig/ksv011"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 18,
          "EndLine": 26,
          "Code": {
            "Lines": [
              {
                "Number": 18,
                "Content": "        - name: bad-container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: bad-container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "          image: nginx:latest  # Violation: latest tag",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: nginx:latest  # Violation\u001b[0m: latest tag",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "            runAsUser: 0  # Violation: running as root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsUser: 0  # Violation\u001b[0m: running as root",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "            privileged: true  # Violation: privileged mode",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mprivileged: true  # Violation\u001b[0m: privileged mode",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "            allowPrivilegeEscalation: true  # Violation: privilege escalation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\u001b[0m: privilege escalation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "            readOnlyRootFilesystem: false  # Violation: writable filesystem",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\u001b[0m: writable filesystem",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "              add: [\"SYS_ADMIN\"]  # Violation: dangerous capability",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33madd\u001b[0m: [\u001b[38;5;37m\"SYS_ADMIN\"\u001b[0m\u001b[38;5;33m]  # Violation\u001b[0m: dangerous capability",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "CPU not limited",
      "description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 29,
      "rule_id": "KSV011",
      "remediation": "Set a limit value under 'containers[].resources.limits.cpu'.",
      "references": [
        "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
        "https://avd.aquasec.com/misconfig/ksv011"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV011",
        "AVDID": "AVD-KSV-0011",
        "Title": "CPU not limited",
        "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
        "Message": "Container 'disallowed-registry' of Deployment 'vulnerable-app' should set 'resources.limits.cpu'",
        "Namespace": "builtin.kubernetes.KSV011",
        "Query": "data.builtin.kubernetes.KSV011.deny",
        "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
        "References": [
          "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
          "https://avd.aquasec.com/misconfig/ksv011"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 29,
          "EndLine": 32,
          "Code": {
            "Lines": [
              {
                "Number": 29,
                "Content": "        - name: disallowed-registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: disallowed-registry",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "          image: docker.io/ubuntu:20.04  # Violation: disallowed registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\u001b[0m: disallowed registry",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            runAsNonRoot: false  # Violation: allows root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot: false  # Violation\u001b[0m: allows root",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "Runs as root user",
      "description": "Force the running image to run as a non-root user to ensure least privileges.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 18,
      "rule_id": "KSV012",
      "remediation": "Set 'containers[].securityContext.runAsNonRoot' to true.",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv012"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV012",
        "AVDID": "AVD-KSV-0012",
        "Title": "Runs as root user",
        "Description": "Force the running image to run as a non-root user to ensure least privileges.",
        "Message": "Container 'bad-container' of Deployment 'vulnerable-app' should set 'securityContext.runAsNonRoot' to true",
        "Namespace": "builtin.kubernetes.KSV012",
        "Query": "data.builtin.kubernetes.KSV012.deny",
        "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv012"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 18,
          "EndLine": 26,
          "Code": {
            "Lines": [
              {
                "Number": 18,
                "Content": "        - name: bad-container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: bad-container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "          image: nginx:latest  # Violation: latest tag",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: nginx:latest  # Violation\u001b[0m: latest tag",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "            runAsUser: 0  # Violation: running as root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsUser: 0  # Violation\u001b[0m: running as root",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "            privileged: true  # Violation: privileged mode",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mprivileged: true  # Violation\u001b[0m: privileged mode",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "            allowPrivilegeEscalation: true  # Violation: privilege escalation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\u001b[0m: privilege escalation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "            readOnlyRootFilesystem: false  # Violation: writable filesystem",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\u001b[0m: writable filesystem",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "              add: [\"SYS_ADMIN\"]  # Violation: dangerous capability",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33madd\u001b[0m: [\u001b[38;5;37m\"SYS_ADMIN\"\u001b[0m\u001b[38;5;33m]  # Violation\u001b[0m: dangerous capability",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "Runs as root user",
      "description": "Force the running image to run as a non-root user to ensure least privileges.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 29,
      "rule_id": "KSV012",
      "remediation": "Set 'containers[].securityContext.runAsNonRoot' to true.",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv012"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV012",
        "AVDID": "AVD-KSV-0012",
        "Title": "Runs as root user",
        "Description": "Force the running image to run as a non-root user to ensure least privileges.",
        "Message": "Container 'disallowed-registry' of Deployment 'vulnerable-app' should set 'securityContext.runAsNonRoot' to true",
        "Namespace": "builtin.kubernetes.KSV012",
        "Query": "data.builtin.kubernetes.KSV012.deny",
        "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv012"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 29,
          "EndLine": 32,
          "Code": {
            "Lines": [
              {
                "Number": 29,
                "Content": "        - name: disallowed-registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: disallowed-registry",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "          image: docker.io/ubuntu:20.04  # Violation: disallowed registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\u001b[0m: disallowed registry",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            runAsNonRoot: false  # Violation: allows root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot: false  # Violation\u001b[0m: allows root",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "Image tag \":latest\" used",
      "description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 18,
      "rule_id": "KSV013",
      "remediation": "Use a specific container image tag that is not 'latest'.",
      "references": [
        "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
        "https://avd.aquasec.com/misconfig/ksv013"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV013",
        "AVDID": "AVD-KSV-0013",
        "Title": "Image tag \":latest\" used",
        "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
        "Message": "Container 'bad-container' of Deployment 'vulnerable-app' should specify an image tag",
        "Namespace": "builtin.kubernetes.KSV013",
        "Query": "data.builtin.kubernetes.KSV013.deny",
        "Resolution": "Use a specific container image tag that is not 'latest'.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
        "References": [
          "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
          "https://avd.aquasec.com/misconfig/ksv013"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 18,
          "EndLine": 26,
          "Code": {
            "Lines": [
              {
                "Number": 18,
                "Content": "        - name: bad-container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: bad-container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "          image: nginx:latest  # Violation: latest tag",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: nginx:latest  # Violation\u001b[0m: latest tag",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "            runAsUser: 0  # Violation: running as root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsUser: 0  # Violation\u001b[0m: running as root",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "            privileged: true  # Violation: privileged mode",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mprivileged: true  # Violation\u001b[0m: privileged mode",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "            allowPrivilegeEscalation: true  # Violation: privilege escalation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\u001b[0m: privilege escalation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "            readOnlyRootFilesystem: false  # Violation: writable filesystem",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\u001b[0m: writable filesystem",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "              add: [\"SYS_ADMIN\"]  # Violation: dangerous capability",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33madd\u001b[0m: [\u001b[38;5;37m\"SYS_ADMIN\"\u001b[0m\u001b[38;5;33m]  # Violation\u001b[0m: dangerous capability",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Root file system is not read-only",
      "description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 18,
      "rule_id": "KSV014",
      "remediation": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
        "https://avd.aquasec.com/misconfig/ksv014"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV014",
        "AVDID": "AVD-KSV-0014",
        "Title": "Root file system is not read-only",
        "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
        "Message": "Container 'bad-container' of Deployment 'vulnerable-app' should set 'securityContext.readOnlyRootFilesystem' to true",
        "Namespace": "builtin.kubernetes.KSV014",
        "Query": "data.builtin.kubernetes.KSV014.deny",
        "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
          "https://avd.aquasec.com/misconfig/ksv014"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 18,
          "EndLine": 26,
          "Code": {
            "Lines": [
              {
                "Number": 18,
                "Content": "        - name: bad-container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: bad-container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "          image: nginx:latest  # Violation: latest tag",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: nginx:latest  # Violation\u001b[0m: latest tag",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "            runAsUser: 0  # Violation: running as root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsUser: 0  # Violation\u001b[0m: running as root",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "            privileged: true  # Violation: privileged mode",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mprivileged: true  # Violation\u001b[0m: privileged mode",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "            allowPrivilegeEscalation: true  # Violation: privilege escalation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\u001b[0m: privilege escalation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "            readOnlyRootFilesystem: false  # Violation: writable filesystem",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\u001b[0m: writable filesystem",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "              add: [\"SYS_ADMIN\"]  # Violation: dangerous capability",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33madd\u001b[0m: [\u001b[38;5;37m\"SYS_ADMIN\"\u001b[0m\u001b[38;5;33m]  # Violation\u001b[0m: dangerous capability",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Root file system is not read-only",
      "description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 29,
      "rule_id": "KSV014",
      "remediation": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
        "https://avd.aquasec.com/misconfig/ksv014"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV014",
        "AVDID": "AVD-KSV-0014",
        "Title": "Root file system is not read-only",
        "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
        "Message": "Container 'disallowed-registry' of Deployment 'vulnerable-app' should set 'securityContext.readOnlyRootFilesystem' to true",
        "Namespace": "builtin.kubernetes.KSV014",
        "Query": "data.builtin.kubernetes.KSV014.deny",
        "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
          "https://avd.aquasec.com/misconfig/ksv014"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 29,
          "EndLine": 32,
          "Code": {
            "Lines": [
              {
                "Number": 29,
                "Content": "        - name: disallowed-registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: disallowed-registry",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "          image: docker.io/ubuntu:20.04  # Violation: disallowed registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\u001b[0m: disallowed registry",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            runAsNonRoot: false  # Violation: allows root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot: false  # Violation\u001b[0m: allows root",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "CPU requests not specified",
      "description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 18,
      "rule_id": "KSV015",
      "remediation": "Set 'containers[].resources.requests.cpu'.",
      "references": [
        "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
        "https://avd.aquasec.com/misconfig/ksv015"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV015",
        "AVDID": "AVD-KSV-0015",
        "Title": "CPU requests not specified",
        "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "Message": "Container 'bad-container' of Deployment 'vulnerable-app' should set 'resources.requests.cpu'",
        "Namespace": "builtin.kubernetes.KSV015",
        "Query": "data.builtin.kubernetes.KSV015.deny",
        "Resolution": "Set 'containers[].resources.requests.cpu'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
        "References": [
          "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
          "https://avd.aquasec.com/misconfig/ksv015"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 18,
          "EndLine": 26,
          "Code": {
            "Lines": [
              {
                "Number": 18,
                "Content": "        - name: bad-container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: bad-container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "          image: nginx:latest  # Violation: latest tag",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: nginx:latest  # Violation\u001b[0m: latest tag",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "            runAsUser: 0  # Violation: running as root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsUser: 0  # Violation\u001b[0m: running as root",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "            privileged: true  # Violation: privileged mode",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mprivileged: true  # Violation\u001b[0m: privileged mode",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "            allowPrivilegeEscalation: true  # Violation: privilege escalation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\u001b[0m: privilege escalation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "            readOnlyRootFilesystem: false  # Violation: writable filesystem",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\u001b[0m: writable filesystem",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "              add: [\"SYS_ADMIN\"]  # Violation: dangerous capability",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33madd\u001b[0m: [\u001b[38;5;37m\"SYS_ADMIN\"\u001b[0m\u001b[38;5;33m]  # Violation\u001b[0m: dangerous capability",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "CPU requests not specified",
      "description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 29,
      "rule_id": "KSV015",
      "remediation": "Set 'containers[].resources.requests.cpu'.",
      "references": [
        "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
        "https://avd.aquasec.com/misconfig/ksv015"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV015",
        "AVDID": "AVD-KSV-0015",
        "Title": "CPU requests not specified",
        "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "Message": "Container 'disallowed-registry' of Deployment 'vulnerable-app' should set 'resources.requests.cpu'",
        "Namespace": "builtin.kubernetes.KSV015",
        "Query": "data.builtin.kubernetes.KSV015.deny",
        "Resolution": "Set 'containers[].resources.requests.cpu'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
        "References": [
          "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
          "https://avd.aquasec.com/misconfig/ksv015"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 29,
          "EndLine": 32,
          "Code": {
            "Lines": [
              {
                "Number": 29,
                "Content": "        - name: disallowed-registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: disallowed-registry",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "          image: docker.io/ubuntu:20.04  # Violation: disallowed registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\u001b[0m: disallowed registry",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            runAsNonRoot: false  # Violation: allows root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot: false  # Violation\u001b[0m: allows root",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Memory requests not specified",
      "description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 18,
      "rule_id": "KSV016",
      "remediation": "Set 'containers[].resources.requests.memory'.",
      "references": [
        "https://kubesec.io/basics/containers-resources-limits-memory/",
        "https://avd.aquasec.com/misconfig/ksv016"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV016",
        "AVDID": "AVD-KSV-0016",
        "Title": "Memory requests not specified",
        "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "Message": "Container 'bad-container' of Deployment 'vulnerable-app' should set 'resources.requests.memory'",
        "Namespace": "builtin.kubernetes.KSV016",
        "Query": "data.builtin.kubernetes.KSV016.deny",
        "Resolution": "Set 'containers[].resources.requests.memory'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
        "References": [
          "https://kubesec.io/basics/containers-resources-limits-memory/",
          "https://avd.aquasec.com/misconfig/ksv016"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 18,
          "EndLine": 26,
          "Code": {
            "Lines": [
              {
                "Number": 18,
                "Content": "        - name: bad-container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: bad-container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "          image: nginx:latest  # Violation: latest tag",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: nginx:latest  # Violation\u001b[0m: latest tag",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "            runAsUser: 0  # Violation: running as root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsUser: 0  # Violation\u001b[0m: running as root",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "            privileged: true  # Violation: privileged mode",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mprivileged: true  # Violation\u001b[0m: privileged mode",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "            allowPrivilegeEscalation: true  # Violation: privilege escalation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\u001b[0m: privilege escalation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "            readOnlyRootFilesystem: false  # Violation: writable filesystem",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\u001b[0m: writable filesystem",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "              add: [\"SYS_ADMIN\"]  # Violation: dangerous capability",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33madd\u001b[0m: [\u001b[38;5;37m\"SYS_ADMIN\"\u001b[0m\u001b[38;5;33m]  # Violation\u001b[0m: dangerous capability",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Memory requests not specified",
      "description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 29,
      "rule_id": "KSV016",
      "remediation": "Set 'containers[].resources.requests.memory'.",
      "references": [
        "https://kubesec.io/basics/containers-resources-limits-memory/",
        "https://avd.aquasec.com/misconfig/ksv016"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV016",
        "AVDID": "AVD-KSV-0016",
        "Title": "Memory requests not specified",
        "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "Message": "Container 'disallowed-registry' of Deployment 'vulnerable-app' should set 'resources.requests.memory'",
        "Namespace": "builtin.kubernetes.KSV016",
        "Query": "data.builtin.kubernetes.KSV016.deny",
        "Resolution": "Set 'containers[].resources.requests.memory'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
        "References": [
          "https://kubesec.io/basics/containers-resources-limits-memory/",
          "https://avd.aquasec.com/misconfig/ksv016"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 29,
          "EndLine": 32,
          "Code": {
            "Lines": [
              {
                "Number": 29,
                "Content": "        - name: disallowed-registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: disallowed-registry",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "          image: docker.io/ubuntu:20.04  # Violation: disallowed registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\u001b[0m: disallowed registry",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            runAsNonRoot: false  # Violation: allows root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot: false  # Violation\u001b[0m: allows root",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Privileged",
      "description": "Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 18,
      "rule_id": "KSV017",
      "remediation": "Change 'containers[].securityContext.privileged' to 'false'.",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv017"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV017",
        "AVDID": "AVD-KSV-0017",
        "Title": "Privileged",
        "Description": "Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.",
        "Message": "Container 'bad-container' of Deployment 'vulnerable-app' should set 'securityContext.privileged' to false",
        "Namespace": "builtin.kubernetes.KSV017",
        "Query": "data.builtin.kubernetes.KSV017.deny",
        "Resolution": "Change 'containers[].securityContext.privileged' to 'false'.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv017",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv017"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 18,
          "EndLine": 26,
          "Code": {
            "Lines": [
              {
                "Number": 18,
                "Content": "        - name: bad-container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: bad-container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "          image: nginx:latest  # Violation: latest tag",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: nginx:latest  # Violation\u001b[0m: latest tag",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "            runAsUser: 0  # Violation: running as root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsUser: 0  # Violation\u001b[0m: running as root",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "            privileged: true  # Violation: privileged mode",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mprivileged: true  # Violation\u001b[0m: privileged mode",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "            allowPrivilegeEscalation: true  # Violation: privilege escalation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\u001b[0m: privilege escalation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "            readOnlyRootFilesystem: false  # Violation: writable filesystem",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\u001b[0m: writable filesystem",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "              add: [\"SYS_ADMIN\"]  # Violation: dangerous capability",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33madd\u001b[0m: [\u001b[38;5;37m\"SYS_ADMIN\"\u001b[0m\u001b[38;5;33m]  # Violation\u001b[0m: dangerous capability",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Memory not limited",
      "description": "Enforcing memory limits prevents DoS via resource exhaustion.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 18,
      "rule_id": "KSV018",
      "remediation": "Set a limit value under 'containers[].resources.limits.memory'.",
      "references": [
        "https://kubesec.io/basics/containers-resources-limits-memory/",
        "https://avd.aquasec.com/misconfig/ksv018"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV018",
        "AVDID": "AVD-KSV-0018",
        "Title": "Memory not limited",
        "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
        "Message": "Container 'bad-container' of Deployment 'vulnerable-app' should set 'resources.limits.memory'",
        "Namespace": "builtin.kubernetes.KSV018",
        "Query": "data.builtin.kubernetes.KSV018.deny",
        "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
        "References": [
          "https://kubesec.io/basics/containers-resources-limits-memory/",
          "https://avd.aquasec.com/misconfig/ksv018"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 18,
          "EndLine": 26,
          "Code": {
            "Lines": [
              {
                "Number": 18,
                "Content": "        - name: bad-container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: bad-container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "          image: nginx:latest  # Violation: latest tag",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: nginx:latest  # Violation\u001b[0m: latest tag",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "            runAsUser: 0  # Violation: running as root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsUser: 0  # Violation\u001b[0m: running as root",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "            privileged: true  # Violation: privileged mode",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mprivileged: true  # Violation\u001b[0m: privileged mode",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "            allowPrivilegeEscalation: true  # Violation: privilege escalation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\u001b[0m: privilege escalation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "            readOnlyRootFilesystem: false  # Violation: writable filesystem",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\u001b[0m: writable filesystem",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "              add: [\"SYS_ADMIN\"]  # Violation: dangerous capability",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33madd\u001b[0m: [\u001b[38;5;37m\"SYS_ADMIN\"\u001b[0m\u001b[38;5;33m]  # Violation\u001b[0m: dangerous capability",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Memory not limited",
      "description": "Enforcing memory limits prevents DoS via resource exhaustion.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 29,
      "rule_id": "KSV018",
      "remediation": "Set a limit value under 'containers[].resources.limits.memory'.",
      "references": [
        "https://kubesec.io/basics/containers-resources-limits-memory/",
        "https://avd.aquasec.com/misconfig/ksv018"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV018",
        "AVDID": "AVD-KSV-0018",
        "Title": "Memory not limited",
        "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
        "Message": "Container 'disallowed-registry' of Deployment 'vulnerable-app' should set 'resources.limits.memory'",
        "Namespace": "builtin.kubernetes.KSV018",
        "Query": "data.builtin.kubernetes.KSV018.deny",
        "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
        "References": [
          "https://kubesec.io/basics/containers-resources-limits-memory/",
          "https://avd.aquasec.com/misconfig/ksv018"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 29,
          "EndLine": 32,
          "Code": {
            "Lines": [
              {
                "Number": 29,
                "Content": "        - name: disallowed-registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: disallowed-registry",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "          image: docker.io/ubuntu:20.04  # Violation: disallowed registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\u001b[0m: disallowed registry",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            runAsNonRoot: false  # Violation: allows root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot: false  # Violation\u001b[0m: allows root",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Runs with UID <= 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 18,
      "rule_id": "KSV020",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'bad-container' of Deployment 'vulnerable-app' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 18,
          "EndLine": 26,
          "Code": {
            "Lines": [
              {
                "Number": 18,
                "Content": "        - name: bad-container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: bad-container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "          image: nginx:latest  # Violation: latest tag",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: nginx:latest  # Violation\u001b[0m: latest tag",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "            runAsUser: 0  # Violation: running as root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsUser: 0  # Violation\u001b[0m: running as root",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "            privileged: true  # Violation: privileged mode",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mprivileged: true  # Violation\u001b[0m: privileged mode",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "            allowPrivilegeEscalation: true  # Violation: privilege escalation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\u001b[0m: privilege escalation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "            readOnlyRootFilesystem: false  # Violation: writable filesystem",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\u001b[0m: writable filesystem",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "              add: [\"SYS_ADMIN\"]  # Violation: dangerous capability",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33madd\u001b[0m: [\u001b[38;5;37m\"SYS_ADMIN\"\u001b[0m\u001b[38;5;33m]  # Violation\u001b[0m: dangerous capability",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Runs with UID <= 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 29,
      "rule_id": "KSV020",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'disallowed-registry' of Deployment 'vulnerable-app' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 29,
          "EndLine": 32,
          "Code": {
            "Lines": [
              {
                "Number": 29,
                "Content": "        - name: disallowed-registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: disallowed-registry",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "          image: docker.io/ubuntu:20.04  # Violation: disallowed registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\u001b[0m: disallowed registry",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            runAsNonRoot: false  # Violation: allows root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot: false  # Violation\u001b[0m: allows root",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Runs with GID <= 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 18,
      "rule_id": "KSV021",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'bad-container' of Deployment 'vulnerable-app' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 18,
          "EndLine": 26,
          "Code": {
            "Lines": [
              {
                "Number": 18,
                "Content": "        - name: bad-container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: bad-container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "          image: nginx:latest  # Violation: latest tag",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: nginx:latest  # Violation\u001b[0m: latest tag",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "            runAsUser: 0  # Violation: running as root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsUser: 0  # Violation\u001b[0m: running as root",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "            privileged: true  # Violation: privileged mode",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mprivileged: true  # Violation\u001b[0m: privileged mode",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "            allowPrivilegeEscalation: true  # Violation: privilege escalation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\u001b[0m: privilege escalation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "            readOnlyRootFilesystem: false  # Violation: writable filesystem",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\u001b[0m: writable filesystem",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "              add: [\"SYS_ADMIN\"]  # Violation: dangerous capability",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33madd\u001b[0m: [\u001b[38;5;37m\"SYS_ADMIN\"\u001b[0m\u001b[38;5;33m]  # Violation\u001b[0m: dangerous capability",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Runs with GID <= 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 29,
      "rule_id": "KSV021",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'disallowed-registry' of Deployment 'vulnerable-app' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 29,
          "EndLine": 32,
          "Code": {
            "Lines": [
              {
                "Number": 29,
                "Content": "        - name: disallowed-registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: disallowed-registry",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "          image: docker.io/ubuntu:20.04  # Violation: disallowed registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\u001b[0m: disallowed registry",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            runAsNonRoot: false  # Violation: allows root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot: false  # Violation\u001b[0m: allows root",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "Specific capabilities added",
      "description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 18,
      "rule_id": "KSV022",
      "remediation": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv022"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV022",
        "AVDID": "AVD-KSV-0022",
        "Title": "Specific capabilities added",
        "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.",
        "Message": "Container 'bad-container' of Deployment 'vulnerable-app' should not set 'securityContext.capabilities.add'",
        "Namespace": "builtin.kubernetes.KSV022",
        "Query": "data.builtin.kubernetes.KSV022.deny",
        "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv022"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 18,
          "EndLine": 26,
          "Code": {
            "Lines": [
              {
                "Number": 18,
                "Content": "        - name: bad-container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: bad-container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "          image: nginx:latest  # Violation: latest tag",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: nginx:latest  # Violation\u001b[0m: latest tag",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "            runAsUser: 0  # Violation: running as root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsUser: 0  # Violation\u001b[0m: running as root",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "            privileged: true  # Violation: privileged mode",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mprivileged: true  # Violation\u001b[0m: privileged mode",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "            allowPrivilegeEscalation: true  # Violation: privilege escalation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\u001b[0m: privilege escalation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "            readOnlyRootFilesystem: false  # Violation: writable filesystem",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\u001b[0m: writable filesystem",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "              add: [\"SYS_ADMIN\"]  # Violation: dangerous capability",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33madd\u001b[0m: [\u001b[38;5;37m\"SYS_ADMIN\"\u001b[0m\u001b[38;5;33m]  # Violation\u001b[0m: dangerous capability",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Runtime/Default Seccomp profile not set",
      "description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 29,
      "rule_id": "KSV030",
      "remediation": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv030"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV030",
        "AVDID": "AVD-KSV-0030",
        "Title": "Runtime/Default Seccomp profile not set",
        "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
        "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
        "Namespace": "builtin.kubernetes.KSV030",
        "Query": "data.builtin.kubernetes.KSV030.deny",
        "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv030"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 29,
          "EndLine": 32,
          "Code": {
            "Lines": [
              {
                "Number": 29,
                "Content": "        - name: disallowed-registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: disallowed-registry",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "          image: docker.io/ubuntu:20.04  # Violation: disallowed registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\u001b[0m: disallowed registry",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            runAsNonRoot: false  # Violation: allows root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot: false  # Violation\u001b[0m: allows root",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Runtime/Default Seccomp profile not set",
      "description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 18,
      "rule_id": "KSV030",
      "remediation": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv030"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV030",
        "AVDID": "AVD-KSV-0030",
        "Title": "Runtime/Default Seccomp profile not set",
        "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
        "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
        "Namespace": "builtin.kubernetes.KSV030",
        "Query": "data.builtin.kubernetes.KSV030.deny",
        "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv030"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 18,
          "EndLine": 26,
          "Code": {
            "Lines": [
              {
                "Number": 18,
                "Content": "        - name: bad-container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: bad-container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "          image: nginx:latest  # Violation: latest tag",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: nginx:latest  # Violation\u001b[0m: latest tag",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "            runAsUser: 0  # Violation: running as root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsUser: 0  # Violation\u001b[0m: running as root",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "            privileged: true  # Violation: privileged mode",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mprivileged: true  # Violation\u001b[0m: privileged mode",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "            allowPrivilegeEscalation: true  # Violation: privilege escalation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\u001b[0m: privilege escalation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "            readOnlyRootFilesystem: false  # Violation: writable filesystem",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\u001b[0m: writable filesystem",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "              add: [\"SYS_ADMIN\"]  # Violation: dangerous capability",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33madd\u001b[0m: [\u001b[38;5;37m\"SYS_ADMIN\"\u001b[0m\u001b[38;5;33m]  # Violation\u001b[0m: dangerous capability",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "Seccomp policies disabled",
      "description": "A program inside the container can bypass Seccomp protection policies.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": null,
      "rule_id": "KSV104",
      "remediation": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv104"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV104",
        "AVDID": "AVD-KSV-0104",
        "Title": "Seccomp policies disabled",
        "Description": "A program inside the container can bypass Seccomp protection policies.",
        "Message": "container \"bad-container\" of deployment \"vulnerable-app\" in \"default\" namespace should specify a seccomp profile",
        "Namespace": "builtin.kubernetes.KSV104",
        "Query": "data.builtin.kubernetes.KSV104.deny",
        "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "Seccomp policies disabled",
      "description": "A program inside the container can bypass Seccomp protection policies.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": null,
      "rule_id": "KSV104",
      "remediation": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv104"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV104",
        "AVDID": "AVD-KSV-0104",
        "Title": "Seccomp policies disabled",
        "Description": "A program inside the container can bypass Seccomp protection policies.",
        "Message": "container \"disallowed-registry\" of deployment \"vulnerable-app\" in \"default\" namespace should specify a seccomp profile",
        "Namespace": "builtin.kubernetes.KSV104",
        "Query": "data.builtin.kubernetes.KSV104.deny",
        "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Containers must not set runAsUser to 0",
      "description": "Containers should be forbidden from running with a root UID.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 21,
      "rule_id": "KSV105",
      "remediation": "Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv105"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV105",
        "AVDID": "AVD-KSV-0105",
        "Title": "Containers must not set runAsUser to 0",
        "Description": "Containers should be forbidden from running with a root UID.",
        "Message": "securityContext.runAsUser should be set to a value greater than 0",
        "Namespace": "builtin.kubernetes.KSV105",
        "Query": "data.builtin.kubernetes.KSV105.deny",
        "Resolution": "Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv105",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv105"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 21,
          "EndLine": 26,
          "Code": {
            "Lines": [
              {
                "Number": 21,
                "Content": "            runAsUser: 0  # Violation: running as root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsUser: 0  # Violation\u001b[0m: running as root",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "            privileged: true  # Violation: privileged mode",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mprivileged: true  # Violation\u001b[0m: privileged mode",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "            allowPrivilegeEscalation: true  # Violation: privilege escalation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\u001b[0m: privilege escalation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "            readOnlyRootFilesystem: false  # Violation: writable filesystem",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\u001b[0m: writable filesystem",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "              add: [\"SYS_ADMIN\"]  # Violation: dangerous capability",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33madd\u001b[0m: [\u001b[38;5;37m\"SYS_ADMIN\"\u001b[0m\u001b[38;5;33m]  # Violation\u001b[0m: dangerous capability",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Container capabilities must only include NET_BIND_SERVICE",
      "description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 29,
      "rule_id": "KSV106",
      "remediation": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv106"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV106",
        "AVDID": "AVD-KSV-0106",
        "Title": "Container capabilities must only include NET_BIND_SERVICE",
        "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
        "Message": "container should drop all",
        "Namespace": "builtin.kubernetes.KSV106",
        "Query": "data.builtin.kubernetes.KSV106.deny",
        "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv106"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 29,
          "EndLine": 32,
          "Code": {
            "Lines": [
              {
                "Number": 29,
                "Content": "        - name: disallowed-registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: disallowed-registry",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "          image: docker.io/ubuntu:20.04  # Violation: disallowed registry",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\u001b[0m: disallowed registry",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            runAsNonRoot: false  # Violation: allows root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot: false  # Violation\u001b[0m: allows root",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Container capabilities must only include NET_BIND_SERVICE",
      "description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": 18,
      "rule_id": "KSV106",
      "remediation": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv106"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV106",
        "AVDID": "AVD-KSV-0106",
        "Title": "Container capabilities must only include NET_BIND_SERVICE",
        "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
        "Message": "container should drop all",
        "Namespace": "builtin.kubernetes.KSV106",
        "Query": "data.builtin.kubernetes.KSV106.deny",
        "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv106"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 18,
          "EndLine": 26,
          "Code": {
            "Lines": [
              {
                "Number": 18,
                "Content": "        - name: bad-container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: bad-container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "          image: nginx:latest  # Violation: latest tag",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage: nginx:latest  # Violation\u001b[0m: latest tag",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "            runAsUser: 0  # Violation: running as root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsUser: 0  # Violation\u001b[0m: running as root",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "            privileged: true  # Violation: privileged mode",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mprivileged: true  # Violation\u001b[0m: privileged mode",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "            allowPrivilegeEscalation: true  # Violation: privilege escalation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\u001b[0m: privilege escalation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "            readOnlyRootFilesystem: false  # Violation: writable filesystem",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\u001b[0m: writable filesystem",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "              add: [\"SYS_ADMIN\"]  # Violation: dangerous capability",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33madd\u001b[0m: [\u001b[38;5;37m\"SYS_ADMIN\"\u001b[0m\u001b[38;5;33m]  # Violation\u001b[0m: dangerous capability",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Workloads in the default namespace",
      "description": "Checks whether a workload is running in the default namespace.",
      "file": "GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml",
      "line": null,
      "rule_id": "KSV110",
      "remediation": "Set 'metadata.namespace' to a non-default namespace.",
      "references": [
        "https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/",
        "https://avd.aquasec.com/misconfig/ksv110"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV110",
        "AVDID": "AVD-KSV-0110",
        "Title": "Workloads in the default namespace",
        "Description": "Checks whether a workload is running in the default namespace.",
        "Message": "deployment vulnerable-app in default namespace should set metadata.namespace to a non-default namespace",
        "Namespace": "builtin.kubernetes.KSV110",
        "Query": "data.builtin.kubernetes.KSV110.deny",
        "Resolution": "Set 'metadata.namespace' to a non-default namespace.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv110",
        "References": [
          "https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/",
          "https://avd.aquasec.com/misconfig/ksv110"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "':latest' tag used",
      "description": "When using a 'FROM' statement you should use a specific tag to avoid uncontrolled behavior when the image is updated.",
      "file": "data/chromadb-config/Dockerfile",
      "line": 1,
      "rule_id": "DS001",
      "remediation": "Add a tag to the image in the 'FROM' statement",
      "references": [
        "https://avd.aquasec.com/misconfig/ds001"
      ],
      "raw": {
        "Type": "Dockerfile Security Check",
        "ID": "DS001",
        "AVDID": "AVD-DS-0001",
        "Title": "':latest' tag used",
        "Description": "When using a 'FROM' statement you should use a specific tag to avoid uncontrolled behavior when the image is updated.",
        "Message": "Specify a tag in the 'FROM' statement for image 'chromadb/chroma'",
        "Namespace": "builtin.dockerfile.DS001",
        "Query": "data.builtin.dockerfile.DS001.deny",
        "Resolution": "Add a tag to the image in the 'FROM' statement",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ds001",
        "References": [
          "https://avd.aquasec.com/misconfig/ds001"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Dockerfile",
          "Service": "general",
          "StartLine": 1,
          "EndLine": 1,
          "Code": {
            "Lines": [
              {
                "Number": 1,
                "Content": "FROM chromadb/chroma:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;64mFROM\u001b[0m\u001b[38;5;37m chromadb/chroma:latest",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "No HEALTHCHECK defined",
      "description": "You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.",
      "file": "data/chromadb-config/Dockerfile",
      "line": null,
      "rule_id": "DS026",
      "remediation": "Add HEALTHCHECK instruction in Dockerfile",
      "references": [
        "https://blog.aquasec.com/docker-security-best-practices",
        "https://avd.aquasec.com/misconfig/ds026"
      ],
      "raw": {
        "Type": "Dockerfile Security Check",
        "ID": "DS026",
        "AVDID": "AVD-DS-0026",
        "Title": "No HEALTHCHECK defined",
        "Description": "You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.",
        "Message": "Add HEALTHCHECK instruction in your Dockerfile",
        "Namespace": "builtin.dockerfile.DS026",
        "Query": "data.builtin.dockerfile.DS026.deny",
        "Resolution": "Add HEALTHCHECK instruction in Dockerfile",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ds026",
        "References": [
          "https://blog.aquasec.com/docker-security-best-practices",
          "https://avd.aquasec.com/misconfig/ds026"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Dockerfile",
          "Service": "general",
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "'apt-get' missing '--no-install-recommends'",
      "description": "'apt-get' install should use '--no-install-recommends' to minimize image size.",
      "file": "data/chromadb-config/Dockerfile",
      "line": 8,
      "rule_id": "DS029",
      "remediation": "Add '--no-install-recommends' flag to 'apt-get'",
      "references": [
        "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
        "https://avd.aquasec.com/misconfig/ds029"
      ],
      "raw": {
        "Type": "Dockerfile Security Check",
        "ID": "DS029",
        "AVDID": "AVD-DS-0029",
        "Title": "'apt-get' missing '--no-install-recommends'",
        "Description": "'apt-get' install should use '--no-install-recommends' to minimize image size.",
        "Message": "'--no-install-recommends' flag is missed: 'apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/*'",
        "Namespace": "builtin.dockerfile.DS029",
        "Query": "data.builtin.dockerfile.DS029.deny",
        "Resolution": "Add '--no-install-recommends' flag to 'apt-get'",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ds029",
        "References": [
          "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
          "https://avd.aquasec.com/misconfig/ds029"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Dockerfile",
          "Service": "general",
          "StartLine": 8,
          "EndLine": 8,
          "Code": {
            "Lines": [
              {
                "Number": 8,
                "Content": "RUN apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/*",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;64mRUN\u001b[0m apt-get update \u001b[38;5;245m&&\u001b[0m apt-get install -y curl \u001b[38;5;245m&&\u001b[0m rm -rf /var/lib/apt/lists/*",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Root file system is not read-only",
      "description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
      "file": "infrastructure/method1-simple-kubectl/04-chroma-deployment.yaml",
      "line": 26,
      "rule_id": "KSV014",
      "remediation": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
        "https://avd.aquasec.com/misconfig/ksv014"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV014",
        "AVDID": "AVD-KSV-0014",
        "Title": "Root file system is not read-only",
        "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
        "Message": "Container 'chromadb' of Deployment 'chromadb' should set 'securityContext.readOnlyRootFilesystem' to true",
        "Namespace": "builtin.kubernetes.KSV014",
        "Query": "data.builtin.kubernetes.KSV014.deny",
        "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
          "https://avd.aquasec.com/misconfig/ksv014"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 26,
          "EndLine": 59,
          "Code": {
            "Lines": [
              {
                "Number": 26,
                "Content": "        - name: chromadb",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: chromadb",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "          image: chromadb/chroma:0.5.18",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: chromadb/chroma:0.5.18",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "          imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "            runAsNonRoot: true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "            runAsUser: 1000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m1000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            runAsGroup: 1000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m1000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "            allowPrivilegeEscalation: false",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 34,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 35,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Runs with UID <= 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "file": "infrastructure/method1-simple-kubectl/04-chroma-deployment.yaml",
      "line": 26,
      "rule_id": "KSV020",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'chromadb' of Deployment 'chromadb' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 26,
          "EndLine": 59,
          "Code": {
            "Lines": [
              {
                "Number": 26,
                "Content": "        - name: chromadb",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: chromadb",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "          image: chromadb/chroma:0.5.18",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: chromadb/chroma:0.5.18",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "          imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "            runAsNonRoot: true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "            runAsUser: 1000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m1000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            runAsGroup: 1000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m1000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "            allowPrivilegeEscalation: false",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 34,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 35,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Runs with GID <= 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "file": "infrastructure/method1-simple-kubectl/04-chroma-deployment.yaml",
      "line": 26,
      "rule_id": "KSV021",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'chromadb' of Deployment 'chromadb' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 26,
          "EndLine": 59,
          "Code": {
            "Lines": [
              {
                "Number": 26,
                "Content": "        - name: chromadb",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: chromadb",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "          image: chromadb/chroma:0.5.18",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: chromadb/chroma:0.5.18",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "          imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "            runAsNonRoot: true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "            runAsUser: 1000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m1000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            runAsGroup: 1000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m1000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "            allowPrivilegeEscalation: false",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 34,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 35,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "CPU not limited",
      "description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
      "file": "infrastructure/method1-simple-kubectl/05-api-deployment.yaml",
      "line": 27,
      "rule_id": "KSV011",
      "remediation": "Set a limit value under 'containers[].resources.limits.cpu'.",
      "references": [
        "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
        "https://avd.aquasec.com/misconfig/ksv011"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV011",
        "AVDID": "AVD-KSV-0011",
        "Title": "CPU not limited",
        "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
        "Message": "Container 'wait-for-chromadb' of Deployment 'portfolio-api' should set 'resources.limits.cpu'",
        "Namespace": "builtin.kubernetes.KSV011",
        "Query": "data.builtin.kubernetes.KSV011.deny",
        "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
        "References": [
          "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
          "https://avd.aquasec.com/misconfig/ksv011"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 27,
          "EndLine": 39,
          "Code": {
            "Lines": [
              {
                "Number": 27,
                "Content": "        - name: wait-for-chromadb",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: wait-for-chromadb",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "          image: busybox:1.36",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: busybox:1.36",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "            runAsNonRoot: true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "            runAsUser: 10001",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m10001",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            allowPrivilegeEscalation: false",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 34,
                "Content": "              drop:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 35,
                "Content": "                - ALL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "                - ALL",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 36,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Root file system is not read-only",
      "description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
      "file": "infrastructure/method1-simple-kubectl/05-api-deployment.yaml",
      "line": 51,
      "rule_id": "KSV014",
      "remediation": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
        "https://avd.aquasec.com/misconfig/ksv014"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV014",
        "AVDID": "AVD-KSV-0014",
        "Title": "Root file system is not read-only",
        "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
        "Message": "Container 'rag-sync' of Deployment 'portfolio-api' should set 'securityContext.readOnlyRootFilesystem' to true",
        "Namespace": "builtin.kubernetes.KSV014",
        "Query": "data.builtin.kubernetes.KSV014.deny",
        "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
          "https://avd.aquasec.com/misconfig/ksv014"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 51,
          "EndLine": 156,
          "Code": {
            "Lines": [
              {
                "Number": 51,
                "Content": "        - name: rag-sync",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: rag-sync",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 52,
                "Content": "          image: python:3.11-slim",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: python:3.11-slim",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 53,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 54,
                "Content": "            runAsNonRoot: true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 55,
                "Content": "            runAsUser: 10001",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m10001",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 56,
                "Content": "            allowPrivilegeEscalation: false",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 57,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 58,
                "Content": "              drop:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 59,
                "Content": "                - ALL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "                - ALL",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 60,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Root file system is not read-only",
      "description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
      "file": "infrastructure/method1-simple-kubectl/05-api-deployment.yaml",
      "line": 27,
      "rule_id": "KSV014",
      "remediation": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
        "https://avd.aquasec.com/misconfig/ksv014"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV014",
        "AVDID": "AVD-KSV-0014",
        "Title": "Root file system is not read-only",
        "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
        "Message": "Container 'wait-for-chromadb' of Deployment 'portfolio-api' should set 'securityContext.readOnlyRootFilesystem' to true",
        "Namespace": "builtin.kubernetes.KSV014",
        "Query": "data.builtin.kubernetes.KSV014.deny",
        "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
          "https://avd.aquasec.com/misconfig/ksv014"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 27,
          "EndLine": 39,
          "Code": {
            "Lines": [
              {
                "Number": 27,
                "Content": "        - name: wait-for-chromadb",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: wait-for-chromadb",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "          image: busybox:1.36",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: busybox:1.36",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "            runAsNonRoot: true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "            runAsUser: 10001",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m10001",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            allowPrivilegeEscalation: false",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 34,
                "Content": "              drop:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 35,
                "Content": "                - ALL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "                - ALL",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 36,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "CPU requests not specified",
      "description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
      "file": "infrastructure/method1-simple-kubectl/05-api-deployment.yaml",
      "line": 27,
      "rule_id": "KSV015",
      "remediation": "Set 'containers[].resources.requests.cpu'.",
      "references": [
        "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
        "https://avd.aquasec.com/misconfig/ksv015"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV015",
        "AVDID": "AVD-KSV-0015",
        "Title": "CPU requests not specified",
        "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "Message": "Container 'wait-for-chromadb' of Deployment 'portfolio-api' should set 'resources.requests.cpu'",
        "Namespace": "builtin.kubernetes.KSV015",
        "Query": "data.builtin.kubernetes.KSV015.deny",
        "Resolution": "Set 'containers[].resources.requests.cpu'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
        "References": [
          "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
          "https://avd.aquasec.com/misconfig/ksv015"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 27,
          "EndLine": 39,
          "Code": {
            "Lines": [
              {
                "Number": 27,
                "Content": "        - name: wait-for-chromadb",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: wait-for-chromadb",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "          image: busybox:1.36",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: busybox:1.36",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "            runAsNonRoot: true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "            runAsUser: 10001",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m10001",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            allowPrivilegeEscalation: false",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 34,
                "Content": "              drop:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 35,
                "Content": "                - ALL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "                - ALL",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 36,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Memory requests not specified",
      "description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
      "file": "infrastructure/method1-simple-kubectl/05-api-deployment.yaml",
      "line": 27,
      "rule_id": "KSV016",
      "remediation": "Set 'containers[].resources.requests.memory'.",
      "references": [
        "https://kubesec.io/basics/containers-resources-limits-memory/",
        "https://avd.aquasec.com/misconfig/ksv016"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV016",
        "AVDID": "AVD-KSV-0016",
        "Title": "Memory requests not specified",
        "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "Message": "Container 'wait-for-chromadb' of Deployment 'portfolio-api' should set 'resources.requests.memory'",
        "Namespace": "builtin.kubernetes.KSV016",
        "Query": "data.builtin.kubernetes.KSV016.deny",
        "Resolution": "Set 'containers[].resources.requests.memory'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
        "References": [
          "https://kubesec.io/basics/containers-resources-limits-memory/",
          "https://avd.aquasec.com/misconfig/ksv016"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 27,
          "EndLine": 39,
          "Code": {
            "Lines": [
              {
                "Number": 27,
                "Content": "        - name: wait-for-chromadb",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: wait-for-chromadb",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "          image: busybox:1.36",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: busybox:1.36",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "            runAsNonRoot: true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "            runAsUser: 10001",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m10001",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            allowPrivilegeEscalation: false",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 34,
                "Content": "              drop:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 35,
                "Content": "                - ALL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "                - ALL",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 36,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Memory not limited",
      "description": "Enforcing memory limits prevents DoS via resource exhaustion.",
      "file": "infrastructure/method1-simple-kubectl/05-api-deployment.yaml",
      "line": 27,
      "rule_id": "KSV018",
      "remediation": "Set a limit value under 'containers[].resources.limits.memory'.",
      "references": [
        "https://kubesec.io/basics/containers-resources-limits-memory/",
        "https://avd.aquasec.com/misconfig/ksv018"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV018",
        "AVDID": "AVD-KSV-0018",
        "Title": "Memory not limited",
        "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
        "Message": "Container 'wait-for-chromadb' of Deployment 'portfolio-api' should set 'resources.limits.memory'",
        "Namespace": "builtin.kubernetes.KSV018",
        "Query": "data.builtin.kubernetes.KSV018.deny",
        "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
        "References": [
          "https://kubesec.io/basics/containers-resources-limits-memory/",
          "https://avd.aquasec.com/misconfig/ksv018"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 27,
          "EndLine": 39,
          "Code": {
            "Lines": [
              {
                "Number": 27,
                "Content": "        - name: wait-for-chromadb",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: wait-for-chromadb",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "          image: busybox:1.36",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: busybox:1.36",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "            runAsNonRoot: true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "            runAsUser: 10001",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m10001",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            allowPrivilegeEscalation: false",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 34,
                "Content": "              drop:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 35,
                "Content": "                - ALL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "                - ALL",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 36,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Runs with GID <= 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "file": "infrastructure/method1-simple-kubectl/05-api-deployment.yaml",
      "line": 51,
      "rule_id": "KSV021",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'rag-sync' of Deployment 'portfolio-api' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 51,
          "EndLine": 156,
          "Code": {
            "Lines": [
              {
                "Number": 51,
                "Content": "        - name: rag-sync",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: rag-sync",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 52,
                "Content": "          image: python:3.11-slim",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: python:3.11-slim",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 53,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 54,
                "Content": "            runAsNonRoot: true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 55,
                "Content": "            runAsUser: 10001",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m10001",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 56,
                "Content": "            allowPrivilegeEscalation: false",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 57,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 58,
                "Content": "              drop:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 59,
                "Content": "                - ALL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "                - ALL",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 60,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Runs with GID <= 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "file": "infrastructure/method1-simple-kubectl/05-api-deployment.yaml",
      "line": 27,
      "rule_id": "KSV021",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'wait-for-chromadb' of Deployment 'portfolio-api' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 27,
          "EndLine": 39,
          "Code": {
            "Lines": [
              {
                "Number": 27,
                "Content": "        - name: wait-for-chromadb",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: wait-for-chromadb",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "          image: busybox:1.36",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: busybox:1.36",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "          securityContext:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "            runAsNonRoot: true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "            runAsUser: 10001",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m10001",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "            allowPrivilegeEscalation: false",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "            capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 34,
                "Content": "              drop:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 35,
                "Content": "                - ALL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "                - ALL",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 36,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Prevent binding to privileged ports",
      "description": "The ports which are lower than 1024 receive and transmit various sensitive and privileged data. Allowing containers to use them can bring serious implications.",
      "file": "infrastructure/method1-simple-kubectl/06-ui-deployment.yaml",
      "line": null,
      "rule_id": "KSV117",
      "remediation": "Do not map the container ports to privileged host ports when starting a container.",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/",
        "https://avd.aquasec.com/misconfig/ksv117"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV117",
        "AVDID": "AVD-KSV-0117",
        "Title": "Prevent binding to privileged ports",
        "Description": "The ports which are lower than 1024 receive and transmit various sensitive and privileged data. Allowing containers to use them can bring serious implications.",
        "Message": "deployment portfolio-ui in portfolio namespace should not set spec.template.spec.containers.ports.containerPort to less than 1024",
        "Namespace": "builtin.kubernetes.KSV117",
        "Query": "data.builtin.kubernetes.KSV117.deny",
        "Resolution": "Do not map the container ports to privileged host ports when starting a container.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv117",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/",
          "https://avd.aquasec.com/misconfig/ksv117"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "Manage namespace secrets",
      "description": "Viewing secrets at the namespace scope can lead to escalation if another service account in that namespace has a higher privileged rolebinding or clusterrolebinding bound.",
      "file": "infrastructure/method1-simple-kubectl/k8s-security/rbac/roles.yaml",
      "line": 7,
      "rule_id": "KSV113",
      "remediation": "Manage namespace secrets are not allowed. Remove resource 'secrets' from role",
      "references": [
        "https://kubernetes.io/docs/concepts/security/rbac-good-practices/",
        "https://avd.aquasec.com/misconfig/ksv113"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV113",
        "AVDID": "AVD-KSV-0113",
        "Title": "Manage namespace secrets",
        "Description": "Viewing secrets at the namespace scope can lead to escalation if another service account in that namespace has a higher privileged rolebinding or clusterrolebinding bound.",
        "Message": "Role 'app-role' shouldn't have access to manage secrets in namespace 'default'",
        "Namespace": "builtin.kubernetes.KSV113",
        "Query": "data.builtin.kubernetes.KSV113.deny",
        "Resolution": "Manage namespace secrets are not allowed. Remove resource 'secrets' from role",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv113",
        "References": [
          "https://kubernetes.io/docs/concepts/security/rbac-good-practices/",
          "https://avd.aquasec.com/misconfig/ksv113"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 7,
          "EndLine": 14,
          "Code": {
            "Lines": [
              {
                "Number": 7,
                "Content": "- apiGroups:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "- \u001b[38;5;33mapiGroups\u001b[0m:",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 8,
                "Content": "  - ''",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  - \u001b[38;5;37m''",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 9,
                "Content": "  resources:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;33mresources\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 10,
                "Content": "  - configmaps",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  - configmaps",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 11,
                "Content": "  - secrets",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  - secrets",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 12,
                "Content": "  verbs:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;33mverbs\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 13,
                "Content": "  - get",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  - get",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 14,
                "Content": "  - list",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  - list",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Public ingress should not be allowed via network policies",
      "description": "You should not expose infrastructure to the public internet except where explicitly required",
      "file": "module.kubernetes_app",
      "line": 85,
      "rule_id": "AVD-KUBE-0001",
      "remediation": "Remove public access except where explicitly required",
      "references": [
        "https://avd.aquasec.com/misconfig/avd-kube-0001"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-KUBE-0001",
        "AVDID": "AVD-KUBE-0001",
        "Title": "Public ingress should not be allowed via network policies",
        "Description": "You should not expose infrastructure to the public internet except where explicitly required",
        "Message": "Network policy allows ingress from the public internet.",
        "Query": "data..",
        "Resolution": "Remove public access except where explicitly required",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-kube-0001",
        "References": [
          "https://avd.aquasec.com/misconfig/avd-kube-0001"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.kubernetes_app",
          "Provider": "Kubernetes",
          "Service": "network",
          "StartLine": 85,
          "EndLine": 85,
          "Code": {
            "Lines": [
              {
                "Number": 66,
                "Content": "resource \"kubernetes_network_policy\" \"ui_ingress\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"kubernetes_network_policy\"\u001b[0m \u001b[38;5;37m\"ui_ingress\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 67,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 85,
                "Content": "          cidr = \"0.0.0.0/0\"",
                "IsCause": true,
                "Annotation": "\"0.0.0.0/0\"",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;245mcidr\u001b[0m = \u001b[38;5;37m\"0.0.0.0/0\"",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 94,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 95,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "ip_block",
              "Filename": "infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf",
              "Location": {
                "StartLine": 84,
                "EndLine": 86
              }
            },
            {
              "Resource": "from",
              "Filename": "infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf",
              "Location": {
                "StartLine": 82,
                "EndLine": 87
              }
            },
            {
              "Resource": "ingress",
              "Filename": "infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf",
              "Location": {
                "StartLine": 81,
                "EndLine": 93
              }
            },
            {
              "Resource": "spec",
              "Filename": "infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 94
              }
            },
            {
              "Resource": "kubernetes_network_policy.ui_ingress",
              "Filename": "infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf",
              "Location": {
                "StartLine": 66,
                "EndLine": 95
              }
            },
            {
              "Resource": "module.kubernetes_app",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 63,
                "EndLine": 88
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Public ingress should not be allowed via network policies",
      "description": "You should not expose infrastructure to the public internet except where explicitly required",
      "file": "module.kubernetes_app",
      "line": 85,
      "rule_id": "AVD-KUBE-0001",
      "remediation": "Remove public access except where explicitly required",
      "references": [
        "https://avd.aquasec.com/misconfig/avd-kube-0001"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-KUBE-0001",
        "AVDID": "AVD-KUBE-0001",
        "Title": "Public ingress should not be allowed via network policies",
        "Description": "You should not expose infrastructure to the public internet except where explicitly required",
        "Message": "Network policy allows ingress from the public internet.",
        "Query": "data..",
        "Resolution": "Remove public access except where explicitly required",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-kube-0001",
        "References": [
          "https://avd.aquasec.com/misconfig/avd-kube-0001"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.kubernetes_app",
          "Provider": "Kubernetes",
          "Service": "network",
          "StartLine": 85,
          "EndLine": 85,
          "Code": {
            "Lines": [
              {
                "Number": 66,
                "Content": "resource \"kubernetes_network_policy\" \"ui_ingress\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"kubernetes_network_policy\"\u001b[0m \u001b[38;5;37m\"ui_ingress\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 67,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 85,
                "Content": "          cidr = \"0.0.0.0/0\"",
                "IsCause": true,
                "Annotation": "\"0.0.0.0/0\"",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;245mcidr\u001b[0m = \u001b[38;5;37m\"0.0.0.0/0\"",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 94,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 95,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "ip_block",
              "Filename": "infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf",
              "Location": {
                "StartLine": 84,
                "EndLine": 86
              }
            },
            {
              "Resource": "from",
              "Filename": "infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf",
              "Location": {
                "StartLine": 82,
                "EndLine": 87
              }
            },
            {
              "Resource": "ingress",
              "Filename": "infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf",
              "Location": {
                "StartLine": 81,
                "EndLine": 93
              }
            },
            {
              "Resource": "spec",
              "Filename": "infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 94
              }
            },
            {
              "Resource": "kubernetes_network_policy.ui_ingress",
              "Filename": "infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf",
              "Location": {
                "StartLine": 66,
                "EndLine": 95
              }
            },
            {
              "Resource": "module.kubernetes_app",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 46,
                "EndLine": 66
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Public ingress should not be allowed via network policies",
      "description": "You should not expose infrastructure to the public internet except where explicitly required",
      "file": "module.portfolio",
      "line": 85,
      "rule_id": "AVD-KUBE-0001",
      "remediation": "Remove public access except where explicitly required",
      "references": [
        "https://avd.aquasec.com/misconfig/avd-kube-0001"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-KUBE-0001",
        "AVDID": "AVD-KUBE-0001",
        "Title": "Public ingress should not be allowed via network policies",
        "Description": "You should not expose infrastructure to the public internet except where explicitly required",
        "Message": "Network policy allows ingress from the public internet.",
        "Query": "data..",
        "Resolution": "Remove public access except where explicitly required",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-kube-0001",
        "References": [
          "https://avd.aquasec.com/misconfig/avd-kube-0001"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.portfolio",
          "Provider": "Kubernetes",
          "Service": "network",
          "StartLine": 85,
          "EndLine": 85,
          "Code": {
            "Lines": [
              {
                "Number": 66,
                "Content": "resource \"kubernetes_network_policy\" \"ui_ingress\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"kubernetes_network_policy\"\u001b[0m \u001b[38;5;37m\"ui_ingress\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 67,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 85,
                "Content": "          cidr = \"0.0.0.0/0\"",
                "IsCause": true,
                "Annotation": "\"0.0.0.0/0\"",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;245mcidr\u001b[0m = \u001b[38;5;37m\"0.0.0.0/0\"",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 94,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 95,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "ip_block",
              "Filename": "infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf",
              "Location": {
                "StartLine": 84,
                "EndLine": 86
              }
            },
            {
              "Resource": "from",
              "Filename": "infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf",
              "Location": {
                "StartLine": 82,
                "EndLine": 87
              }
            },
            {
              "Resource": "ingress",
              "Filename": "infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf",
              "Location": {
                "StartLine": 81,
                "EndLine": 93
              }
            },
            {
              "Resource": "spec",
              "Filename": "infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 94
              }
            },
            {
              "Resource": "kubernetes_network_policy.ui_ingress",
              "Filename": "infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf",
              "Location": {
                "StartLine": 66,
                "EndLine": 95
              }
            },
            {
              "Resource": "module.portfolio",
              "Filename": "infrastructure/method2-terraform-localstack/s1-terraform-simple/main.tf",
              "Location": {
                "StartLine": 57,
                "EndLine": 78
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "CloudWatch log groups should be encrypted using CMK",
      "description": "CloudWatch log groups are encrypted by default, however, to get the full benefit of controlling key rotation and other KMS aspects a KMS CMK should be used.",
      "file": "aws_cloudwatch_log_group.lambda_chat",
      "line": 88,
      "rule_id": "AVD-AWS-0017",
      "remediation": "Enable CMK encryption of CloudWatch Log Groups",
      "references": [
        "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0017"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0017",
        "AVDID": "AVD-AWS-0017",
        "Title": "CloudWatch log groups should be encrypted using CMK",
        "Description": "CloudWatch log groups are encrypted by default, however, to get the full benefit of controlling key rotation and other KMS aspects a KMS CMK should be used.",
        "Message": "Log group is not encrypted.",
        "Query": "data..",
        "Resolution": "Enable CMK encryption of CloudWatch Log Groups",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0017",
        "References": [
          "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0017"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_cloudwatch_log_group.lambda_chat",
          "Provider": "AWS",
          "Service": "cloudwatch",
          "StartLine": 88,
          "EndLine": 97,
          "Code": {
            "Lines": [
              {
                "Number": 88,
                "Content": "resource \"aws_cloudwatch_log_group\" \"lambda_chat\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_cloudwatch_log_group\"\u001b[0m \u001b[38;5;37m\"lambda_chat\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 89,
                "Content": "  name              = \"/aws/lambda/${aws_lambda_function.chat_handler.function_name}\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m              = \u001b[38;5;37m\"/aws/lambda/\u001b[0m\u001b[38;5;37m${\u001b[0maws_lambda_function.chat_handler.function_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 90,
                "Content": "  retention_in_days = 7",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mretention_in_days\u001b[0m = \u001b[38;5;37m7",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 91,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 92,
                "Content": "  tags = {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 93,
                "Content": "    Project     = var.project_name",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mProject\u001b[0m     = \u001b[38;5;33mvar\u001b[0m.project_name",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 94,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 95,
                "Content": "    Function    = \"chat-handler\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mFunction\u001b[0m    = \u001b[38;5;37m\"chat-handler\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 96,
                "Content": "  }",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  }",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Lambda functions should have X-Ray tracing enabled",
      "description": "X-Ray tracing enables end-to-end debugging and analysis of all function activity. This will allow for identifying bottlenecks, slow downs and timeouts.",
      "file": "aws_lambda_function.chat_handler",
      "line": 57,
      "rule_id": "AVD-AWS-0066",
      "remediation": "Enable tracing",
      "references": [
        "https://docs.aws.amazon.com/lambda/latest/dg/services-xray.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0066"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0066",
        "AVDID": "AVD-AWS-0066",
        "Title": "Lambda functions should have X-Ray tracing enabled",
        "Description": "X-Ray tracing enables end-to-end debugging and analysis of all function activity. This will allow for identifying bottlenecks, slow downs and timeouts.",
        "Message": "Function does not have tracing enabled.",
        "Query": "data..",
        "Resolution": "Enable tracing",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0066",
        "References": [
          "https://docs.aws.amazon.com/lambda/latest/dg/services-xray.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0066"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_lambda_function.chat_handler",
          "Provider": "AWS",
          "Service": "lambda",
          "StartLine": 57,
          "EndLine": 82,
          "Code": {
            "Lines": [
              {
                "Number": 57,
                "Content": "resource \"aws_lambda_function\" \"chat_handler\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lambda_function\"\u001b[0m \u001b[38;5;37m\"chat_handler\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 58,
                "Content": "  filename      = \"${path.module}/../../../lambda-functions/chat-handler.zip\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mfilename\u001b[0m      = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mpath.\u001b[38;5;33mmodule\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m/../../../lambda-functions/chat-handler.zip\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 59,
                "Content": "  function_name = \"${var.project_name}-chat-handler\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mfunction_name\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-chat-handler\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 60,
                "Content": "  role          = aws_iam_role.lambda_exec.arn",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mrole\u001b[0m          = aws_iam_role.lambda_exec.arn",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 61,
                "Content": "  handler       = \"lambda_function.lambda_handler\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mhandler\u001b[0m       = \u001b[38;5;37m\"lambda_function.lambda_handler\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 62,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 63,
                "Content": "  source_code_hash = filebase64sha256(\"${path.module}/../../../lambda-functions/chat-handler.zip\")",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245msource_code_hash\u001b[0m = \u001b[38;5;33mfilebase64sha256\u001b[0m(\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mpath.\u001b[38;5;33mmodule\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m/../../../lambda-functions/chat-handler.zip\"\u001b[0m)",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 64,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 65,
                "Content": "  runtime = \"python3.11\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mruntime\u001b[0m = \u001b[38;5;37m\"python3.11\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 66,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
      "description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
      "file": "data.aws_iam_policy_document.lambda_secrets_access",
      "line": 155,
      "rule_id": "AVD-AWS-0057",
      "remediation": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
      "references": [
        "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0057"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0057",
        "AVDID": "AVD-AWS-0057",
        "Title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
        "Description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
        "Message": "IAM policy document uses sensitive action 'logs:CreateLogStream' on wildcarded resource 'arn:aws:logs:*:*:*'",
        "Query": "data..",
        "Resolution": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0057",
        "References": [
          "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0057"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "data.aws_iam_policy_document.lambda_secrets_access",
          "Provider": "AWS",
          "Service": "iam",
          "StartLine": 155,
          "EndLine": 155,
          "Code": {
            "Lines": [
              {
                "Number": 126,
                "Content": "data \"aws_iam_policy_document\" \"lambda_secrets_access\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mdata\u001b[0m \u001b[38;5;37m\"aws_iam_policy_document\"\u001b[0m \u001b[38;5;37m\"lambda_secrets_access\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 127,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 155,
                "Content": "    resources = [\"arn:aws:logs:*:*:*\"]",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mresources\u001b[0m = [\u001b[38;5;37m\"arn:aws:logs:*:*:*\"\u001b[0m]",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 156,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 157,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "data.aws_iam_policy_document.lambda_secrets_access",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/modules/aws-resources/secrets/main.tf",
              "Location": {
                "StartLine": 145,
                "EndLine": 156
              }
            },
            {
              "Resource": "data.aws_iam_policy_document.lambda_secrets_access",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/modules/aws-resources/secrets/main.tf",
              "Location": {
                "StartLine": 126,
                "EndLine": 157
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Secrets Manager should use customer managed keys",
      "description": "Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.",
      "file": "aws_secretsmanager_secret.claude_api_key",
      "line": 17,
      "rule_id": "AVD-AWS-0098",
      "remediation": "Use customer managed keys",
      "references": [
        "https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt",
        "https://avd.aquasec.com/misconfig/avd-aws-0098"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0098",
        "AVDID": "AVD-AWS-0098",
        "Title": "Secrets Manager should use customer managed keys",
        "Description": "Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.",
        "Message": "Secret explicitly uses the default key.",
        "Query": "data..",
        "Resolution": "Use customer managed keys",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0098",
        "References": [
          "https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt",
          "https://avd.aquasec.com/misconfig/avd-aws-0098"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_secretsmanager_secret.claude_api_key",
          "Provider": "AWS",
          "Service": "ssm",
          "StartLine": 17,
          "EndLine": 27,
          "Code": {
            "Lines": [
              {
                "Number": 17,
                "Content": "resource \"aws_secretsmanager_secret\" \"claude_api_key\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_secretsmanager_secret\"\u001b[0m \u001b[38;5;37m\"claude_api_key\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 18,
                "Content": "  name        = \"${var.project_name}/claude-api-key\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m/claude-api-key\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "  description = \"Anthropic Claude API key for LLM chat completions\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m = \u001b[38;5;37m\"Anthropic Claude API key for LLM chat completions\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "  tags = {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "    Project     = var.project_name",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mProject\u001b[0m     = \u001b[38;5;33mvar\u001b[0m.project_name",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "    ManagedBy   = \"terraform\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mManagedBy\u001b[0m   = \u001b[38;5;37m\"terraform\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "    Service     = \"llm\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mService\u001b[0m     = \u001b[38;5;37m\"llm\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 26,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Secrets Manager should use customer managed keys",
      "description": "Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.",
      "file": "aws_secretsmanager_secret.database_credentials",
      "line": 101,
      "rule_id": "AVD-AWS-0098",
      "remediation": "Use customer managed keys",
      "references": [
        "https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt",
        "https://avd.aquasec.com/misconfig/avd-aws-0098"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0098",
        "AVDID": "AVD-AWS-0098",
        "Title": "Secrets Manager should use customer managed keys",
        "Description": "Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.",
        "Message": "Secret explicitly uses the default key.",
        "Query": "data..",
        "Resolution": "Use customer managed keys",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0098",
        "References": [
          "https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt",
          "https://avd.aquasec.com/misconfig/avd-aws-0098"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_secretsmanager_secret.database_credentials",
          "Provider": "AWS",
          "Service": "ssm",
          "StartLine": 101,
          "EndLine": 111,
          "Code": {
            "Lines": [
              {
                "Number": 101,
                "Content": "resource \"aws_secretsmanager_secret\" \"database_credentials\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_secretsmanager_secret\"\u001b[0m \u001b[38;5;37m\"database_credentials\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 102,
                "Content": "  name        = \"${var.project_name}/database-credentials\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m/database-credentials\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 103,
                "Content": "  description = \"ChromaDB connection credentials\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m = \u001b[38;5;37m\"ChromaDB connection credentials\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 104,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 105,
                "Content": "  tags = {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 106,
                "Content": "    Project     = var.project_name",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mProject\u001b[0m     = \u001b[38;5;33mvar\u001b[0m.project_name",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 107,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 108,
                "Content": "    ManagedBy   = \"terraform\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mManagedBy\u001b[0m   = \u001b[38;5;37m\"terraform\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 109,
                "Content": "    Service     = \"database\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mService\u001b[0m     = \u001b[38;5;37m\"database\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 110,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Secrets Manager should use customer managed keys",
      "description": "Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.",
      "file": "aws_secretsmanager_secret.did_api_key",
      "line": 80,
      "rule_id": "AVD-AWS-0098",
      "remediation": "Use customer managed keys",
      "references": [
        "https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt",
        "https://avd.aquasec.com/misconfig/avd-aws-0098"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0098",
        "AVDID": "AVD-AWS-0098",
        "Title": "Secrets Manager should use customer managed keys",
        "Description": "Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.",
        "Message": "Secret explicitly uses the default key.",
        "Query": "data..",
        "Resolution": "Use customer managed keys",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0098",
        "References": [
          "https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt",
          "https://avd.aquasec.com/misconfig/avd-aws-0098"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_secretsmanager_secret.did_api_key",
          "Provider": "AWS",
          "Service": "ssm",
          "StartLine": 80,
          "EndLine": 90,
          "Code": {
            "Lines": [
              {
                "Number": 80,
                "Content": "resource \"aws_secretsmanager_secret\" \"did_api_key\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_secretsmanager_secret\"\u001b[0m \u001b[38;5;37m\"did_api_key\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 81,
                "Content": "  name        = \"${var.project_name}/did-api-key\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m/did-api-key\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 82,
                "Content": "  description = \"D-ID API key for avatar generation\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m = \u001b[38;5;37m\"D-ID API key for avatar generation\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 83,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 84,
                "Content": "  tags = {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 85,
                "Content": "    Project     = var.project_name",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mProject\u001b[0m     = \u001b[38;5;33mvar\u001b[0m.project_name",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 86,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 87,
                "Content": "    ManagedBy   = \"terraform\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mManagedBy\u001b[0m   = \u001b[38;5;37m\"terraform\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 88,
                "Content": "    Service     = \"avatar\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mService\u001b[0m     = \u001b[38;5;37m\"avatar\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 89,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Secrets Manager should use customer managed keys",
      "description": "Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.",
      "file": "aws_secretsmanager_secret.elevenlabs_api_key",
      "line": 59,
      "rule_id": "AVD-AWS-0098",
      "remediation": "Use customer managed keys",
      "references": [
        "https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt",
        "https://avd.aquasec.com/misconfig/avd-aws-0098"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0098",
        "AVDID": "AVD-AWS-0098",
        "Title": "Secrets Manager should use customer managed keys",
        "Description": "Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.",
        "Message": "Secret explicitly uses the default key.",
        "Query": "data..",
        "Resolution": "Use customer managed keys",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0098",
        "References": [
          "https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt",
          "https://avd.aquasec.com/misconfig/avd-aws-0098"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_secretsmanager_secret.elevenlabs_api_key",
          "Provider": "AWS",
          "Service": "ssm",
          "StartLine": 59,
          "EndLine": 69,
          "Code": {
            "Lines": [
              {
                "Number": 59,
                "Content": "resource \"aws_secretsmanager_secret\" \"elevenlabs_api_key\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_secretsmanager_secret\"\u001b[0m \u001b[38;5;37m\"elevenlabs_api_key\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 60,
                "Content": "  name        = \"${var.project_name}/elevenlabs-api-key\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m/elevenlabs-api-key\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 61,
                "Content": "  description = \"ElevenLabs API key for voice synthesis\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m = \u001b[38;5;37m\"ElevenLabs API key for voice synthesis\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 62,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 63,
                "Content": "  tags = {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 64,
                "Content": "    Project     = var.project_name",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mProject\u001b[0m     = \u001b[38;5;33mvar\u001b[0m.project_name",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 65,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 66,
                "Content": "    ManagedBy   = \"terraform\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mManagedBy\u001b[0m   = \u001b[38;5;37m\"terraform\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 67,
                "Content": "    Service     = \"voice\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mService\u001b[0m     = \u001b[38;5;37m\"voice\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 68,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Secrets Manager should use customer managed keys",
      "description": "Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.",
      "file": "aws_secretsmanager_secret.openai_api_key",
      "line": 38,
      "rule_id": "AVD-AWS-0098",
      "remediation": "Use customer managed keys",
      "references": [
        "https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt",
        "https://avd.aquasec.com/misconfig/avd-aws-0098"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0098",
        "AVDID": "AVD-AWS-0098",
        "Title": "Secrets Manager should use customer managed keys",
        "Description": "Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.",
        "Message": "Secret explicitly uses the default key.",
        "Query": "data..",
        "Resolution": "Use customer managed keys",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0098",
        "References": [
          "https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt",
          "https://avd.aquasec.com/misconfig/avd-aws-0098"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_secretsmanager_secret.openai_api_key",
          "Provider": "AWS",
          "Service": "ssm",
          "StartLine": 38,
          "EndLine": 48,
          "Code": {
            "Lines": [
              {
                "Number": 38,
                "Content": "resource \"aws_secretsmanager_secret\" \"openai_api_key\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_secretsmanager_secret\"\u001b[0m \u001b[38;5;37m\"openai_api_key\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "  name        = \"${var.project_name}/openai-api-key\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m/openai-api-key\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "  description = \"OpenAI API key for fallback LLM and embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m = \u001b[38;5;37m\"OpenAI API key for fallback LLM and embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "  tags = {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "    Project     = var.project_name",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mProject\u001b[0m     = \u001b[38;5;33mvar\u001b[0m.project_name",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 44,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 45,
                "Content": "    ManagedBy   = \"terraform\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mManagedBy\u001b[0m   = \u001b[38;5;37m\"terraform\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 46,
                "Content": "    Service     = \"llm\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mService\u001b[0m     = \u001b[38;5;37m\"llm\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 47,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "Point in time recovery should be enabled to protect DynamoDB table",
      "description": "DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\n\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.",
      "file": "module.storage",
      "line": 150,
      "rule_id": "AVD-AWS-0024",
      "remediation": "Enable point in time recovery",
      "references": [
        "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0024"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0024",
        "AVDID": "AVD-AWS-0024",
        "Title": "Point in time recovery should be enabled to protect DynamoDB table",
        "Description": "DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\n\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.",
        "Message": "Point-in-time recovery is not enabled.",
        "Query": "data..",
        "Resolution": "Enable point in time recovery",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0024",
        "References": [
          "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0024"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "dynamodb",
          "StartLine": 150,
          "EndLine": 191,
          "Code": {
            "Lines": [
              {
                "Number": 150,
                "Content": "resource \"aws_dynamodb_table\" \"ingestion_jobs\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_dynamodb_table\"\u001b[0m \u001b[38;5;37m\"ingestion_jobs\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 151,
                "Content": "  name           = \"${var.project_name}-ingestion-jobs\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m           = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-ingestion-jobs\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 152,
                "Content": "  billing_mode   = \"PAY_PER_REQUEST\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mbilling_mode\u001b[0m   = \u001b[38;5;37m\"PAY_PER_REQUEST\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 153,
                "Content": "  hash_key       = \"job_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mhash_key\u001b[0m       = \u001b[38;5;37m\"job_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 154,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 155,
                "Content": "  attribute {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  attribute {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 156,
                "Content": "    name = \"job_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"job_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 157,
                "Content": "    type = \"S\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mtype\u001b[0m = \u001b[38;5;37m\"S\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 158,
                "Content": "  }",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  }",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 159,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "Point in time recovery should be enabled to protect DynamoDB table",
      "description": "DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\n\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.",
      "file": "module.storage",
      "line": 150,
      "rule_id": "AVD-AWS-0024",
      "remediation": "Enable point in time recovery",
      "references": [
        "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0024"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0024",
        "AVDID": "AVD-AWS-0024",
        "Title": "Point in time recovery should be enabled to protect DynamoDB table",
        "Description": "DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\n\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.",
        "Message": "Point-in-time recovery is not enabled.",
        "Query": "data..",
        "Resolution": "Enable point in time recovery",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0024",
        "References": [
          "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0024"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "dynamodb",
          "StartLine": 150,
          "EndLine": 191,
          "Code": {
            "Lines": [
              {
                "Number": 150,
                "Content": "resource \"aws_dynamodb_table\" \"ingestion_jobs\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_dynamodb_table\"\u001b[0m \u001b[38;5;37m\"ingestion_jobs\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 151,
                "Content": "  name           = \"${var.project_name}-ingestion-jobs\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m           = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-ingestion-jobs\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 152,
                "Content": "  billing_mode   = \"PAY_PER_REQUEST\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mbilling_mode\u001b[0m   = \u001b[38;5;37m\"PAY_PER_REQUEST\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 153,
                "Content": "  hash_key       = \"job_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mhash_key\u001b[0m       = \u001b[38;5;37m\"job_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 154,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 155,
                "Content": "  attribute {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  attribute {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 156,
                "Content": "    name = \"job_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"job_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 157,
                "Content": "    type = \"S\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mtype\u001b[0m = \u001b[38;5;37m\"S\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 158,
                "Content": "  }",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  }",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 159,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "Point in time recovery should be enabled to protect DynamoDB table",
      "description": "DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\n\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.",
      "file": "module.storage",
      "line": 105,
      "rule_id": "AVD-AWS-0024",
      "remediation": "Enable point in time recovery",
      "references": [
        "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0024"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0024",
        "AVDID": "AVD-AWS-0024",
        "Title": "Point in time recovery should be enabled to protect DynamoDB table",
        "Description": "DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\n\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.",
        "Message": "Point-in-time recovery is not enabled.",
        "Query": "data..",
        "Resolution": "Enable point in time recovery",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0024",
        "References": [
          "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0024"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "dynamodb",
          "StartLine": 105,
          "EndLine": 147,
          "Code": {
            "Lines": [
              {
                "Number": 105,
                "Content": "resource \"aws_dynamodb_table\" \"embedding_chunks\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_dynamodb_table\"\u001b[0m \u001b[38;5;37m\"embedding_chunks\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 106,
                "Content": "  name           = \"${var.project_name}-embedding-chunks\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m           = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embedding-chunks\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 107,
                "Content": "  billing_mode   = \"PAY_PER_REQUEST\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mbilling_mode\u001b[0m   = \u001b[38;5;37m\"PAY_PER_REQUEST\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 108,
                "Content": "  hash_key       = \"chunk_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mhash_key\u001b[0m       = \u001b[38;5;37m\"chunk_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 109,
                "Content": "  range_key      = \"document_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mrange_key\u001b[0m      = \u001b[38;5;37m\"document_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 110,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 111,
                "Content": "  attribute {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  attribute {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 112,
                "Content": "    name = \"chunk_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"chunk_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 113,
                "Content": "    type = \"S\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mtype\u001b[0m = \u001b[38;5;37m\"S\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 114,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "Point in time recovery should be enabled to protect DynamoDB table",
      "description": "DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\n\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.",
      "file": "module.storage",
      "line": 55,
      "rule_id": "AVD-AWS-0024",
      "remediation": "Enable point in time recovery",
      "references": [
        "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0024"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0024",
        "AVDID": "AVD-AWS-0024",
        "Title": "Point in time recovery should be enabled to protect DynamoDB table",
        "Description": "DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\n\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.",
        "Message": "Point-in-time recovery is not enabled.",
        "Query": "data..",
        "Resolution": "Enable point in time recovery",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0024",
        "References": [
          "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0024"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "dynamodb",
          "StartLine": 55,
          "EndLine": 102,
          "Code": {
            "Lines": [
              {
                "Number": 55,
                "Content": "resource \"aws_dynamodb_table\" \"document_registry\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_dynamodb_table\"\u001b[0m \u001b[38;5;37m\"document_registry\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 56,
                "Content": "  name           = \"${var.project_name}-document-registry\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m           = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-document-registry\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 57,
                "Content": "  billing_mode   = \"PAY_PER_REQUEST\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mbilling_mode\u001b[0m   = \u001b[38;5;37m\"PAY_PER_REQUEST\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 58,
                "Content": "  hash_key       = \"document_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mhash_key\u001b[0m       = \u001b[38;5;37m\"document_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 59,
                "Content": "  range_key      = \"version\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mrange_key\u001b[0m      = \u001b[38;5;37m\"version\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 60,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 61,
                "Content": "  attribute {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  attribute {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 62,
                "Content": "    name = \"document_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"document_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 63,
                "Content": "    type = \"S\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mtype\u001b[0m = \u001b[38;5;37m\"S\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 64,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "Point in time recovery should be enabled to protect DynamoDB table",
      "description": "DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\n\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.",
      "file": "module.storage",
      "line": 55,
      "rule_id": "AVD-AWS-0024",
      "remediation": "Enable point in time recovery",
      "references": [
        "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0024"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0024",
        "AVDID": "AVD-AWS-0024",
        "Title": "Point in time recovery should be enabled to protect DynamoDB table",
        "Description": "DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\n\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.",
        "Message": "Point-in-time recovery is not enabled.",
        "Query": "data..",
        "Resolution": "Enable point in time recovery",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0024",
        "References": [
          "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0024"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "dynamodb",
          "StartLine": 55,
          "EndLine": 102,
          "Code": {
            "Lines": [
              {
                "Number": 55,
                "Content": "resource \"aws_dynamodb_table\" \"document_registry\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_dynamodb_table\"\u001b[0m \u001b[38;5;37m\"document_registry\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 56,
                "Content": "  name           = \"${var.project_name}-document-registry\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m           = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-document-registry\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 57,
                "Content": "  billing_mode   = \"PAY_PER_REQUEST\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mbilling_mode\u001b[0m   = \u001b[38;5;37m\"PAY_PER_REQUEST\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 58,
                "Content": "  hash_key       = \"document_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mhash_key\u001b[0m       = \u001b[38;5;37m\"document_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 59,
                "Content": "  range_key      = \"version\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mrange_key\u001b[0m      = \u001b[38;5;37m\"version\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 60,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 61,
                "Content": "  attribute {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  attribute {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 62,
                "Content": "    name = \"document_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"document_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 63,
                "Content": "    type = \"S\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mtype\u001b[0m = \u001b[38;5;37m\"S\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 64,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "Point in time recovery should be enabled to protect DynamoDB table",
      "description": "DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\n\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.",
      "file": "module.storage",
      "line": 105,
      "rule_id": "AVD-AWS-0024",
      "remediation": "Enable point in time recovery",
      "references": [
        "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0024"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0024",
        "AVDID": "AVD-AWS-0024",
        "Title": "Point in time recovery should be enabled to protect DynamoDB table",
        "Description": "DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\n\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.",
        "Message": "Point-in-time recovery is not enabled.",
        "Query": "data..",
        "Resolution": "Enable point in time recovery",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0024",
        "References": [
          "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0024"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "dynamodb",
          "StartLine": 105,
          "EndLine": 147,
          "Code": {
            "Lines": [
              {
                "Number": 105,
                "Content": "resource \"aws_dynamodb_table\" \"embedding_chunks\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_dynamodb_table\"\u001b[0m \u001b[38;5;37m\"embedding_chunks\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 106,
                "Content": "  name           = \"${var.project_name}-embedding-chunks\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m           = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embedding-chunks\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 107,
                "Content": "  billing_mode   = \"PAY_PER_REQUEST\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mbilling_mode\u001b[0m   = \u001b[38;5;37m\"PAY_PER_REQUEST\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 108,
                "Content": "  hash_key       = \"chunk_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mhash_key\u001b[0m       = \u001b[38;5;37m\"chunk_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 109,
                "Content": "  range_key      = \"document_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mrange_key\u001b[0m      = \u001b[38;5;37m\"document_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 110,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 111,
                "Content": "  attribute {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  attribute {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 112,
                "Content": "    name = \"chunk_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"chunk_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 113,
                "Content": "    type = \"S\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mtype\u001b[0m = \u001b[38;5;37m\"S\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 114,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "DynamoDB tables should use at rest encryption with a Customer Managed Key",
      "description": "DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.",
      "file": "module.storage",
      "line": 150,
      "rule_id": "AVD-AWS-0025",
      "remediation": "Enable server side encryption with a customer managed key",
      "references": [
        "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0025"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0025",
        "AVDID": "AVD-AWS-0025",
        "Title": "DynamoDB tables should use at rest encryption with a Customer Managed Key",
        "Description": "DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.",
        "Message": "Table encryption does not use a customer-managed KMS key.",
        "Query": "data..",
        "Resolution": "Enable server side encryption with a customer managed key",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0025",
        "References": [
          "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0025"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "dynamodb",
          "StartLine": 150,
          "EndLine": 191,
          "Code": {
            "Lines": [
              {
                "Number": 150,
                "Content": "resource \"aws_dynamodb_table\" \"ingestion_jobs\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_dynamodb_table\"\u001b[0m \u001b[38;5;37m\"ingestion_jobs\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 151,
                "Content": "  name           = \"${var.project_name}-ingestion-jobs\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m           = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-ingestion-jobs\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 152,
                "Content": "  billing_mode   = \"PAY_PER_REQUEST\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mbilling_mode\u001b[0m   = \u001b[38;5;37m\"PAY_PER_REQUEST\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 153,
                "Content": "  hash_key       = \"job_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mhash_key\u001b[0m       = \u001b[38;5;37m\"job_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 154,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 155,
                "Content": "  attribute {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  attribute {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 156,
                "Content": "    name = \"job_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"job_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 157,
                "Content": "    type = \"S\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mtype\u001b[0m = \u001b[38;5;37m\"S\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 158,
                "Content": "  }",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  }",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 159,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "DynamoDB tables should use at rest encryption with a Customer Managed Key",
      "description": "DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.",
      "file": "module.storage",
      "line": 105,
      "rule_id": "AVD-AWS-0025",
      "remediation": "Enable server side encryption with a customer managed key",
      "references": [
        "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0025"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0025",
        "AVDID": "AVD-AWS-0025",
        "Title": "DynamoDB tables should use at rest encryption with a Customer Managed Key",
        "Description": "DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.",
        "Message": "Table encryption does not use a customer-managed KMS key.",
        "Query": "data..",
        "Resolution": "Enable server side encryption with a customer managed key",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0025",
        "References": [
          "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0025"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "dynamodb",
          "StartLine": 105,
          "EndLine": 147,
          "Code": {
            "Lines": [
              {
                "Number": 105,
                "Content": "resource \"aws_dynamodb_table\" \"embedding_chunks\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_dynamodb_table\"\u001b[0m \u001b[38;5;37m\"embedding_chunks\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 106,
                "Content": "  name           = \"${var.project_name}-embedding-chunks\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m           = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embedding-chunks\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 107,
                "Content": "  billing_mode   = \"PAY_PER_REQUEST\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mbilling_mode\u001b[0m   = \u001b[38;5;37m\"PAY_PER_REQUEST\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 108,
                "Content": "  hash_key       = \"chunk_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mhash_key\u001b[0m       = \u001b[38;5;37m\"chunk_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 109,
                "Content": "  range_key      = \"document_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mrange_key\u001b[0m      = \u001b[38;5;37m\"document_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 110,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 111,
                "Content": "  attribute {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  attribute {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 112,
                "Content": "    name = \"chunk_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"chunk_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 113,
                "Content": "    type = \"S\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mtype\u001b[0m = \u001b[38;5;37m\"S\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 114,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "DynamoDB tables should use at rest encryption with a Customer Managed Key",
      "description": "DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.",
      "file": "module.storage",
      "line": 55,
      "rule_id": "AVD-AWS-0025",
      "remediation": "Enable server side encryption with a customer managed key",
      "references": [
        "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0025"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0025",
        "AVDID": "AVD-AWS-0025",
        "Title": "DynamoDB tables should use at rest encryption with a Customer Managed Key",
        "Description": "DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.",
        "Message": "Table encryption does not use a customer-managed KMS key.",
        "Query": "data..",
        "Resolution": "Enable server side encryption with a customer managed key",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0025",
        "References": [
          "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0025"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "dynamodb",
          "StartLine": 55,
          "EndLine": 102,
          "Code": {
            "Lines": [
              {
                "Number": 55,
                "Content": "resource \"aws_dynamodb_table\" \"document_registry\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_dynamodb_table\"\u001b[0m \u001b[38;5;37m\"document_registry\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 56,
                "Content": "  name           = \"${var.project_name}-document-registry\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m           = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-document-registry\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 57,
                "Content": "  billing_mode   = \"PAY_PER_REQUEST\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mbilling_mode\u001b[0m   = \u001b[38;5;37m\"PAY_PER_REQUEST\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 58,
                "Content": "  hash_key       = \"document_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mhash_key\u001b[0m       = \u001b[38;5;37m\"document_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 59,
                "Content": "  range_key      = \"version\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mrange_key\u001b[0m      = \u001b[38;5;37m\"version\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 60,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 61,
                "Content": "  attribute {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  attribute {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 62,
                "Content": "    name = \"document_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"document_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 63,
                "Content": "    type = \"S\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mtype\u001b[0m = \u001b[38;5;37m\"S\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 64,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "DynamoDB tables should use at rest encryption with a Customer Managed Key",
      "description": "DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.",
      "file": "module.storage",
      "line": 150,
      "rule_id": "AVD-AWS-0025",
      "remediation": "Enable server side encryption with a customer managed key",
      "references": [
        "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0025"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0025",
        "AVDID": "AVD-AWS-0025",
        "Title": "DynamoDB tables should use at rest encryption with a Customer Managed Key",
        "Description": "DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.",
        "Message": "Table encryption does not use a customer-managed KMS key.",
        "Query": "data..",
        "Resolution": "Enable server side encryption with a customer managed key",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0025",
        "References": [
          "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0025"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "dynamodb",
          "StartLine": 150,
          "EndLine": 191,
          "Code": {
            "Lines": [
              {
                "Number": 150,
                "Content": "resource \"aws_dynamodb_table\" \"ingestion_jobs\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_dynamodb_table\"\u001b[0m \u001b[38;5;37m\"ingestion_jobs\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 151,
                "Content": "  name           = \"${var.project_name}-ingestion-jobs\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m           = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-ingestion-jobs\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 152,
                "Content": "  billing_mode   = \"PAY_PER_REQUEST\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mbilling_mode\u001b[0m   = \u001b[38;5;37m\"PAY_PER_REQUEST\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 153,
                "Content": "  hash_key       = \"job_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mhash_key\u001b[0m       = \u001b[38;5;37m\"job_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 154,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 155,
                "Content": "  attribute {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  attribute {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 156,
                "Content": "    name = \"job_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"job_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 157,
                "Content": "    type = \"S\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mtype\u001b[0m = \u001b[38;5;37m\"S\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 158,
                "Content": "  }",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  }",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 159,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "DynamoDB tables should use at rest encryption with a Customer Managed Key",
      "description": "DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.",
      "file": "module.storage",
      "line": 105,
      "rule_id": "AVD-AWS-0025",
      "remediation": "Enable server side encryption with a customer managed key",
      "references": [
        "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0025"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0025",
        "AVDID": "AVD-AWS-0025",
        "Title": "DynamoDB tables should use at rest encryption with a Customer Managed Key",
        "Description": "DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.",
        "Message": "Table encryption does not use a customer-managed KMS key.",
        "Query": "data..",
        "Resolution": "Enable server side encryption with a customer managed key",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0025",
        "References": [
          "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0025"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "dynamodb",
          "StartLine": 105,
          "EndLine": 147,
          "Code": {
            "Lines": [
              {
                "Number": 105,
                "Content": "resource \"aws_dynamodb_table\" \"embedding_chunks\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_dynamodb_table\"\u001b[0m \u001b[38;5;37m\"embedding_chunks\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 106,
                "Content": "  name           = \"${var.project_name}-embedding-chunks\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m           = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embedding-chunks\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 107,
                "Content": "  billing_mode   = \"PAY_PER_REQUEST\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mbilling_mode\u001b[0m   = \u001b[38;5;37m\"PAY_PER_REQUEST\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 108,
                "Content": "  hash_key       = \"chunk_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mhash_key\u001b[0m       = \u001b[38;5;37m\"chunk_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 109,
                "Content": "  range_key      = \"document_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mrange_key\u001b[0m      = \u001b[38;5;37m\"document_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 110,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 111,
                "Content": "  attribute {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  attribute {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 112,
                "Content": "    name = \"chunk_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"chunk_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 113,
                "Content": "    type = \"S\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mtype\u001b[0m = \u001b[38;5;37m\"S\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 114,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "DynamoDB tables should use at rest encryption with a Customer Managed Key",
      "description": "DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.",
      "file": "module.storage",
      "line": 55,
      "rule_id": "AVD-AWS-0025",
      "remediation": "Enable server side encryption with a customer managed key",
      "references": [
        "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0025"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0025",
        "AVDID": "AVD-AWS-0025",
        "Title": "DynamoDB tables should use at rest encryption with a Customer Managed Key",
        "Description": "DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.",
        "Message": "Table encryption does not use a customer-managed KMS key.",
        "Query": "data..",
        "Resolution": "Enable server side encryption with a customer managed key",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0025",
        "References": [
          "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0025"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "dynamodb",
          "StartLine": 55,
          "EndLine": 102,
          "Code": {
            "Lines": [
              {
                "Number": 55,
                "Content": "resource \"aws_dynamodb_table\" \"document_registry\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_dynamodb_table\"\u001b[0m \u001b[38;5;37m\"document_registry\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 56,
                "Content": "  name           = \"${var.project_name}-document-registry\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m           = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-document-registry\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 57,
                "Content": "  billing_mode   = \"PAY_PER_REQUEST\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mbilling_mode\u001b[0m   = \u001b[38;5;37m\"PAY_PER_REQUEST\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 58,
                "Content": "  hash_key       = \"document_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mhash_key\u001b[0m       = \u001b[38;5;37m\"document_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 59,
                "Content": "  range_key      = \"version\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mrange_key\u001b[0m      = \u001b[38;5;37m\"version\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 60,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 61,
                "Content": "  attribute {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  attribute {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 62,
                "Content": "    name = \"document_id\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"document_id\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 63,
                "Content": "    type = \"S\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mtype\u001b[0m = \u001b[38;5;37m\"S\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 64,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access block should block public ACL",
      "description": "\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
      "file": "module.storage",
      "line": 25,
      "rule_id": "AVD-AWS-0086",
      "remediation": "Enable blocking any PUT calls with a public ACL specified",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0086"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0086",
        "AVDID": "AVD-AWS-0086",
        "Title": "S3 Access block should block public ACL",
        "Description": "\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
        "Message": "No public access block so not blocking public acls",
        "Query": "data..",
        "Resolution": "Enable blocking any PUT calls with a public ACL specified",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0086"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 25,
          "EndLine": 33,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_embeddings\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_embeddings\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  bucket = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    Name        = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "    Purpose     = \"Processed embeddings storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Processed embeddings storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access block should block public ACL",
      "description": "\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
      "file": "module.storage",
      "line": 15,
      "rule_id": "AVD-AWS-0086",
      "remediation": "Enable blocking any PUT calls with a public ACL specified",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0086"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0086",
        "AVDID": "AVD-AWS-0086",
        "Title": "S3 Access block should block public ACL",
        "Description": "\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
        "Message": "No public access block so not blocking public acls",
        "Query": "data..",
        "Resolution": "Enable blocking any PUT calls with a public ACL specified",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0086"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 15,
          "EndLine": 23,
          "Code": {
            "Lines": [
              {
                "Number": 15,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_raw\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_raw\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "  bucket = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 17,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 18,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "    Name        = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "    Purpose     = \"Raw document storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Raw document storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access block should block public ACL",
      "description": "\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
      "file": "module.storage",
      "line": 35,
      "rule_id": "AVD-AWS-0086",
      "remediation": "Enable blocking any PUT calls with a public ACL specified",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0086"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0086",
        "AVDID": "AVD-AWS-0086",
        "Title": "S3 Access block should block public ACL",
        "Description": "\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
        "Message": "No public access block so not blocking public acls",
        "Query": "data..",
        "Resolution": "Enable blocking any PUT calls with a public ACL specified",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0086"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 35,
          "EndLine": 43,
          "Code": {
            "Lines": [
              {
                "Number": 35,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_config\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_config\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  bucket = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "    Name        = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "    Purpose     = \"Configuration and secrets\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Configuration and secrets\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access block should block public ACL",
      "description": "\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
      "file": "module.storage",
      "line": 35,
      "rule_id": "AVD-AWS-0086",
      "remediation": "Enable blocking any PUT calls with a public ACL specified",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0086"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0086",
        "AVDID": "AVD-AWS-0086",
        "Title": "S3 Access block should block public ACL",
        "Description": "\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
        "Message": "No public access block so not blocking public acls",
        "Query": "data..",
        "Resolution": "Enable blocking any PUT calls with a public ACL specified",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0086"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 35,
          "EndLine": 43,
          "Code": {
            "Lines": [
              {
                "Number": 35,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_config\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_config\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  bucket = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "    Name        = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "    Purpose     = \"Configuration and secrets\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Configuration and secrets\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access block should block public ACL",
      "description": "\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
      "file": "module.storage",
      "line": 25,
      "rule_id": "AVD-AWS-0086",
      "remediation": "Enable blocking any PUT calls with a public ACL specified",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0086"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0086",
        "AVDID": "AVD-AWS-0086",
        "Title": "S3 Access block should block public ACL",
        "Description": "\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
        "Message": "No public access block so not blocking public acls",
        "Query": "data..",
        "Resolution": "Enable blocking any PUT calls with a public ACL specified",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0086"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 25,
          "EndLine": 33,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_embeddings\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_embeddings\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  bucket = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    Name        = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "    Purpose     = \"Processed embeddings storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Processed embeddings storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access block should block public ACL",
      "description": "\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
      "file": "module.storage",
      "line": 15,
      "rule_id": "AVD-AWS-0086",
      "remediation": "Enable blocking any PUT calls with a public ACL specified",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0086"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0086",
        "AVDID": "AVD-AWS-0086",
        "Title": "S3 Access block should block public ACL",
        "Description": "\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
        "Message": "No public access block so not blocking public acls",
        "Query": "data..",
        "Resolution": "Enable blocking any PUT calls with a public ACL specified",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0086"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 15,
          "EndLine": 23,
          "Code": {
            "Lines": [
              {
                "Number": 15,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_raw\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_raw\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "  bucket = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 17,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 18,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "    Name        = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "    Purpose     = \"Raw document storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Raw document storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access block should block public policy",
      "description": "\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
      "file": "module.storage",
      "line": 35,
      "rule_id": "AVD-AWS-0087",
      "remediation": "Prevent policies that allow public access being PUT",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0087"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0087",
        "AVDID": "AVD-AWS-0087",
        "Title": "S3 Access block should block public policy",
        "Description": "\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
        "Message": "No public access block so not blocking public policies",
        "Query": "data..",
        "Resolution": "Prevent policies that allow public access being PUT",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0087"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 35,
          "EndLine": 43,
          "Code": {
            "Lines": [
              {
                "Number": 35,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_config\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_config\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  bucket = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "    Name        = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "    Purpose     = \"Configuration and secrets\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Configuration and secrets\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access block should block public policy",
      "description": "\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
      "file": "module.storage",
      "line": 15,
      "rule_id": "AVD-AWS-0087",
      "remediation": "Prevent policies that allow public access being PUT",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0087"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0087",
        "AVDID": "AVD-AWS-0087",
        "Title": "S3 Access block should block public policy",
        "Description": "\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
        "Message": "No public access block so not blocking public policies",
        "Query": "data..",
        "Resolution": "Prevent policies that allow public access being PUT",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0087"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 15,
          "EndLine": 23,
          "Code": {
            "Lines": [
              {
                "Number": 15,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_raw\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_raw\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "  bucket = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 17,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 18,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "    Name        = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "    Purpose     = \"Raw document storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Raw document storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access block should block public policy",
      "description": "\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
      "file": "module.storage",
      "line": 25,
      "rule_id": "AVD-AWS-0087",
      "remediation": "Prevent policies that allow public access being PUT",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0087"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0087",
        "AVDID": "AVD-AWS-0087",
        "Title": "S3 Access block should block public policy",
        "Description": "\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
        "Message": "No public access block so not blocking public policies",
        "Query": "data..",
        "Resolution": "Prevent policies that allow public access being PUT",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0087"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 25,
          "EndLine": 33,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_embeddings\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_embeddings\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  bucket = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    Name        = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "    Purpose     = \"Processed embeddings storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Processed embeddings storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access block should block public policy",
      "description": "\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
      "file": "module.storage",
      "line": 15,
      "rule_id": "AVD-AWS-0087",
      "remediation": "Prevent policies that allow public access being PUT",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0087"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0087",
        "AVDID": "AVD-AWS-0087",
        "Title": "S3 Access block should block public policy",
        "Description": "\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
        "Message": "No public access block so not blocking public policies",
        "Query": "data..",
        "Resolution": "Prevent policies that allow public access being PUT",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0087"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 15,
          "EndLine": 23,
          "Code": {
            "Lines": [
              {
                "Number": 15,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_raw\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_raw\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "  bucket = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 17,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 18,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "    Name        = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "    Purpose     = \"Raw document storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Raw document storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access block should block public policy",
      "description": "\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
      "file": "module.storage",
      "line": 25,
      "rule_id": "AVD-AWS-0087",
      "remediation": "Prevent policies that allow public access being PUT",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0087"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0087",
        "AVDID": "AVD-AWS-0087",
        "Title": "S3 Access block should block public policy",
        "Description": "\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
        "Message": "No public access block so not blocking public policies",
        "Query": "data..",
        "Resolution": "Prevent policies that allow public access being PUT",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0087"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 25,
          "EndLine": 33,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_embeddings\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_embeddings\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  bucket = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    Name        = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "    Purpose     = \"Processed embeddings storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Processed embeddings storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access block should block public policy",
      "description": "\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
      "file": "module.storage",
      "line": 35,
      "rule_id": "AVD-AWS-0087",
      "remediation": "Prevent policies that allow public access being PUT",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0087"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0087",
        "AVDID": "AVD-AWS-0087",
        "Title": "S3 Access block should block public policy",
        "Description": "\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
        "Message": "No public access block so not blocking public policies",
        "Query": "data..",
        "Resolution": "Prevent policies that allow public access being PUT",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0087"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 35,
          "EndLine": 43,
          "Code": {
            "Lines": [
              {
                "Number": 35,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_config\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_config\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  bucket = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "    Name        = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "    Purpose     = \"Configuration and secrets\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Configuration and secrets\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Unencrypted S3 bucket.",
      "description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.",
      "file": "module.storage",
      "line": 35,
      "rule_id": "AVD-AWS-0088",
      "remediation": "Configure bucket encryption",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0088"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0088",
        "AVDID": "AVD-AWS-0088",
        "Title": "Unencrypted S3 bucket.",
        "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.",
        "Message": "Bucket does not have encryption enabled",
        "Query": "data..",
        "Resolution": "Configure bucket encryption",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0088"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 35,
          "EndLine": 43,
          "Code": {
            "Lines": [
              {
                "Number": 35,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_config\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_config\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  bucket = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "    Name        = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "    Purpose     = \"Configuration and secrets\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Configuration and secrets\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Unencrypted S3 bucket.",
      "description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.",
      "file": "module.storage",
      "line": 25,
      "rule_id": "AVD-AWS-0088",
      "remediation": "Configure bucket encryption",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0088"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0088",
        "AVDID": "AVD-AWS-0088",
        "Title": "Unencrypted S3 bucket.",
        "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.",
        "Message": "Bucket does not have encryption enabled",
        "Query": "data..",
        "Resolution": "Configure bucket encryption",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0088"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 25,
          "EndLine": 33,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_embeddings\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_embeddings\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  bucket = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    Name        = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "    Purpose     = \"Processed embeddings storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Processed embeddings storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Unencrypted S3 bucket.",
      "description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.",
      "file": "module.storage",
      "line": 15,
      "rule_id": "AVD-AWS-0088",
      "remediation": "Configure bucket encryption",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0088"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0088",
        "AVDID": "AVD-AWS-0088",
        "Title": "Unencrypted S3 bucket.",
        "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.",
        "Message": "Bucket does not have encryption enabled",
        "Query": "data..",
        "Resolution": "Configure bucket encryption",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0088"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 15,
          "EndLine": 23,
          "Code": {
            "Lines": [
              {
                "Number": 15,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_raw\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_raw\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "  bucket = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 17,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 18,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "    Name        = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "    Purpose     = \"Raw document storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Raw document storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Unencrypted S3 bucket.",
      "description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.",
      "file": "module.storage",
      "line": 15,
      "rule_id": "AVD-AWS-0088",
      "remediation": "Configure bucket encryption",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0088"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0088",
        "AVDID": "AVD-AWS-0088",
        "Title": "Unencrypted S3 bucket.",
        "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.",
        "Message": "Bucket does not have encryption enabled",
        "Query": "data..",
        "Resolution": "Configure bucket encryption",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0088"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 15,
          "EndLine": 23,
          "Code": {
            "Lines": [
              {
                "Number": 15,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_raw\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_raw\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "  bucket = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 17,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 18,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "    Name        = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "    Purpose     = \"Raw document storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Raw document storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Unencrypted S3 bucket.",
      "description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.",
      "file": "module.storage",
      "line": 25,
      "rule_id": "AVD-AWS-0088",
      "remediation": "Configure bucket encryption",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0088"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0088",
        "AVDID": "AVD-AWS-0088",
        "Title": "Unencrypted S3 bucket.",
        "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.",
        "Message": "Bucket does not have encryption enabled",
        "Query": "data..",
        "Resolution": "Configure bucket encryption",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0088"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 25,
          "EndLine": 33,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_embeddings\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_embeddings\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  bucket = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    Name        = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "    Purpose     = \"Processed embeddings storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Processed embeddings storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Unencrypted S3 bucket.",
      "description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.",
      "file": "module.storage",
      "line": 35,
      "rule_id": "AVD-AWS-0088",
      "remediation": "Configure bucket encryption",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0088"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0088",
        "AVDID": "AVD-AWS-0088",
        "Title": "Unencrypted S3 bucket.",
        "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.",
        "Message": "Bucket does not have encryption enabled",
        "Query": "data..",
        "Resolution": "Configure bucket encryption",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0088"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 35,
          "EndLine": 43,
          "Code": {
            "Lines": [
              {
                "Number": 35,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_config\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_config\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  bucket = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "    Name        = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "    Purpose     = \"Configuration and secrets\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Configuration and secrets\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "S3 Bucket Logging",
      "description": "Ensures S3 bucket logging is enabled for S3 buckets",
      "file": "module.storage",
      "line": 25,
      "rule_id": "AVD-AWS-0089",
      "remediation": "Add a logging block to the resource to enable access logging",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0089"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0089",
        "AVDID": "AVD-AWS-0089",
        "Title": "S3 Bucket Logging",
        "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
        "Message": "Bucket has logging disabled",
        "Namespace": "builtin.aws.s3.aws0089",
        "Query": "data.builtin.aws.s3.aws0089.deny",
        "Resolution": "Add a logging block to the resource to enable access logging",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0089",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0089"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 25,
          "EndLine": 33,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_embeddings\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_embeddings\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  bucket = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    Name        = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "    Purpose     = \"Processed embeddings storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Processed embeddings storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "S3 Bucket Logging",
      "description": "Ensures S3 bucket logging is enabled for S3 buckets",
      "file": "module.storage",
      "line": 15,
      "rule_id": "AVD-AWS-0089",
      "remediation": "Add a logging block to the resource to enable access logging",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0089"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0089",
        "AVDID": "AVD-AWS-0089",
        "Title": "S3 Bucket Logging",
        "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
        "Message": "Bucket has logging disabled",
        "Namespace": "builtin.aws.s3.aws0089",
        "Query": "data.builtin.aws.s3.aws0089.deny",
        "Resolution": "Add a logging block to the resource to enable access logging",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0089",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0089"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 15,
          "EndLine": 23,
          "Code": {
            "Lines": [
              {
                "Number": 15,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_raw\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_raw\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "  bucket = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 17,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 18,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "    Name        = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "    Purpose     = \"Raw document storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Raw document storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "S3 Bucket Logging",
      "description": "Ensures S3 bucket logging is enabled for S3 buckets",
      "file": "module.storage",
      "line": 35,
      "rule_id": "AVD-AWS-0089",
      "remediation": "Add a logging block to the resource to enable access logging",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0089"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0089",
        "AVDID": "AVD-AWS-0089",
        "Title": "S3 Bucket Logging",
        "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
        "Message": "Bucket has logging disabled",
        "Namespace": "builtin.aws.s3.aws0089",
        "Query": "data.builtin.aws.s3.aws0089.deny",
        "Resolution": "Add a logging block to the resource to enable access logging",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0089",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0089"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 35,
          "EndLine": 43,
          "Code": {
            "Lines": [
              {
                "Number": 35,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_config\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_config\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  bucket = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "    Name        = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "    Purpose     = \"Configuration and secrets\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Configuration and secrets\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "S3 Bucket Logging",
      "description": "Ensures S3 bucket logging is enabled for S3 buckets",
      "file": "module.storage",
      "line": 35,
      "rule_id": "AVD-AWS-0089",
      "remediation": "Add a logging block to the resource to enable access logging",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0089"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0089",
        "AVDID": "AVD-AWS-0089",
        "Title": "S3 Bucket Logging",
        "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
        "Message": "Bucket has logging disabled",
        "Namespace": "builtin.aws.s3.aws0089",
        "Query": "data.builtin.aws.s3.aws0089.deny",
        "Resolution": "Add a logging block to the resource to enable access logging",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0089",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0089"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 35,
          "EndLine": 43,
          "Code": {
            "Lines": [
              {
                "Number": 35,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_config\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_config\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  bucket = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "    Name        = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "    Purpose     = \"Configuration and secrets\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Configuration and secrets\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "S3 Bucket Logging",
      "description": "Ensures S3 bucket logging is enabled for S3 buckets",
      "file": "module.storage",
      "line": 25,
      "rule_id": "AVD-AWS-0089",
      "remediation": "Add a logging block to the resource to enable access logging",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0089"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0089",
        "AVDID": "AVD-AWS-0089",
        "Title": "S3 Bucket Logging",
        "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
        "Message": "Bucket has logging disabled",
        "Namespace": "builtin.aws.s3.aws0089",
        "Query": "data.builtin.aws.s3.aws0089.deny",
        "Resolution": "Add a logging block to the resource to enable access logging",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0089",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0089"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 25,
          "EndLine": 33,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_embeddings\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_embeddings\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  bucket = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    Name        = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "    Purpose     = \"Processed embeddings storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Processed embeddings storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "S3 Bucket Logging",
      "description": "Ensures S3 bucket logging is enabled for S3 buckets",
      "file": "module.storage",
      "line": 15,
      "rule_id": "AVD-AWS-0089",
      "remediation": "Add a logging block to the resource to enable access logging",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0089"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0089",
        "AVDID": "AVD-AWS-0089",
        "Title": "S3 Bucket Logging",
        "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
        "Message": "Bucket has logging disabled",
        "Namespace": "builtin.aws.s3.aws0089",
        "Query": "data.builtin.aws.s3.aws0089.deny",
        "Resolution": "Add a logging block to the resource to enable access logging",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0089",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0089"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 15,
          "EndLine": 23,
          "Code": {
            "Lines": [
              {
                "Number": 15,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_raw\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_raw\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "  bucket = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 17,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 18,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "    Name        = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "    Purpose     = \"Raw document storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Raw document storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "S3 Data should be versioned",
      "description": "\nVersioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket. \nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. \nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
      "file": "module.storage",
      "line": 25,
      "rule_id": "AVD-AWS-0090",
      "remediation": "Enable versioning to protect against accidental/malicious removal or modification",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0090"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0090",
        "AVDID": "AVD-AWS-0090",
        "Title": "S3 Data should be versioned",
        "Description": "\nVersioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket. \nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. \nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
        "Message": "Bucket does not have versioning enabled",
        "Query": "data..",
        "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0090"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 25,
          "EndLine": 33,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_embeddings\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_embeddings\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  bucket = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    Name        = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "    Purpose     = \"Processed embeddings storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Processed embeddings storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "S3 Data should be versioned",
      "description": "\nVersioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket. \nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. \nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
      "file": "module.storage",
      "line": 25,
      "rule_id": "AVD-AWS-0090",
      "remediation": "Enable versioning to protect against accidental/malicious removal or modification",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0090"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0090",
        "AVDID": "AVD-AWS-0090",
        "Title": "S3 Data should be versioned",
        "Description": "\nVersioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket. \nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. \nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
        "Message": "Bucket does not have versioning enabled",
        "Query": "data..",
        "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0090"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 25,
          "EndLine": 33,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_embeddings\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_embeddings\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  bucket = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    Name        = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "    Purpose     = \"Processed embeddings storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Processed embeddings storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "S3 Data should be versioned",
      "description": "\nVersioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket. \nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. \nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
      "file": "module.storage",
      "line": 35,
      "rule_id": "AVD-AWS-0090",
      "remediation": "Enable versioning to protect against accidental/malicious removal or modification",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0090"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0090",
        "AVDID": "AVD-AWS-0090",
        "Title": "S3 Data should be versioned",
        "Description": "\nVersioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket. \nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. \nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
        "Message": "Bucket does not have versioning enabled",
        "Query": "data..",
        "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0090"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 35,
          "EndLine": 43,
          "Code": {
            "Lines": [
              {
                "Number": 35,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_config\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_config\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  bucket = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "    Name        = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "    Purpose     = \"Configuration and secrets\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Configuration and secrets\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "S3 Data should be versioned",
      "description": "\nVersioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket. \nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. \nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
      "file": "module.storage",
      "line": 35,
      "rule_id": "AVD-AWS-0090",
      "remediation": "Enable versioning to protect against accidental/malicious removal or modification",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0090"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0090",
        "AVDID": "AVD-AWS-0090",
        "Title": "S3 Data should be versioned",
        "Description": "\nVersioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket. \nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. \nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
        "Message": "Bucket does not have versioning enabled",
        "Query": "data..",
        "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0090"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 35,
          "EndLine": 43,
          "Code": {
            "Lines": [
              {
                "Number": 35,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_config\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_config\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  bucket = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "    Name        = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "    Purpose     = \"Configuration and secrets\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Configuration and secrets\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access Block should Ignore Public Acl",
      "description": "\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
      "file": "module.storage",
      "line": 15,
      "rule_id": "AVD-AWS-0091",
      "remediation": "Enable ignoring the application of public ACLs in PUT calls",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0091"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0091",
        "AVDID": "AVD-AWS-0091",
        "Title": "S3 Access Block should Ignore Public Acl",
        "Description": "\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
        "Message": "No public access block so not ignoring public acls",
        "Query": "data..",
        "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0091"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 15,
          "EndLine": 23,
          "Code": {
            "Lines": [
              {
                "Number": 15,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_raw\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_raw\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "  bucket = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 17,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 18,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "    Name        = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "    Purpose     = \"Raw document storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Raw document storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access Block should Ignore Public Acl",
      "description": "\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
      "file": "module.storage",
      "line": 35,
      "rule_id": "AVD-AWS-0091",
      "remediation": "Enable ignoring the application of public ACLs in PUT calls",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0091"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0091",
        "AVDID": "AVD-AWS-0091",
        "Title": "S3 Access Block should Ignore Public Acl",
        "Description": "\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
        "Message": "No public access block so not ignoring public acls",
        "Query": "data..",
        "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0091"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 35,
          "EndLine": 43,
          "Code": {
            "Lines": [
              {
                "Number": 35,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_config\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_config\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  bucket = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "    Name        = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "    Purpose     = \"Configuration and secrets\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Configuration and secrets\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access Block should Ignore Public Acl",
      "description": "\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
      "file": "module.storage",
      "line": 35,
      "rule_id": "AVD-AWS-0091",
      "remediation": "Enable ignoring the application of public ACLs in PUT calls",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0091"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0091",
        "AVDID": "AVD-AWS-0091",
        "Title": "S3 Access Block should Ignore Public Acl",
        "Description": "\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
        "Message": "No public access block so not ignoring public acls",
        "Query": "data..",
        "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0091"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 35,
          "EndLine": 43,
          "Code": {
            "Lines": [
              {
                "Number": 35,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_config\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_config\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  bucket = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "    Name        = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "    Purpose     = \"Configuration and secrets\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Configuration and secrets\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access Block should Ignore Public Acl",
      "description": "\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
      "file": "module.storage",
      "line": 25,
      "rule_id": "AVD-AWS-0091",
      "remediation": "Enable ignoring the application of public ACLs in PUT calls",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0091"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0091",
        "AVDID": "AVD-AWS-0091",
        "Title": "S3 Access Block should Ignore Public Acl",
        "Description": "\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
        "Message": "No public access block so not ignoring public acls",
        "Query": "data..",
        "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0091"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 25,
          "EndLine": 33,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_embeddings\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_embeddings\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  bucket = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    Name        = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "    Purpose     = \"Processed embeddings storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Processed embeddings storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access Block should Ignore Public Acl",
      "description": "\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
      "file": "module.storage",
      "line": 15,
      "rule_id": "AVD-AWS-0091",
      "remediation": "Enable ignoring the application of public ACLs in PUT calls",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0091"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0091",
        "AVDID": "AVD-AWS-0091",
        "Title": "S3 Access Block should Ignore Public Acl",
        "Description": "\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
        "Message": "No public access block so not ignoring public acls",
        "Query": "data..",
        "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0091"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 15,
          "EndLine": 23,
          "Code": {
            "Lines": [
              {
                "Number": 15,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_raw\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_raw\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "  bucket = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 17,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 18,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "    Name        = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "    Purpose     = \"Raw document storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Raw document storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access Block should Ignore Public Acl",
      "description": "\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
      "file": "module.storage",
      "line": 25,
      "rule_id": "AVD-AWS-0091",
      "remediation": "Enable ignoring the application of public ACLs in PUT calls",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0091"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0091",
        "AVDID": "AVD-AWS-0091",
        "Title": "S3 Access Block should Ignore Public Acl",
        "Description": "\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
        "Message": "No public access block so not ignoring public acls",
        "Query": "data..",
        "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0091"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 25,
          "EndLine": 33,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_embeddings\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_embeddings\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  bucket = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    Name        = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "    Purpose     = \"Processed embeddings storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Processed embeddings storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access block should restrict public bucket to limit access",
      "description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.",
      "file": "module.storage",
      "line": 25,
      "rule_id": "AVD-AWS-0093",
      "remediation": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0093"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0093",
        "AVDID": "AVD-AWS-0093",
        "Title": "S3 Access block should restrict public bucket to limit access",
        "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.",
        "Message": "No public access block so not restricting public buckets",
        "Query": "data..",
        "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0093"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 25,
          "EndLine": 33,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_embeddings\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_embeddings\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  bucket = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    Name        = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "    Purpose     = \"Processed embeddings storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Processed embeddings storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access block should restrict public bucket to limit access",
      "description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.",
      "file": "module.storage",
      "line": 25,
      "rule_id": "AVD-AWS-0093",
      "remediation": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0093"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0093",
        "AVDID": "AVD-AWS-0093",
        "Title": "S3 Access block should restrict public bucket to limit access",
        "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.",
        "Message": "No public access block so not restricting public buckets",
        "Query": "data..",
        "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0093"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 25,
          "EndLine": 33,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_embeddings\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_embeddings\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  bucket = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    Name        = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "    Purpose     = \"Processed embeddings storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Processed embeddings storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access block should restrict public bucket to limit access",
      "description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.",
      "file": "module.storage",
      "line": 15,
      "rule_id": "AVD-AWS-0093",
      "remediation": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0093"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0093",
        "AVDID": "AVD-AWS-0093",
        "Title": "S3 Access block should restrict public bucket to limit access",
        "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.",
        "Message": "No public access block so not restricting public buckets",
        "Query": "data..",
        "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0093"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 15,
          "EndLine": 23,
          "Code": {
            "Lines": [
              {
                "Number": 15,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_raw\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_raw\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "  bucket = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 17,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 18,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "    Name        = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "    Purpose     = \"Raw document storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Raw document storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access block should restrict public bucket to limit access",
      "description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.",
      "file": "module.storage",
      "line": 15,
      "rule_id": "AVD-AWS-0093",
      "remediation": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0093"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0093",
        "AVDID": "AVD-AWS-0093",
        "Title": "S3 Access block should restrict public bucket to limit access",
        "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.",
        "Message": "No public access block so not restricting public buckets",
        "Query": "data..",
        "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0093"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 15,
          "EndLine": 23,
          "Code": {
            "Lines": [
              {
                "Number": 15,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_raw\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_raw\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "  bucket = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 17,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 18,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "    Name        = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "    Purpose     = \"Raw document storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Raw document storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access block should restrict public bucket to limit access",
      "description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.",
      "file": "module.storage",
      "line": 35,
      "rule_id": "AVD-AWS-0093",
      "remediation": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0093"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0093",
        "AVDID": "AVD-AWS-0093",
        "Title": "S3 Access block should restrict public bucket to limit access",
        "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.",
        "Message": "No public access block so not restricting public buckets",
        "Query": "data..",
        "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0093"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 35,
          "EndLine": 43,
          "Code": {
            "Lines": [
              {
                "Number": 35,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_config\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_config\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  bucket = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "    Name        = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "    Purpose     = \"Configuration and secrets\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Configuration and secrets\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 Access block should restrict public bucket to limit access",
      "description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.",
      "file": "module.storage",
      "line": 35,
      "rule_id": "AVD-AWS-0093",
      "remediation": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0093"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0093",
        "AVDID": "AVD-AWS-0093",
        "Title": "S3 Access block should restrict public bucket to limit access",
        "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.",
        "Message": "No public access block so not restricting public buckets",
        "Query": "data..",
        "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0093"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 35,
          "EndLine": 43,
          "Code": {
            "Lines": [
              {
                "Number": 35,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_config\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_config\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  bucket = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "    Name        = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "    Purpose     = \"Configuration and secrets\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Configuration and secrets\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
      "description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.",
      "file": "module.storage",
      "line": 15,
      "rule_id": "AVD-AWS-0094",
      "remediation": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0094"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0094",
        "AVDID": "AVD-AWS-0094",
        "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
        "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.",
        "Message": "Bucket does not have a corresponding public access block.",
        "Query": "data..",
        "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0094"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 15,
          "EndLine": 23,
          "Code": {
            "Lines": [
              {
                "Number": 15,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_raw\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_raw\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "  bucket = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 17,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 18,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "    Name        = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "    Purpose     = \"Raw document storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Raw document storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
      "description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.",
      "file": "module.storage",
      "line": 35,
      "rule_id": "AVD-AWS-0094",
      "remediation": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0094"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0094",
        "AVDID": "AVD-AWS-0094",
        "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
        "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.",
        "Message": "Bucket does not have a corresponding public access block.",
        "Query": "data..",
        "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0094"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 35,
          "EndLine": 43,
          "Code": {
            "Lines": [
              {
                "Number": 35,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_config\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_config\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  bucket = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "    Name        = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "    Purpose     = \"Configuration and secrets\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Configuration and secrets\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
      "description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.",
      "file": "module.storage",
      "line": 25,
      "rule_id": "AVD-AWS-0094",
      "remediation": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0094"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0094",
        "AVDID": "AVD-AWS-0094",
        "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
        "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.",
        "Message": "Bucket does not have a corresponding public access block.",
        "Query": "data..",
        "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0094"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 25,
          "EndLine": 33,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_embeddings\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_embeddings\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  bucket = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    Name        = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "    Purpose     = \"Processed embeddings storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Processed embeddings storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
      "description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.",
      "file": "module.storage",
      "line": 25,
      "rule_id": "AVD-AWS-0094",
      "remediation": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0094"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0094",
        "AVDID": "AVD-AWS-0094",
        "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
        "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.",
        "Message": "Bucket does not have a corresponding public access block.",
        "Query": "data..",
        "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0094"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 25,
          "EndLine": 33,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_embeddings\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_embeddings\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  bucket = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    Name        = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "    Purpose     = \"Processed embeddings storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Processed embeddings storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
      "description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.",
      "file": "module.storage",
      "line": 35,
      "rule_id": "AVD-AWS-0094",
      "remediation": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0094"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0094",
        "AVDID": "AVD-AWS-0094",
        "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
        "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.",
        "Message": "Bucket does not have a corresponding public access block.",
        "Query": "data..",
        "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0094"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 35,
          "EndLine": 43,
          "Code": {
            "Lines": [
              {
                "Number": 35,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_config\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_config\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  bucket = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "    Name        = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "    Purpose     = \"Configuration and secrets\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Configuration and secrets\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
      "description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.",
      "file": "module.storage",
      "line": 15,
      "rule_id": "AVD-AWS-0094",
      "remediation": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0094"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0094",
        "AVDID": "AVD-AWS-0094",
        "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
        "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.",
        "Message": "Bucket does not have a corresponding public access block.",
        "Query": "data..",
        "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0094"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 15,
          "EndLine": 23,
          "Code": {
            "Lines": [
              {
                "Number": 15,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_raw\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_raw\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "  bucket = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 17,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 18,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "    Name        = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "    Purpose     = \"Raw document storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Raw document storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Unencrypted SQS queue.",
      "description": "Queues should be encrypted to protect queue contents.",
      "file": "module.storage",
      "line": 194,
      "rule_id": "AVD-AWS-0096",
      "remediation": "Turn on SQS Queue encryption",
      "references": [
        "https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0096"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0096",
        "AVDID": "AVD-AWS-0096",
        "Title": "Unencrypted SQS queue.",
        "Description": "Queues should be encrypted to protect queue contents.",
        "Message": "Queue is not encrypted",
        "Query": "data..",
        "Resolution": "Turn on SQS Queue encryption",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0096",
        "References": [
          "https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0096"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "sqs",
          "StartLine": 194,
          "EndLine": 204,
          "Code": {
            "Lines": [
              {
                "Number": 194,
                "Content": "resource \"aws_sqs_queue\" \"ingestion_queue\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_sqs_queue\"\u001b[0m \u001b[38;5;37m\"ingestion_queue\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 195,
                "Content": "  name                       = \"${var.project_name}-ingestion-queue\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m                       = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-ingestion-queue\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 196,
                "Content": "  visibility_timeout_seconds = 300",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mvisibility_timeout_seconds\u001b[0m = \u001b[38;5;37m300",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 197,
                "Content": "  message_retention_seconds  = 86400",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mmessage_retention_seconds\u001b[0m  = \u001b[38;5;37m86400",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 198,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 199,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 200,
                "Content": "    Name        = \"${var.project_name}-ingestion-queue\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-ingestion-queue\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 201,
                "Content": "    Purpose     = \"Document ingestion queue\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Document ingestion queue\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 202,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 203,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Unencrypted SQS queue.",
      "description": "Queues should be encrypted to protect queue contents.",
      "file": "module.storage",
      "line": 220,
      "rule_id": "AVD-AWS-0096",
      "remediation": "Turn on SQS Queue encryption",
      "references": [
        "https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0096"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0096",
        "AVDID": "AVD-AWS-0096",
        "Title": "Unencrypted SQS queue.",
        "Description": "Queues should be encrypted to protect queue contents.",
        "Message": "Queue is not encrypted",
        "Query": "data..",
        "Resolution": "Turn on SQS Queue encryption",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0096",
        "References": [
          "https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0096"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "sqs",
          "StartLine": 220,
          "EndLine": 229,
          "Code": {
            "Lines": [
              {
                "Number": 220,
                "Content": "resource \"aws_sqs_queue\" \"ingestion_dlq\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_sqs_queue\"\u001b[0m \u001b[38;5;37m\"ingestion_dlq\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 221,
                "Content": "  name                      = \"${var.project_name}-ingestion-dlq\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m                      = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-ingestion-dlq\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 222,
                "Content": "  message_retention_seconds = 1209600  # 14 days",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mmessage_retention_seconds\u001b[0m = \u001b[38;5;37m1209600\u001b[0m\u001b[38;5;239m  # 14 days",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 223,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 224,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 225,
                "Content": "    Name        = \"${var.project_name}-ingestion-dlq\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-ingestion-dlq\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 226,
                "Content": "    Purpose     = \"Dead letter queue for failed messages\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Dead letter queue for failed messages\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 227,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 228,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 229,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Unencrypted SQS queue.",
      "description": "Queues should be encrypted to protect queue contents.",
      "file": "module.storage",
      "line": 207,
      "rule_id": "AVD-AWS-0096",
      "remediation": "Turn on SQS Queue encryption",
      "references": [
        "https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0096"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0096",
        "AVDID": "AVD-AWS-0096",
        "Title": "Unencrypted SQS queue.",
        "Description": "Queues should be encrypted to protect queue contents.",
        "Message": "Queue is not encrypted",
        "Query": "data..",
        "Resolution": "Turn on SQS Queue encryption",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0096",
        "References": [
          "https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0096"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "sqs",
          "StartLine": 207,
          "EndLine": 217,
          "Code": {
            "Lines": [
              {
                "Number": 207,
                "Content": "resource \"aws_sqs_queue\" \"embedding_queue\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_sqs_queue\"\u001b[0m \u001b[38;5;37m\"embedding_queue\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 208,
                "Content": "  name                       = \"${var.project_name}-embedding-queue\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m                       = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embedding-queue\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 209,
                "Content": "  visibility_timeout_seconds = 300",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mvisibility_timeout_seconds\u001b[0m = \u001b[38;5;37m300",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 210,
                "Content": "  message_retention_seconds  = 86400",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mmessage_retention_seconds\u001b[0m  = \u001b[38;5;37m86400",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 211,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 212,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 213,
                "Content": "    Name        = \"${var.project_name}-embedding-queue\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embedding-queue\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 214,
                "Content": "    Purpose     = \"Embedding generation queue\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Embedding generation queue\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 215,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 216,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Unencrypted SQS queue.",
      "description": "Queues should be encrypted to protect queue contents.",
      "file": "module.storage",
      "line": 220,
      "rule_id": "AVD-AWS-0096",
      "remediation": "Turn on SQS Queue encryption",
      "references": [
        "https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0096"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0096",
        "AVDID": "AVD-AWS-0096",
        "Title": "Unencrypted SQS queue.",
        "Description": "Queues should be encrypted to protect queue contents.",
        "Message": "Queue is not encrypted",
        "Query": "data..",
        "Resolution": "Turn on SQS Queue encryption",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0096",
        "References": [
          "https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0096"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "sqs",
          "StartLine": 220,
          "EndLine": 229,
          "Code": {
            "Lines": [
              {
                "Number": 220,
                "Content": "resource \"aws_sqs_queue\" \"ingestion_dlq\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_sqs_queue\"\u001b[0m \u001b[38;5;37m\"ingestion_dlq\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 221,
                "Content": "  name                      = \"${var.project_name}-ingestion-dlq\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m                      = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-ingestion-dlq\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 222,
                "Content": "  message_retention_seconds = 1209600  # 14 days",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mmessage_retention_seconds\u001b[0m = \u001b[38;5;37m1209600\u001b[0m\u001b[38;5;239m  # 14 days",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 223,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 224,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 225,
                "Content": "    Name        = \"${var.project_name}-ingestion-dlq\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-ingestion-dlq\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 226,
                "Content": "    Purpose     = \"Dead letter queue for failed messages\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Dead letter queue for failed messages\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 227,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 228,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 229,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Unencrypted SQS queue.",
      "description": "Queues should be encrypted to protect queue contents.",
      "file": "module.storage",
      "line": 207,
      "rule_id": "AVD-AWS-0096",
      "remediation": "Turn on SQS Queue encryption",
      "references": [
        "https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0096"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0096",
        "AVDID": "AVD-AWS-0096",
        "Title": "Unencrypted SQS queue.",
        "Description": "Queues should be encrypted to protect queue contents.",
        "Message": "Queue is not encrypted",
        "Query": "data..",
        "Resolution": "Turn on SQS Queue encryption",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0096",
        "References": [
          "https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0096"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "sqs",
          "StartLine": 207,
          "EndLine": 217,
          "Code": {
            "Lines": [
              {
                "Number": 207,
                "Content": "resource \"aws_sqs_queue\" \"embedding_queue\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_sqs_queue\"\u001b[0m \u001b[38;5;37m\"embedding_queue\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 208,
                "Content": "  name                       = \"${var.project_name}-embedding-queue\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m                       = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embedding-queue\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 209,
                "Content": "  visibility_timeout_seconds = 300",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mvisibility_timeout_seconds\u001b[0m = \u001b[38;5;37m300",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 210,
                "Content": "  message_retention_seconds  = 86400",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mmessage_retention_seconds\u001b[0m  = \u001b[38;5;37m86400",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 211,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 212,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 213,
                "Content": "    Name        = \"${var.project_name}-embedding-queue\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embedding-queue\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 214,
                "Content": "    Purpose     = \"Embedding generation queue\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Embedding generation queue\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 215,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 216,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Unencrypted SQS queue.",
      "description": "Queues should be encrypted to protect queue contents.",
      "file": "module.storage",
      "line": 194,
      "rule_id": "AVD-AWS-0096",
      "remediation": "Turn on SQS Queue encryption",
      "references": [
        "https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0096"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0096",
        "AVDID": "AVD-AWS-0096",
        "Title": "Unencrypted SQS queue.",
        "Description": "Queues should be encrypted to protect queue contents.",
        "Message": "Queue is not encrypted",
        "Query": "data..",
        "Resolution": "Turn on SQS Queue encryption",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0096",
        "References": [
          "https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0096"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "sqs",
          "StartLine": 194,
          "EndLine": 204,
          "Code": {
            "Lines": [
              {
                "Number": 194,
                "Content": "resource \"aws_sqs_queue\" \"ingestion_queue\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_sqs_queue\"\u001b[0m \u001b[38;5;37m\"ingestion_queue\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 195,
                "Content": "  name                       = \"${var.project_name}-ingestion-queue\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m                       = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-ingestion-queue\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 196,
                "Content": "  visibility_timeout_seconds = 300",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mvisibility_timeout_seconds\u001b[0m = \u001b[38;5;37m300",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 197,
                "Content": "  message_retention_seconds  = 86400",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mmessage_retention_seconds\u001b[0m  = \u001b[38;5;37m86400",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 198,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 199,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 200,
                "Content": "    Name        = \"${var.project_name}-ingestion-queue\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-ingestion-queue\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 201,
                "Content": "    Purpose     = \"Document ingestion queue\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Document ingestion queue\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 202,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 203,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 encryption should use Customer Managed Keys",
      "description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.",
      "file": "module.storage",
      "line": 15,
      "rule_id": "AVD-AWS-0132",
      "remediation": "Enable encryption using customer managed keys",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0132"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0132",
        "AVDID": "AVD-AWS-0132",
        "Title": "S3 encryption should use Customer Managed Keys",
        "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.",
        "Message": "Bucket does not encrypt data with a customer managed key.",
        "Query": "data..",
        "Resolution": "Enable encryption using customer managed keys",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0132"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 15,
          "EndLine": 23,
          "Code": {
            "Lines": [
              {
                "Number": 15,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_raw\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_raw\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "  bucket = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 17,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 18,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "    Name        = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "    Purpose     = \"Raw document storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Raw document storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 encryption should use Customer Managed Keys",
      "description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.",
      "file": "module.storage",
      "line": 15,
      "rule_id": "AVD-AWS-0132",
      "remediation": "Enable encryption using customer managed keys",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0132"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0132",
        "AVDID": "AVD-AWS-0132",
        "Title": "S3 encryption should use Customer Managed Keys",
        "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.",
        "Message": "Bucket does not encrypt data with a customer managed key.",
        "Query": "data..",
        "Resolution": "Enable encryption using customer managed keys",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0132"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 15,
          "EndLine": 23,
          "Code": {
            "Lines": [
              {
                "Number": 15,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_raw\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_raw\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "  bucket = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 17,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 18,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 19,
                "Content": "    Name        = \"${var.project_name}-raw\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-raw\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "    Purpose     = \"Raw document storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Raw document storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 encryption should use Customer Managed Keys",
      "description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.",
      "file": "module.storage",
      "line": 25,
      "rule_id": "AVD-AWS-0132",
      "remediation": "Enable encryption using customer managed keys",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0132"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0132",
        "AVDID": "AVD-AWS-0132",
        "Title": "S3 encryption should use Customer Managed Keys",
        "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.",
        "Message": "Bucket does not encrypt data with a customer managed key.",
        "Query": "data..",
        "Resolution": "Enable encryption using customer managed keys",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0132"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 25,
          "EndLine": 33,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_embeddings\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_embeddings\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  bucket = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    Name        = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "    Purpose     = \"Processed embeddings storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Processed embeddings storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 encryption should use Customer Managed Keys",
      "description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.",
      "file": "module.storage",
      "line": 35,
      "rule_id": "AVD-AWS-0132",
      "remediation": "Enable encryption using customer managed keys",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0132"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0132",
        "AVDID": "AVD-AWS-0132",
        "Title": "S3 encryption should use Customer Managed Keys",
        "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.",
        "Message": "Bucket does not encrypt data with a customer managed key.",
        "Query": "data..",
        "Resolution": "Enable encryption using customer managed keys",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0132"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 35,
          "EndLine": 43,
          "Code": {
            "Lines": [
              {
                "Number": 35,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_config\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_config\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  bucket = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "    Name        = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "    Purpose     = \"Configuration and secrets\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Configuration and secrets\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf",
              "Location": {
                "StartLine": 94,
                "EndLine": 99
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 encryption should use Customer Managed Keys",
      "description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.",
      "file": "module.storage",
      "line": 25,
      "rule_id": "AVD-AWS-0132",
      "remediation": "Enable encryption using customer managed keys",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0132"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0132",
        "AVDID": "AVD-AWS-0132",
        "Title": "S3 encryption should use Customer Managed Keys",
        "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.",
        "Message": "Bucket does not encrypt data with a customer managed key.",
        "Query": "data..",
        "Resolution": "Enable encryption using customer managed keys",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0132"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 25,
          "EndLine": 33,
          "Code": {
            "Lines": [
              {
                "Number": 25,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_embeddings\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_embeddings\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  bucket = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    Name        = \"${var.project_name}-embeddings\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-embeddings\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "    Purpose     = \"Processed embeddings storage\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Processed embeddings storage\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "S3 encryption should use Customer Managed Keys",
      "description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.",
      "file": "module.storage",
      "line": 35,
      "rule_id": "AVD-AWS-0132",
      "remediation": "Enable encryption using customer managed keys",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0132"
      ],
      "raw": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0132",
        "AVDID": "AVD-AWS-0132",
        "Title": "S3 encryption should use Customer Managed Keys",
        "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.",
        "Message": "Bucket does not encrypt data with a customer managed key.",
        "Query": "data..",
        "Resolution": "Enable encryption using customer managed keys",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0132"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "module.storage",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 35,
          "EndLine": 43,
          "Code": {
            "Lines": [
              {
                "Number": 35,
                "Content": "resource \"aws_s3_bucket\" \"portfolio_config\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"portfolio_config\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  bucket = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  tags = merge(var.tags, {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.tags, {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "    Name        = \"${var.project_name}-config\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "    Purpose     = \"Configuration and secrets\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"Configuration and secrets\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "    Environment = var.environment",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;33mvar\u001b[0m.environment",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "  })",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  })",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "module.storage",
              "Filename": "infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf",
              "Location": {
                "StartLine": 72,
                "EndLine": 84
              }
            }
          ]
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "CPU not limited",
      "description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
      "file": "infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/deployment-api.yaml",
      "line": 38,
      "rule_id": "KSV011",
      "remediation": "Set a limit value under 'containers[].resources.limits.cpu'.",
      "references": [
        "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
        "https://avd.aquasec.com/misconfig/ksv011"
      ],
      "raw": {
        "Type": "Helm Security Check",
        "ID": "KSV011",
        "AVDID": "AVD-KSV-0011",
        "Title": "CPU not limited",
        "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
        "Message": "Container 'fix-perms' of Deployment 'portfolio-api' should set 'resources.limits.cpu'",
        "Namespace": "builtin.kubernetes.KSV011",
        "Query": "data.builtin.kubernetes.KSV011.deny",
        "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
        "References": [
          "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
          "https://avd.aquasec.com/misconfig/ksv011"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 38,
          "EndLine": 64,
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "CPU requests not specified",
      "description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
      "file": "infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/deployment-api.yaml",
      "line": 38,
      "rule_id": "KSV015",
      "remediation": "Set 'containers[].resources.requests.cpu'.",
      "references": [
        "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
        "https://avd.aquasec.com/misconfig/ksv015"
      ],
      "raw": {
        "Type": "Helm Security Check",
        "ID": "KSV015",
        "AVDID": "AVD-KSV-0015",
        "Title": "CPU requests not specified",
        "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "Message": "Container 'fix-perms' of Deployment 'portfolio-api' should set 'resources.requests.cpu'",
        "Namespace": "builtin.kubernetes.KSV015",
        "Query": "data.builtin.kubernetes.KSV015.deny",
        "Resolution": "Set 'containers[].resources.requests.cpu'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
        "References": [
          "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
          "https://avd.aquasec.com/misconfig/ksv015"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 38,
          "EndLine": 64,
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Memory requests not specified",
      "description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
      "file": "infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/deployment-api.yaml",
      "line": 38,
      "rule_id": "KSV016",
      "remediation": "Set 'containers[].resources.requests.memory'.",
      "references": [
        "https://kubesec.io/basics/containers-resources-limits-memory/",
        "https://avd.aquasec.com/misconfig/ksv016"
      ],
      "raw": {
        "Type": "Helm Security Check",
        "ID": "KSV016",
        "AVDID": "AVD-KSV-0016",
        "Title": "Memory requests not specified",
        "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "Message": "Container 'fix-perms' of Deployment 'portfolio-api' should set 'resources.requests.memory'",
        "Namespace": "builtin.kubernetes.KSV016",
        "Query": "data.builtin.kubernetes.KSV016.deny",
        "Resolution": "Set 'containers[].resources.requests.memory'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
        "References": [
          "https://kubesec.io/basics/containers-resources-limits-memory/",
          "https://avd.aquasec.com/misconfig/ksv016"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 38,
          "EndLine": 64,
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Memory not limited",
      "description": "Enforcing memory limits prevents DoS via resource exhaustion.",
      "file": "infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/deployment-api.yaml",
      "line": 38,
      "rule_id": "KSV018",
      "remediation": "Set a limit value under 'containers[].resources.limits.memory'.",
      "references": [
        "https://kubesec.io/basics/containers-resources-limits-memory/",
        "https://avd.aquasec.com/misconfig/ksv018"
      ],
      "raw": {
        "Type": "Helm Security Check",
        "ID": "KSV018",
        "AVDID": "AVD-KSV-0018",
        "Title": "Memory not limited",
        "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
        "Message": "Container 'fix-perms' of Deployment 'portfolio-api' should set 'resources.limits.memory'",
        "Namespace": "builtin.kubernetes.KSV018",
        "Query": "data.builtin.kubernetes.KSV018.deny",
        "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
        "References": [
          "https://kubesec.io/basics/containers-resources-limits-memory/",
          "https://avd.aquasec.com/misconfig/ksv018"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 38,
          "EndLine": 64,
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Runs with UID <= 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "file": "infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/deployment-api.yaml",
      "line": 38,
      "rule_id": "KSV020",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "raw": {
        "Type": "Helm Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'fix-perms' of Deployment 'portfolio-api' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 38,
          "EndLine": 64,
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Runs with GID <= 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "file": "infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/deployment-api.yaml",
      "line": 38,
      "rule_id": "KSV021",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "raw": {
        "Type": "Helm Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'fix-perms' of Deployment 'portfolio-api' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 38,
          "EndLine": 64,
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "Specific capabilities added",
      "description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.",
      "file": "infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/deployment-api.yaml",
      "line": 38,
      "rule_id": "KSV022",
      "remediation": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv022"
      ],
      "raw": {
        "Type": "Helm Security Check",
        "ID": "KSV022",
        "AVDID": "AVD-KSV-0022",
        "Title": "Specific capabilities added",
        "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.",
        "Message": "Container 'fix-perms' of Deployment 'portfolio-api' should not set 'securityContext.capabilities.add'",
        "Namespace": "builtin.kubernetes.KSV022",
        "Query": "data.builtin.kubernetes.KSV022.deny",
        "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv022"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 38,
          "EndLine": 64,
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Containers must not set runAsUser to 0",
      "description": "Containers should be forbidden from running with a root UID.",
      "file": "infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/deployment-api.yaml",
      "line": 41,
      "rule_id": "KSV105",
      "remediation": "Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv105"
      ],
      "raw": {
        "Type": "Helm Security Check",
        "ID": "KSV105",
        "AVDID": "AVD-KSV-0105",
        "Title": "Containers must not set runAsUser to 0",
        "Description": "Containers should be forbidden from running with a root UID.",
        "Message": "securityContext.runAsUser should be set to a value greater than 0",
        "Namespace": "builtin.kubernetes.KSV105",
        "Query": "data.builtin.kubernetes.KSV105.deny",
        "Resolution": "Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv105",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv105"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 41,
          "EndLine": 54,
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "Container capabilities must only include NET_BIND_SERVICE",
      "description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
      "file": "infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/deployment-api.yaml",
      "line": 43,
      "rule_id": "KSV106",
      "remediation": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv106"
      ],
      "raw": {
        "Type": "Helm Security Check",
        "ID": "KSV106",
        "AVDID": "AVD-KSV-0106",
        "Title": "Container capabilities must only include NET_BIND_SERVICE",
        "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
        "Message": "container should not add stuff",
        "Namespace": "builtin.kubernetes.KSV106",
        "Query": "data.builtin.kubernetes.KSV106.deny",
        "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv106"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 43,
          "EndLine": 47,
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Root file system is not read-only",
      "description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
      "file": "infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/deployment-chroma.yaml",
      "line": 37,
      "rule_id": "KSV014",
      "remediation": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
        "https://avd.aquasec.com/misconfig/ksv014"
      ],
      "raw": {
        "Type": "Helm Security Check",
        "ID": "KSV014",
        "AVDID": "AVD-KSV-0014",
        "Title": "Root file system is not read-only",
        "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
        "Message": "Container 'chroma' of Deployment 'portfolio-chroma' should set 'securityContext.readOnlyRootFilesystem' to true",
        "Namespace": "builtin.kubernetes.KSV014",
        "Query": "data.builtin.kubernetes.KSV014.deny",
        "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
          "https://avd.aquasec.com/misconfig/ksv014"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 37,
          "EndLine": 87,
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "MEDIUM",
      "title": "Manage namespace secrets",
      "description": "Viewing secrets at the namespace scope can lead to escalation if another service account in that namespace has a higher privileged rolebinding or clusterrolebinding bound.",
      "file": "infrastructure/shared-security/kubernetes/rbac/roles.yaml",
      "line": 7,
      "rule_id": "KSV113",
      "remediation": "Manage namespace secrets are not allowed. Remove resource 'secrets' from role",
      "references": [
        "https://kubernetes.io/docs/concepts/security/rbac-good-practices/",
        "https://avd.aquasec.com/misconfig/ksv113"
      ],
      "raw": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV113",
        "AVDID": "AVD-KSV-0113",
        "Title": "Manage namespace secrets",
        "Description": "Viewing secrets at the namespace scope can lead to escalation if another service account in that namespace has a higher privileged rolebinding or clusterrolebinding bound.",
        "Message": "Role 'app-role' shouldn't have access to manage secrets in namespace 'default'",
        "Namespace": "builtin.kubernetes.KSV113",
        "Query": "data.builtin.kubernetes.KSV113.deny",
        "Resolution": "Manage namespace secrets are not allowed. Remove resource 'secrets' from role",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv113",
        "References": [
          "https://kubernetes.io/docs/concepts/security/rbac-good-practices/",
          "https://avd.aquasec.com/misconfig/ksv113"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 7,
          "EndLine": 14,
          "Code": {
            "Lines": [
              {
                "Number": 7,
                "Content": "- apiGroups:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "- \u001b[38;5;33mapiGroups\u001b[0m:",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 8,
                "Content": "  - ''",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  - \u001b[38;5;37m''",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 9,
                "Content": "  resources:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;33mresources\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 10,
                "Content": "  - configmaps",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  - configmaps",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 11,
                "Content": "  - secrets",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  - secrets",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 12,
                "Content": "  verbs:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;33mverbs\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 13,
                "Content": "  - get",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  - get",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 14,
                "Content": "  - list",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  - list",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "HIGH",
      "title": "Image user should not be 'root'",
      "description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
      "file": "ui/Dockerfile",
      "line": null,
      "rule_id": "DS002",
      "remediation": "Add 'USER <non root user name>' line to the Dockerfile",
      "references": [
        "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
        "https://avd.aquasec.com/misconfig/ds002"
      ],
      "raw": {
        "Type": "Dockerfile Security Check",
        "ID": "DS002",
        "AVDID": "AVD-DS-0002",
        "Title": "Image user should not be 'root'",
        "Description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
        "Message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
        "Namespace": "builtin.dockerfile.DS002",
        "Query": "data.builtin.dockerfile.DS002.deny",
        "Resolution": "Add 'USER <non root user name>' line to the Dockerfile",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ds002",
        "References": [
          "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
          "https://avd.aquasec.com/misconfig/ds002"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Dockerfile",
          "Service": "general",
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "LOW",
      "title": "No HEALTHCHECK defined",
      "description": "You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.",
      "file": "ui/Dockerfile",
      "line": null,
      "rule_id": "DS026",
      "remediation": "Add HEALTHCHECK instruction in Dockerfile",
      "references": [
        "https://blog.aquasec.com/docker-security-best-practices",
        "https://avd.aquasec.com/misconfig/ds026"
      ],
      "raw": {
        "Type": "Dockerfile Security Check",
        "ID": "DS026",
        "AVDID": "AVD-DS-0026",
        "Title": "No HEALTHCHECK defined",
        "Description": "You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.",
        "Message": "Add HEALTHCHECK instruction in your Dockerfile",
        "Namespace": "builtin.dockerfile.DS026",
        "Query": "data.builtin.dockerfile.DS026.deny",
        "Resolution": "Add HEALTHCHECK instruction in Dockerfile",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ds026",
        "References": [
          "https://blog.aquasec.com/docker-security-best-practices",
          "https://avd.aquasec.com/misconfig/ds026"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Dockerfile",
          "Service": "general",
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "scanner": "trivy",
      "severity": "CRITICAL",
      "title": "Secret Detected: GitHub Personal Access Token",
      "description": "        \"Match\": \"****************************************\",",
      "file": "GP-copilot/scan-results/gitleaksnpc.json",
      "line": 2005,
      "rule_id": "github-pat",
      "remediation": "Remove hardcoded secret and use secret management (e.g., Vault, AWS Secrets Manager)",
      "raw": {
        "RuleID": "github-pat",
        "Category": "GitHub",
        "Severity": "CRITICAL",
        "Title": "GitHub Personal Access Token",
        "StartLine": 2005,
        "EndLine": 2005,
        "Code": {
          "Lines": [
            {
              "Number": 2003,
              "Content": "        \"StartColumn\": 11,",
              "IsCause": false,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"StartColumn\": 11,",
              "FirstCause": false,
              "LastCause": false
            },
            {
              "Number": 2004,
              "Content": "        \"EndColumn\": 50,",
              "IsCause": false,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"EndColumn\": 50,",
              "FirstCause": false,
              "LastCause": false
            },
            {
              "Number": 2005,
              "Content": "        \"Match\": \"****************************************\",",
              "IsCause": true,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"Match\": \"****************************************\",",
              "FirstCause": true,
              "LastCause": true
            },
            {
              "Number": 2006,
              "Content": "        \"Secret\": \"****************************************\",",
              "IsCause": false,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"Secret\": \"****************************************\",",
              "FirstCause": false,
              "LastCause": false
            }
          ]
        },
        "Match": "        \"Match\": \"****************************************\",",
        "Layer": {}
      }
    },
    {
      "scanner": "trivy",
      "severity": "CRITICAL",
      "title": "Secret Detected: GitHub Personal Access Token",
      "description": "        \"Secret\": \"****************************************\",",
      "file": "GP-copilot/scan-results/gitleaksnpc.json",
      "line": 2006,
      "rule_id": "github-pat",
      "remediation": "Remove hardcoded secret and use secret management (e.g., Vault, AWS Secrets Manager)",
      "raw": {
        "RuleID": "github-pat",
        "Category": "GitHub",
        "Severity": "CRITICAL",
        "Title": "GitHub Personal Access Token",
        "StartLine": 2006,
        "EndLine": 2006,
        "Code": {
          "Lines": [
            {
              "Number": 2004,
              "Content": "        \"EndColumn\": 50,",
              "IsCause": false,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"EndColumn\": 50,",
              "FirstCause": false,
              "LastCause": false
            },
            {
              "Number": 2005,
              "Content": "        \"Match\": \"****************************************\",",
              "IsCause": false,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"Match\": \"****************************************\",",
              "FirstCause": false,
              "LastCause": false
            },
            {
              "Number": 2006,
              "Content": "        \"Secret\": \"****************************************\",",
              "IsCause": true,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"Secret\": \"****************************************\",",
              "FirstCause": true,
              "LastCause": true
            },
            {
              "Number": 2007,
              "Content": "        \"File\": \".env\",",
              "IsCause": false,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"File\": \".env\",",
              "FirstCause": false,
              "LastCause": false
            }
          ]
        },
        "Match": "        \"Secret\": \"****************************************\",",
        "Layer": {}
      }
    },
    {
      "scanner": "trivy",
      "severity": "CRITICAL",
      "title": "Secret Detected: GitHub Personal Access Token",
      "description": "        \"Match\": \"****************************************\",",
      "file": "GP-copilot/scan-results/gitleaksnpc.json",
      "line": 2365,
      "rule_id": "github-pat",
      "remediation": "Remove hardcoded secret and use secret management (e.g., Vault, AWS Secrets Manager)",
      "raw": {
        "RuleID": "github-pat",
        "Category": "GitHub",
        "Severity": "CRITICAL",
        "Title": "GitHub Personal Access Token",
        "StartLine": 2365,
        "EndLine": 2365,
        "Code": {
          "Lines": [
            {
              "Number": 2363,
              "Content": "        \"StartColumn\": 15,",
              "IsCause": false,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"StartColumn\": 15,",
              "FirstCause": false,
              "LastCause": false
            },
            {
              "Number": 2364,
              "Content": "        \"EndColumn\": 54,",
              "IsCause": false,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"EndColumn\": 54,",
              "FirstCause": false,
              "LastCause": false
            },
            {
              "Number": 2365,
              "Content": "        \"Match\": \"****************************************\",",
              "IsCause": true,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"Match\": \"****************************************\",",
              "FirstCause": true,
              "LastCause": true
            },
            {
              "Number": 2366,
              "Content": "        \"Secret\": \"****************************************\",",
              "IsCause": false,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"Secret\": \"****************************************\",",
              "FirstCause": false,
              "LastCause": false
            }
          ]
        },
        "Match": "        \"Match\": \"****************************************\",",
        "Layer": {}
      }
    },
    {
      "scanner": "trivy",
      "severity": "CRITICAL",
      "title": "Secret Detected: GitHub Personal Access Token",
      "description": "        \"Secret\": \"****************************************\",",
      "file": "GP-copilot/scan-results/gitleaksnpc.json",
      "line": 2366,
      "rule_id": "github-pat",
      "remediation": "Remove hardcoded secret and use secret management (e.g., Vault, AWS Secrets Manager)",
      "raw": {
        "RuleID": "github-pat",
        "Category": "GitHub",
        "Severity": "CRITICAL",
        "Title": "GitHub Personal Access Token",
        "StartLine": 2366,
        "EndLine": 2366,
        "Code": {
          "Lines": [
            {
              "Number": 2364,
              "Content": "        \"EndColumn\": 54,",
              "IsCause": false,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"EndColumn\": 54,",
              "FirstCause": false,
              "LastCause": false
            },
            {
              "Number": 2365,
              "Content": "        \"Match\": \"****************************************\",",
              "IsCause": false,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"Match\": \"****************************************\",",
              "FirstCause": false,
              "LastCause": false
            },
            {
              "Number": 2366,
              "Content": "        \"Secret\": \"****************************************\",",
              "IsCause": true,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"Secret\": \"****************************************\",",
              "FirstCause": true,
              "LastCause": true
            },
            {
              "Number": 2367,
              "Content": "        \"File\": \".env\",",
              "IsCause": false,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"File\": \".env\",",
              "FirstCause": false,
              "LastCause": false
            }
          ]
        },
        "Match": "        \"Secret\": \"****************************************\",",
        "Layer": {}
      }
    },
    {
      "scanner": "trivy",
      "severity": "CRITICAL",
      "title": "Secret Detected: Stripe Secret Key",
      "description": "        \"Match\": \"********************\",",
      "file": "GP-copilot/scan-results/gitleaksnpc.json",
      "line": 889,
      "rule_id": "stripe-secret-token",
      "remediation": "Remove hardcoded secret and use secret management (e.g., Vault, AWS Secrets Manager)",
      "raw": {
        "RuleID": "stripe-secret-token",
        "Category": "Stripe",
        "Severity": "CRITICAL",
        "Title": "Stripe Secret Key",
        "StartLine": 889,
        "EndLine": 889,
        "Code": {
          "Lines": [
            {
              "Number": 887,
              "Content": "        \"StartColumn\": 75,",
              "IsCause": false,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"StartColumn\": 75,",
              "FirstCause": false,
              "LastCause": false
            },
            {
              "Number": 888,
              "Content": "        \"EndColumn\": 94,",
              "IsCause": false,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"EndColumn\": 94,",
              "FirstCause": false,
              "LastCause": false
            },
            {
              "Number": 889,
              "Content": "        \"Match\": \"********************\",",
              "IsCause": true,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"Match\": \"********************\",",
              "FirstCause": true,
              "LastCause": true
            },
            {
              "Number": 890,
              "Content": "        \"Secret\": \"********************\",",
              "IsCause": false,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"Secret\": \"********************\",",
              "FirstCause": false,
              "LastCause": false
            }
          ]
        },
        "Match": "        \"Match\": \"********************\",",
        "Layer": {}
      }
    },
    {
      "scanner": "trivy",
      "severity": "CRITICAL",
      "title": "Secret Detected: Stripe Secret Key",
      "description": "        \"Secret\": \"********************\",",
      "file": "GP-copilot/scan-results/gitleaksnpc.json",
      "line": 890,
      "rule_id": "stripe-secret-token",
      "remediation": "Remove hardcoded secret and use secret management (e.g., Vault, AWS Secrets Manager)",
      "raw": {
        "RuleID": "stripe-secret-token",
        "Category": "Stripe",
        "Severity": "CRITICAL",
        "Title": "Stripe Secret Key",
        "StartLine": 890,
        "EndLine": 890,
        "Code": {
          "Lines": [
            {
              "Number": 888,
              "Content": "        \"EndColumn\": 94,",
              "IsCause": false,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"EndColumn\": 94,",
              "FirstCause": false,
              "LastCause": false
            },
            {
              "Number": 889,
              "Content": "        \"Match\": \"********************\",",
              "IsCause": false,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"Match\": \"********************\",",
              "FirstCause": false,
              "LastCause": false
            },
            {
              "Number": 890,
              "Content": "        \"Secret\": \"********************\",",
              "IsCause": true,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"Secret\": \"********************\",",
              "FirstCause": true,
              "LastCause": true
            },
            {
              "Number": 891,
              "Content": "        \"File\": \"rag-pipeline/01-preprocessing-stages/stages/sanitize_npc.py\",",
              "IsCause": false,
              "Annotation": "",
              "Truncated": false,
              "Highlighted": "        \"File\": \"rag-pipeline/01-preprocessing-stages/stages/sanitize_npc.py\",",
              "FirstCause": false,
              "LastCause": false
            }
          ]
        },
        "Match": "        \"Secret\": \"********************\",",
        "Layer": {}
      }
    }
  ],
  "raw_output": "{\n  \"SchemaVersion\": 2,\n  \"CreatedAt\": \"2025-12-30T00:46:30.729131139-05:00\",\n  \"ArtifactName\": \"/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/02-instance/slots/Portfolio\",\n  \"ArtifactType\": \"filesystem\",\n  \"Metadata\": {\n    \"ImageConfig\": {\n      \"architecture\": \"\",\n      \"created\": \"0001-01-01T00:00:00Z\",\n      \"os\": \"\",\n      \"rootfs\": {\n        \"type\": \"\",\n        \"diff_ids\": null\n      },\n      \"config\": {}\n    }\n  },\n  \"Results\": [\n    {\n      \"Target\": \"GP-copilot/conftest-policies/fixtures/secure-deployment.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 4,\n        \"Exceptions\": 0\n      },\n      \"Misconfigurations\": [\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV020\",\n          \"AVDID\": \"AVD-KSV-0020\",\n          \"Title\": \"Runs with UID \\u003c= 10000\",\n          \"Description\": \"Force the container to run with user ID \\u003e 10000 to avoid conflicts with the host\u2019s user table.\",\n          \"Message\": \"Container 'secure-container' of Deployment 'secure-app' should set 'securityContext.runAsUser' \\u003e 10000\",\n          \"Namespace\": \"builtin.kubernetes.KSV020\",\n          \"Query\": \"data.builtin.kubernetes.KSV020.deny\",\n          \"Resolution\": \"Set 'containers[].securityContext.runAsUser' to an integer \\u003e 10000.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv020\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-runasuser/\",\n            \"https://avd.aquasec.com/misconfig/ksv020\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 25,\n            \"EndLine\": 62,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"        - name: secure-container\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: secure-container\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"          image: ghcr.io/jimjrxieb/portfolio-ui:v1.2.3  # Specific version tag from trusted registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage\\u001b[0m: ghcr.io/jimjrxieb/portfolio-ui:v1.2.3  \\u001b[38;5;239m# Specific version tag from trusted registry\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"          imagePullPolicy: IfNotPresent\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m          \\u001b[38;5;33mimagePullPolicy\\u001b[0m: IfNotPresent\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"            runAsNonRoot: true\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot\\u001b[0m: \\u001b[38;5;166mtrue\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"            runAsUser: 1000\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsUser\\u001b[0m: \\u001b[38;5;37m1000\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"            runAsGroup: 1000\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsGroup\\u001b[0m: \\u001b[38;5;37m1000\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            privileged: false\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mprivileged\\u001b[0m: \\u001b[38;5;166mfalse\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"            allowPrivilegeEscalation: false\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mallowPrivilegeEscalation\\u001b[0m: \\u001b[38;5;166mfalse\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 34,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV021\",\n          \"AVDID\": \"AVD-KSV-0021\",\n          \"Title\": \"Runs with GID \\u003c= 10000\",\n          \"Description\": \"Force the container to run with group ID \\u003e 10000 to avoid conflicts with the host\u2019s user table.\",\n          \"Message\": \"Container 'secure-container' of Deployment 'secure-app' should set 'securityContext.runAsGroup' \\u003e 10000\",\n          \"Namespace\": \"builtin.kubernetes.KSV021\",\n          \"Query\": \"data.builtin.kubernetes.KSV021.deny\",\n          \"Resolution\": \"Set 'containers[].securityContext.runAsGroup' to an integer \\u003e 10000.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv021\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-runasuser/\",\n            \"https://avd.aquasec.com/misconfig/ksv021\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 25,\n            \"EndLine\": 62,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"        - name: secure-container\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: secure-container\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"          image: ghcr.io/jimjrxieb/portfolio-ui:v1.2.3  # Specific version tag from trusted registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage\\u001b[0m: ghcr.io/jimjrxieb/portfolio-ui:v1.2.3  \\u001b[38;5;239m# Specific version tag from trusted registry\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"          imagePullPolicy: IfNotPresent\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m          \\u001b[38;5;33mimagePullPolicy\\u001b[0m: IfNotPresent\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"            runAsNonRoot: true\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot\\u001b[0m: \\u001b[38;5;166mtrue\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"            runAsUser: 1000\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsUser\\u001b[0m: \\u001b[38;5;37m1000\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"            runAsGroup: 1000\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsGroup\\u001b[0m: \\u001b[38;5;37m1000\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            privileged: false\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mprivileged\\u001b[0m: \\u001b[38;5;166mfalse\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"            allowPrivilegeEscalation: false\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mallowPrivilegeEscalation\\u001b[0m: \\u001b[38;5;166mfalse\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 34,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV030\",\n          \"AVDID\": \"AVD-KSV-0030\",\n          \"Title\": \"Runtime/Default Seccomp profile not set\",\n          \"Description\": \"According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.\",\n          \"Message\": \"Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'\",\n          \"Namespace\": \"builtin.kubernetes.KSV030\",\n          \"Query\": \"data.builtin.kubernetes.KSV030.deny\",\n          \"Resolution\": \"Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv030\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted\",\n            \"https://avd.aquasec.com/misconfig/ksv030\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 25,\n            \"EndLine\": 62,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"        - name: secure-container\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: secure-container\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"          image: ghcr.io/jimjrxieb/portfolio-ui:v1.2.3  # Specific version tag from trusted registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage\\u001b[0m: ghcr.io/jimjrxieb/portfolio-ui:v1.2.3  \\u001b[38;5;239m# Specific version tag from trusted registry\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"          imagePullPolicy: IfNotPresent\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m          \\u001b[38;5;33mimagePullPolicy\\u001b[0m: IfNotPresent\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"            runAsNonRoot: true\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot\\u001b[0m: \\u001b[38;5;166mtrue\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"            runAsUser: 1000\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsUser\\u001b[0m: \\u001b[38;5;37m1000\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"            runAsGroup: 1000\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsGroup\\u001b[0m: \\u001b[38;5;37m1000\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            privileged: false\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mprivileged\\u001b[0m: \\u001b[38;5;166mfalse\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"            allowPrivilegeEscalation: false\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mallowPrivilegeEscalation\\u001b[0m: \\u001b[38;5;166mfalse\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 34,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV104\",\n          \"AVDID\": \"AVD-KSV-0104\",\n          \"Title\": \"Seccomp policies disabled\",\n          \"Description\": \"A program inside the container can bypass Seccomp protection policies.\",\n          \"Message\": \"container \\\"secure-container\\\" of deployment \\\"secure-app\\\" in \\\"portfolio\\\" namespace should specify a seccomp profile\",\n          \"Namespace\": \"builtin.kubernetes.KSV104\",\n          \"Query\": \"data.builtin.kubernetes.KSV104.deny\",\n          \"Resolution\": \"Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv104\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline\",\n            \"https://avd.aquasec.com/misconfig/ksv104\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"Code\": {\n              \"Lines\": null\n            }\n          }\n        }\n      ]\n    },\n    {\n      \"Target\": \"GP-copilot/conftest-policies/fixtures/vulnerable-deployment.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 32,\n        \"Exceptions\": 0\n      },\n      \"Misconfigurations\": [\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV001\",\n          \"AVDID\": \"AVD-KSV-0001\",\n          \"Title\": \"Can elevate its own privileges\",\n          \"Description\": \"A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.\",\n          \"Message\": \"Container 'bad-container' of Deployment 'vulnerable-app' should set 'securityContext.allowPrivilegeEscalation' to false\",\n          \"Namespace\": \"builtin.kubernetes.KSV001\",\n          \"Query\": \"data.builtin.kubernetes.KSV001.deny\",\n          \"Resolution\": \"Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv001\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted\",\n            \"https://avd.aquasec.com/misconfig/ksv001\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 18,\n            \"EndLine\": 26,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 18,\n                  \"Content\": \"        - name: bad-container\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: bad-container\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"          image: nginx:latest  # Violation: latest tag\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: nginx:latest  # Violation\\u001b[0m: latest tag\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"            runAsUser: 0  # Violation: running as root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsUser: 0  # Violation\\u001b[0m: running as root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"            privileged: true  # Violation: privileged mode\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mprivileged: true  # Violation\\u001b[0m: privileged mode\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"            allowPrivilegeEscalation: true  # Violation: privilege escalation\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\\u001b[0m: privilege escalation\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 24,\n                  \"Content\": \"            readOnlyRootFilesystem: false  # Violation: writable filesystem\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\\u001b[0m: writable filesystem\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 25,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"              add: [\\\"SYS_ADMIN\\\"]  # Violation: dangerous capability\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33madd\\u001b[0m: [\\u001b[38;5;37m\\\"SYS_ADMIN\\\"\\u001b[0m\\u001b[38;5;33m]  # Violation\\u001b[0m: dangerous capability\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV001\",\n          \"AVDID\": \"AVD-KSV-0001\",\n          \"Title\": \"Can elevate its own privileges\",\n          \"Description\": \"A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.\",\n          \"Message\": \"Container 'disallowed-registry' of Deployment 'vulnerable-app' should set 'securityContext.allowPrivilegeEscalation' to false\",\n          \"Namespace\": \"builtin.kubernetes.KSV001\",\n          \"Query\": \"data.builtin.kubernetes.KSV001.deny\",\n          \"Resolution\": \"Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv001\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted\",\n            \"https://avd.aquasec.com/misconfig/ksv001\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 29,\n            \"EndLine\": 32,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 29,\n                  \"Content\": \"        - name: disallowed-registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: disallowed-registry\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"          image: docker.io/ubuntu:20.04  # Violation: disallowed registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\\u001b[0m: disallowed registry\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            runAsNonRoot: false  # Violation: allows root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot: false  # Violation\\u001b[0m: allows root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV003\",\n          \"AVDID\": \"AVD-KSV-0003\",\n          \"Title\": \"Default capabilities: some containers do not drop all\",\n          \"Description\": \"The container should drop all default capabilities and add only those that are needed for its execution.\",\n          \"Message\": \"Container 'bad-container' of Deployment 'vulnerable-app' should add 'ALL' to 'securityContext.capabilities.drop'\",\n          \"Namespace\": \"builtin.kubernetes.KSV003\",\n          \"Query\": \"data.builtin.kubernetes.KSV003.deny\",\n          \"Resolution\": \"Add 'ALL' to containers[].securityContext.capabilities.drop.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv003\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/\",\n            \"https://avd.aquasec.com/misconfig/ksv003\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 18,\n            \"EndLine\": 26,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 18,\n                  \"Content\": \"        - name: bad-container\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: bad-container\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"          image: nginx:latest  # Violation: latest tag\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: nginx:latest  # Violation\\u001b[0m: latest tag\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"            runAsUser: 0  # Violation: running as root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsUser: 0  # Violation\\u001b[0m: running as root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"            privileged: true  # Violation: privileged mode\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mprivileged: true  # Violation\\u001b[0m: privileged mode\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"            allowPrivilegeEscalation: true  # Violation: privilege escalation\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\\u001b[0m: privilege escalation\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 24,\n                  \"Content\": \"            readOnlyRootFilesystem: false  # Violation: writable filesystem\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\\u001b[0m: writable filesystem\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 25,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"              add: [\\\"SYS_ADMIN\\\"]  # Violation: dangerous capability\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33madd\\u001b[0m: [\\u001b[38;5;37m\\\"SYS_ADMIN\\\"\\u001b[0m\\u001b[38;5;33m]  # Violation\\u001b[0m: dangerous capability\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV003\",\n          \"AVDID\": \"AVD-KSV-0003\",\n          \"Title\": \"Default capabilities: some containers do not drop all\",\n          \"Description\": \"The container should drop all default capabilities and add only those that are needed for its execution.\",\n          \"Message\": \"Container 'disallowed-registry' of Deployment 'vulnerable-app' should add 'ALL' to 'securityContext.capabilities.drop'\",\n          \"Namespace\": \"builtin.kubernetes.KSV003\",\n          \"Query\": \"data.builtin.kubernetes.KSV003.deny\",\n          \"Resolution\": \"Add 'ALL' to containers[].securityContext.capabilities.drop.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv003\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/\",\n            \"https://avd.aquasec.com/misconfig/ksv003\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 29,\n            \"EndLine\": 32,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 29,\n                  \"Content\": \"        - name: disallowed-registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: disallowed-registry\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"          image: docker.io/ubuntu:20.04  # Violation: disallowed registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\\u001b[0m: disallowed registry\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            runAsNonRoot: false  # Violation: allows root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot: false  # Violation\\u001b[0m: allows root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV005\",\n          \"AVDID\": \"AVD-KSV-0005\",\n          \"Title\": \"SYS_ADMIN capability added\",\n          \"Description\": \"SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.\",\n          \"Message\": \"Container 'bad-container' of Deployment 'vulnerable-app' should not include 'SYS_ADMIN' in 'securityContext.capabilities.add'\",\n          \"Namespace\": \"builtin.kubernetes.KSV005\",\n          \"Query\": \"data.builtin.kubernetes.KSV005.deny\",\n          \"Resolution\": \"Remove the SYS_ADMIN capability from 'containers[].securityContext.capabilities.add'.\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv005\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-capabilities-add-index-sys-admin/\",\n            \"https://avd.aquasec.com/misconfig/ksv005\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 18,\n            \"EndLine\": 26,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 18,\n                  \"Content\": \"        - name: bad-container\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: bad-container\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"          image: nginx:latest  # Violation: latest tag\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: nginx:latest  # Violation\\u001b[0m: latest tag\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"            runAsUser: 0  # Violation: running as root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsUser: 0  # Violation\\u001b[0m: running as root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"            privileged: true  # Violation: privileged mode\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mprivileged: true  # Violation\\u001b[0m: privileged mode\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"            allowPrivilegeEscalation: true  # Violation: privilege escalation\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\\u001b[0m: privilege escalation\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 24,\n                  \"Content\": \"            readOnlyRootFilesystem: false  # Violation: writable filesystem\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\\u001b[0m: writable filesystem\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 25,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"              add: [\\\"SYS_ADMIN\\\"]  # Violation: dangerous capability\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33madd\\u001b[0m: [\\u001b[38;5;37m\\\"SYS_ADMIN\\\"\\u001b[0m\\u001b[38;5;33m]  # Violation\\u001b[0m: dangerous capability\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV011\",\n          \"AVDID\": \"AVD-KSV-0011\",\n          \"Title\": \"CPU not limited\",\n          \"Description\": \"Enforcing CPU limits prevents DoS via resource exhaustion.\",\n          \"Message\": \"Container 'bad-container' of Deployment 'vulnerable-app' should set 'resources.limits.cpu'\",\n          \"Namespace\": \"builtin.kubernetes.KSV011\",\n          \"Query\": \"data.builtin.kubernetes.KSV011.deny\",\n          \"Resolution\": \"Set a limit value under 'containers[].resources.limits.cpu'.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv011\",\n          \"References\": [\n            \"https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits\",\n            \"https://avd.aquasec.com/misconfig/ksv011\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 18,\n            \"EndLine\": 26,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 18,\n                  \"Content\": \"        - name: bad-container\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: bad-container\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"          image: nginx:latest  # Violation: latest tag\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: nginx:latest  # Violation\\u001b[0m: latest tag\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"            runAsUser: 0  # Violation: running as root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsUser: 0  # Violation\\u001b[0m: running as root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"            privileged: true  # Violation: privileged mode\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mprivileged: true  # Violation\\u001b[0m: privileged mode\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"            allowPrivilegeEscalation: true  # Violation: privilege escalation\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\\u001b[0m: privilege escalation\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 24,\n                  \"Content\": \"            readOnlyRootFilesystem: false  # Violation: writable filesystem\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\\u001b[0m: writable filesystem\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 25,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"              add: [\\\"SYS_ADMIN\\\"]  # Violation: dangerous capability\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33madd\\u001b[0m: [\\u001b[38;5;37m\\\"SYS_ADMIN\\\"\\u001b[0m\\u001b[38;5;33m]  # Violation\\u001b[0m: dangerous capability\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV011\",\n          \"AVDID\": \"AVD-KSV-0011\",\n          \"Title\": \"CPU not limited\",\n          \"Description\": \"Enforcing CPU limits prevents DoS via resource exhaustion.\",\n          \"Message\": \"Container 'disallowed-registry' of Deployment 'vulnerable-app' should set 'resources.limits.cpu'\",\n          \"Namespace\": \"builtin.kubernetes.KSV011\",\n          \"Query\": \"data.builtin.kubernetes.KSV011.deny\",\n          \"Resolution\": \"Set a limit value under 'containers[].resources.limits.cpu'.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv011\",\n          \"References\": [\n            \"https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits\",\n            \"https://avd.aquasec.com/misconfig/ksv011\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 29,\n            \"EndLine\": 32,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 29,\n                  \"Content\": \"        - name: disallowed-registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: disallowed-registry\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"          image: docker.io/ubuntu:20.04  # Violation: disallowed registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\\u001b[0m: disallowed registry\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            runAsNonRoot: false  # Violation: allows root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot: false  # Violation\\u001b[0m: allows root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV012\",\n          \"AVDID\": \"AVD-KSV-0012\",\n          \"Title\": \"Runs as root user\",\n          \"Description\": \"Force the running image to run as a non-root user to ensure least privileges.\",\n          \"Message\": \"Container 'bad-container' of Deployment 'vulnerable-app' should set 'securityContext.runAsNonRoot' to true\",\n          \"Namespace\": \"builtin.kubernetes.KSV012\",\n          \"Query\": \"data.builtin.kubernetes.KSV012.deny\",\n          \"Resolution\": \"Set 'containers[].securityContext.runAsNonRoot' to true.\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv012\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted\",\n            \"https://avd.aquasec.com/misconfig/ksv012\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 18,\n            \"EndLine\": 26,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 18,\n                  \"Content\": \"        - name: bad-container\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: bad-container\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"          image: nginx:latest  # Violation: latest tag\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: nginx:latest  # Violation\\u001b[0m: latest tag\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"            runAsUser: 0  # Violation: running as root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsUser: 0  # Violation\\u001b[0m: running as root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"            privileged: true  # Violation: privileged mode\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mprivileged: true  # Violation\\u001b[0m: privileged mode\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"            allowPrivilegeEscalation: true  # Violation: privilege escalation\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\\u001b[0m: privilege escalation\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 24,\n                  \"Content\": \"            readOnlyRootFilesystem: false  # Violation: writable filesystem\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\\u001b[0m: writable filesystem\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 25,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"              add: [\\\"SYS_ADMIN\\\"]  # Violation: dangerous capability\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33madd\\u001b[0m: [\\u001b[38;5;37m\\\"SYS_ADMIN\\\"\\u001b[0m\\u001b[38;5;33m]  # Violation\\u001b[0m: dangerous capability\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV012\",\n          \"AVDID\": \"AVD-KSV-0012\",\n          \"Title\": \"Runs as root user\",\n          \"Description\": \"Force the running image to run as a non-root user to ensure least privileges.\",\n          \"Message\": \"Container 'disallowed-registry' of Deployment 'vulnerable-app' should set 'securityContext.runAsNonRoot' to true\",\n          \"Namespace\": \"builtin.kubernetes.KSV012\",\n          \"Query\": \"data.builtin.kubernetes.KSV012.deny\",\n          \"Resolution\": \"Set 'containers[].securityContext.runAsNonRoot' to true.\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv012\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted\",\n            \"https://avd.aquasec.com/misconfig/ksv012\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 29,\n            \"EndLine\": 32,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 29,\n                  \"Content\": \"        - name: disallowed-registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: disallowed-registry\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"          image: docker.io/ubuntu:20.04  # Violation: disallowed registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\\u001b[0m: disallowed registry\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            runAsNonRoot: false  # Violation: allows root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot: false  # Violation\\u001b[0m: allows root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV013\",\n          \"AVDID\": \"AVD-KSV-0013\",\n          \"Title\": \"Image tag \\\":latest\\\" used\",\n          \"Description\": \"It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.\",\n          \"Message\": \"Container 'bad-container' of Deployment 'vulnerable-app' should specify an image tag\",\n          \"Namespace\": \"builtin.kubernetes.KSV013\",\n          \"Query\": \"data.builtin.kubernetes.KSV013.deny\",\n          \"Resolution\": \"Use a specific container image tag that is not 'latest'.\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv013\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/configuration/overview/#container-images\",\n            \"https://avd.aquasec.com/misconfig/ksv013\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 18,\n            \"EndLine\": 26,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 18,\n                  \"Content\": \"        - name: bad-container\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: bad-container\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"          image: nginx:latest  # Violation: latest tag\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: nginx:latest  # Violation\\u001b[0m: latest tag\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"            runAsUser: 0  # Violation: running as root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsUser: 0  # Violation\\u001b[0m: running as root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"            privileged: true  # Violation: privileged mode\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mprivileged: true  # Violation\\u001b[0m: privileged mode\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"            allowPrivilegeEscalation: true  # Violation: privilege escalation\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\\u001b[0m: privilege escalation\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 24,\n                  \"Content\": \"            readOnlyRootFilesystem: false  # Violation: writable filesystem\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\\u001b[0m: writable filesystem\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 25,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"              add: [\\\"SYS_ADMIN\\\"]  # Violation: dangerous capability\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33madd\\u001b[0m: [\\u001b[38;5;37m\\\"SYS_ADMIN\\\"\\u001b[0m\\u001b[38;5;33m]  # Violation\\u001b[0m: dangerous capability\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV014\",\n          \"AVDID\": \"AVD-KSV-0014\",\n          \"Title\": \"Root file system is not read-only\",\n          \"Description\": \"An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.\",\n          \"Message\": \"Container 'bad-container' of Deployment 'vulnerable-app' should set 'securityContext.readOnlyRootFilesystem' to true\",\n          \"Namespace\": \"builtin.kubernetes.KSV014\",\n          \"Query\": \"data.builtin.kubernetes.KSV014.deny\",\n          \"Resolution\": \"Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv014\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/\",\n            \"https://avd.aquasec.com/misconfig/ksv014\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 18,\n            \"EndLine\": 26,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 18,\n                  \"Content\": \"        - name: bad-container\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: bad-container\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"          image: nginx:latest  # Violation: latest tag\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: nginx:latest  # Violation\\u001b[0m: latest tag\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"            runAsUser: 0  # Violation: running as root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsUser: 0  # Violation\\u001b[0m: running as root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"            privileged: true  # Violation: privileged mode\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mprivileged: true  # Violation\\u001b[0m: privileged mode\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"            allowPrivilegeEscalation: true  # Violation: privilege escalation\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\\u001b[0m: privilege escalation\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 24,\n                  \"Content\": \"            readOnlyRootFilesystem: false  # Violation: writable filesystem\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\\u001b[0m: writable filesystem\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 25,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"              add: [\\\"SYS_ADMIN\\\"]  # Violation: dangerous capability\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33madd\\u001b[0m: [\\u001b[38;5;37m\\\"SYS_ADMIN\\\"\\u001b[0m\\u001b[38;5;33m]  # Violation\\u001b[0m: dangerous capability\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV014\",\n          \"AVDID\": \"AVD-KSV-0014\",\n          \"Title\": \"Root file system is not read-only\",\n          \"Description\": \"An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.\",\n          \"Message\": \"Container 'disallowed-registry' of Deployment 'vulnerable-app' should set 'securityContext.readOnlyRootFilesystem' to true\",\n          \"Namespace\": \"builtin.kubernetes.KSV014\",\n          \"Query\": \"data.builtin.kubernetes.KSV014.deny\",\n          \"Resolution\": \"Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv014\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/\",\n            \"https://avd.aquasec.com/misconfig/ksv014\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 29,\n            \"EndLine\": 32,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 29,\n                  \"Content\": \"        - name: disallowed-registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: disallowed-registry\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"          image: docker.io/ubuntu:20.04  # Violation: disallowed registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\\u001b[0m: disallowed registry\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            runAsNonRoot: false  # Violation: allows root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot: false  # Violation\\u001b[0m: allows root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV015\",\n          \"AVDID\": \"AVD-KSV-0015\",\n          \"Title\": \"CPU requests not specified\",\n          \"Description\": \"When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.\",\n          \"Message\": \"Container 'bad-container' of Deployment 'vulnerable-app' should set 'resources.requests.cpu'\",\n          \"Namespace\": \"builtin.kubernetes.KSV015\",\n          \"Query\": \"data.builtin.kubernetes.KSV015.deny\",\n          \"Resolution\": \"Set 'containers[].resources.requests.cpu'.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv015\",\n          \"References\": [\n            \"https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits\",\n            \"https://avd.aquasec.com/misconfig/ksv015\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 18,\n            \"EndLine\": 26,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 18,\n                  \"Content\": \"        - name: bad-container\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: bad-container\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"          image: nginx:latest  # Violation: latest tag\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: nginx:latest  # Violation\\u001b[0m: latest tag\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"            runAsUser: 0  # Violation: running as root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsUser: 0  # Violation\\u001b[0m: running as root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"            privileged: true  # Violation: privileged mode\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mprivileged: true  # Violation\\u001b[0m: privileged mode\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"            allowPrivilegeEscalation: true  # Violation: privilege escalation\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\\u001b[0m: privilege escalation\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 24,\n                  \"Content\": \"            readOnlyRootFilesystem: false  # Violation: writable filesystem\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\\u001b[0m: writable filesystem\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 25,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"              add: [\\\"SYS_ADMIN\\\"]  # Violation: dangerous capability\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33madd\\u001b[0m: [\\u001b[38;5;37m\\\"SYS_ADMIN\\\"\\u001b[0m\\u001b[38;5;33m]  # Violation\\u001b[0m: dangerous capability\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV015\",\n          \"AVDID\": \"AVD-KSV-0015\",\n          \"Title\": \"CPU requests not specified\",\n          \"Description\": \"When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.\",\n          \"Message\": \"Container 'disallowed-registry' of Deployment 'vulnerable-app' should set 'resources.requests.cpu'\",\n          \"Namespace\": \"builtin.kubernetes.KSV015\",\n          \"Query\": \"data.builtin.kubernetes.KSV015.deny\",\n          \"Resolution\": \"Set 'containers[].resources.requests.cpu'.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv015\",\n          \"References\": [\n            \"https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits\",\n            \"https://avd.aquasec.com/misconfig/ksv015\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 29,\n            \"EndLine\": 32,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 29,\n                  \"Content\": \"        - name: disallowed-registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: disallowed-registry\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"          image: docker.io/ubuntu:20.04  # Violation: disallowed registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\\u001b[0m: disallowed registry\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            runAsNonRoot: false  # Violation: allows root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot: false  # Violation\\u001b[0m: allows root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV016\",\n          \"AVDID\": \"AVD-KSV-0016\",\n          \"Title\": \"Memory requests not specified\",\n          \"Description\": \"When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.\",\n          \"Message\": \"Container 'bad-container' of Deployment 'vulnerable-app' should set 'resources.requests.memory'\",\n          \"Namespace\": \"builtin.kubernetes.KSV016\",\n          \"Query\": \"data.builtin.kubernetes.KSV016.deny\",\n          \"Resolution\": \"Set 'containers[].resources.requests.memory'.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv016\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-resources-limits-memory/\",\n            \"https://avd.aquasec.com/misconfig/ksv016\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 18,\n            \"EndLine\": 26,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 18,\n                  \"Content\": \"        - name: bad-container\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: bad-container\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"          image: nginx:latest  # Violation: latest tag\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: nginx:latest  # Violation\\u001b[0m: latest tag\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"            runAsUser: 0  # Violation: running as root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsUser: 0  # Violation\\u001b[0m: running as root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"            privileged: true  # Violation: privileged mode\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mprivileged: true  # Violation\\u001b[0m: privileged mode\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"            allowPrivilegeEscalation: true  # Violation: privilege escalation\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\\u001b[0m: privilege escalation\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 24,\n                  \"Content\": \"            readOnlyRootFilesystem: false  # Violation: writable filesystem\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\\u001b[0m: writable filesystem\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 25,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"              add: [\\\"SYS_ADMIN\\\"]  # Violation: dangerous capability\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33madd\\u001b[0m: [\\u001b[38;5;37m\\\"SYS_ADMIN\\\"\\u001b[0m\\u001b[38;5;33m]  # Violation\\u001b[0m: dangerous capability\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV016\",\n          \"AVDID\": \"AVD-KSV-0016\",\n          \"Title\": \"Memory requests not specified\",\n          \"Description\": \"When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.\",\n          \"Message\": \"Container 'disallowed-registry' of Deployment 'vulnerable-app' should set 'resources.requests.memory'\",\n          \"Namespace\": \"builtin.kubernetes.KSV016\",\n          \"Query\": \"data.builtin.kubernetes.KSV016.deny\",\n          \"Resolution\": \"Set 'containers[].resources.requests.memory'.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv016\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-resources-limits-memory/\",\n            \"https://avd.aquasec.com/misconfig/ksv016\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 29,\n            \"EndLine\": 32,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 29,\n                  \"Content\": \"        - name: disallowed-registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: disallowed-registry\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"          image: docker.io/ubuntu:20.04  # Violation: disallowed registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\\u001b[0m: disallowed registry\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            runAsNonRoot: false  # Violation: allows root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot: false  # Violation\\u001b[0m: allows root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV017\",\n          \"AVDID\": \"AVD-KSV-0017\",\n          \"Title\": \"Privileged\",\n          \"Description\": \"Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.\",\n          \"Message\": \"Container 'bad-container' of Deployment 'vulnerable-app' should set 'securityContext.privileged' to false\",\n          \"Namespace\": \"builtin.kubernetes.KSV017\",\n          \"Query\": \"data.builtin.kubernetes.KSV017.deny\",\n          \"Resolution\": \"Change 'containers[].securityContext.privileged' to 'false'.\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv017\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline\",\n            \"https://avd.aquasec.com/misconfig/ksv017\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 18,\n            \"EndLine\": 26,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 18,\n                  \"Content\": \"        - name: bad-container\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: bad-container\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"          image: nginx:latest  # Violation: latest tag\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: nginx:latest  # Violation\\u001b[0m: latest tag\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"            runAsUser: 0  # Violation: running as root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsUser: 0  # Violation\\u001b[0m: running as root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"            privileged: true  # Violation: privileged mode\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mprivileged: true  # Violation\\u001b[0m: privileged mode\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"            allowPrivilegeEscalation: true  # Violation: privilege escalation\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\\u001b[0m: privilege escalation\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 24,\n                  \"Content\": \"            readOnlyRootFilesystem: false  # Violation: writable filesystem\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\\u001b[0m: writable filesystem\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 25,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"              add: [\\\"SYS_ADMIN\\\"]  # Violation: dangerous capability\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33madd\\u001b[0m: [\\u001b[38;5;37m\\\"SYS_ADMIN\\\"\\u001b[0m\\u001b[38;5;33m]  # Violation\\u001b[0m: dangerous capability\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV018\",\n          \"AVDID\": \"AVD-KSV-0018\",\n          \"Title\": \"Memory not limited\",\n          \"Description\": \"Enforcing memory limits prevents DoS via resource exhaustion.\",\n          \"Message\": \"Container 'bad-container' of Deployment 'vulnerable-app' should set 'resources.limits.memory'\",\n          \"Namespace\": \"builtin.kubernetes.KSV018\",\n          \"Query\": \"data.builtin.kubernetes.KSV018.deny\",\n          \"Resolution\": \"Set a limit value under 'containers[].resources.limits.memory'.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv018\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-resources-limits-memory/\",\n            \"https://avd.aquasec.com/misconfig/ksv018\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 18,\n            \"EndLine\": 26,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 18,\n                  \"Content\": \"        - name: bad-container\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: bad-container\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"          image: nginx:latest  # Violation: latest tag\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: nginx:latest  # Violation\\u001b[0m: latest tag\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"            runAsUser: 0  # Violation: running as root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsUser: 0  # Violation\\u001b[0m: running as root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"            privileged: true  # Violation: privileged mode\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mprivileged: true  # Violation\\u001b[0m: privileged mode\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"            allowPrivilegeEscalation: true  # Violation: privilege escalation\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\\u001b[0m: privilege escalation\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 24,\n                  \"Content\": \"            readOnlyRootFilesystem: false  # Violation: writable filesystem\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\\u001b[0m: writable filesystem\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 25,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"              add: [\\\"SYS_ADMIN\\\"]  # Violation: dangerous capability\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33madd\\u001b[0m: [\\u001b[38;5;37m\\\"SYS_ADMIN\\\"\\u001b[0m\\u001b[38;5;33m]  # Violation\\u001b[0m: dangerous capability\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV018\",\n          \"AVDID\": \"AVD-KSV-0018\",\n          \"Title\": \"Memory not limited\",\n          \"Description\": \"Enforcing memory limits prevents DoS via resource exhaustion.\",\n          \"Message\": \"Container 'disallowed-registry' of Deployment 'vulnerable-app' should set 'resources.limits.memory'\",\n          \"Namespace\": \"builtin.kubernetes.KSV018\",\n          \"Query\": \"data.builtin.kubernetes.KSV018.deny\",\n          \"Resolution\": \"Set a limit value under 'containers[].resources.limits.memory'.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv018\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-resources-limits-memory/\",\n            \"https://avd.aquasec.com/misconfig/ksv018\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 29,\n            \"EndLine\": 32,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 29,\n                  \"Content\": \"        - name: disallowed-registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: disallowed-registry\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"          image: docker.io/ubuntu:20.04  # Violation: disallowed registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\\u001b[0m: disallowed registry\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            runAsNonRoot: false  # Violation: allows root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot: false  # Violation\\u001b[0m: allows root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV020\",\n          \"AVDID\": \"AVD-KSV-0020\",\n          \"Title\": \"Runs with UID \\u003c= 10000\",\n          \"Description\": \"Force the container to run with user ID \\u003e 10000 to avoid conflicts with the host\u2019s user table.\",\n          \"Message\": \"Container 'bad-container' of Deployment 'vulnerable-app' should set 'securityContext.runAsUser' \\u003e 10000\",\n          \"Namespace\": \"builtin.kubernetes.KSV020\",\n          \"Query\": \"data.builtin.kubernetes.KSV020.deny\",\n          \"Resolution\": \"Set 'containers[].securityContext.runAsUser' to an integer \\u003e 10000.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv020\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-runasuser/\",\n            \"https://avd.aquasec.com/misconfig/ksv020\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 18,\n            \"EndLine\": 26,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 18,\n                  \"Content\": \"        - name: bad-container\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: bad-container\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"          image: nginx:latest  # Violation: latest tag\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: nginx:latest  # Violation\\u001b[0m: latest tag\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"            runAsUser: 0  # Violation: running as root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsUser: 0  # Violation\\u001b[0m: running as root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"            privileged: true  # Violation: privileged mode\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mprivileged: true  # Violation\\u001b[0m: privileged mode\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"            allowPrivilegeEscalation: true  # Violation: privilege escalation\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\\u001b[0m: privilege escalation\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 24,\n                  \"Content\": \"            readOnlyRootFilesystem: false  # Violation: writable filesystem\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\\u001b[0m: writable filesystem\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 25,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"              add: [\\\"SYS_ADMIN\\\"]  # Violation: dangerous capability\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33madd\\u001b[0m: [\\u001b[38;5;37m\\\"SYS_ADMIN\\\"\\u001b[0m\\u001b[38;5;33m]  # Violation\\u001b[0m: dangerous capability\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV020\",\n          \"AVDID\": \"AVD-KSV-0020\",\n          \"Title\": \"Runs with UID \\u003c= 10000\",\n          \"Description\": \"Force the container to run with user ID \\u003e 10000 to avoid conflicts with the host\u2019s user table.\",\n          \"Message\": \"Container 'disallowed-registry' of Deployment 'vulnerable-app' should set 'securityContext.runAsUser' \\u003e 10000\",\n          \"Namespace\": \"builtin.kubernetes.KSV020\",\n          \"Query\": \"data.builtin.kubernetes.KSV020.deny\",\n          \"Resolution\": \"Set 'containers[].securityContext.runAsUser' to an integer \\u003e 10000.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv020\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-runasuser/\",\n            \"https://avd.aquasec.com/misconfig/ksv020\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 29,\n            \"EndLine\": 32,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 29,\n                  \"Content\": \"        - name: disallowed-registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: disallowed-registry\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"          image: docker.io/ubuntu:20.04  # Violation: disallowed registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\\u001b[0m: disallowed registry\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            runAsNonRoot: false  # Violation: allows root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot: false  # Violation\\u001b[0m: allows root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV021\",\n          \"AVDID\": \"AVD-KSV-0021\",\n          \"Title\": \"Runs with GID \\u003c= 10000\",\n          \"Description\": \"Force the container to run with group ID \\u003e 10000 to avoid conflicts with the host\u2019s user table.\",\n          \"Message\": \"Container 'bad-container' of Deployment 'vulnerable-app' should set 'securityContext.runAsGroup' \\u003e 10000\",\n          \"Namespace\": \"builtin.kubernetes.KSV021\",\n          \"Query\": \"data.builtin.kubernetes.KSV021.deny\",\n          \"Resolution\": \"Set 'containers[].securityContext.runAsGroup' to an integer \\u003e 10000.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv021\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-runasuser/\",\n            \"https://avd.aquasec.com/misconfig/ksv021\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 18,\n            \"EndLine\": 26,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 18,\n                  \"Content\": \"        - name: bad-container\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: bad-container\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"          image: nginx:latest  # Violation: latest tag\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: nginx:latest  # Violation\\u001b[0m: latest tag\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"            runAsUser: 0  # Violation: running as root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsUser: 0  # Violation\\u001b[0m: running as root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"            privileged: true  # Violation: privileged mode\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mprivileged: true  # Violation\\u001b[0m: privileged mode\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"            allowPrivilegeEscalation: true  # Violation: privilege escalation\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\\u001b[0m: privilege escalation\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 24,\n                  \"Content\": \"            readOnlyRootFilesystem: false  # Violation: writable filesystem\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\\u001b[0m: writable filesystem\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 25,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"              add: [\\\"SYS_ADMIN\\\"]  # Violation: dangerous capability\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33madd\\u001b[0m: [\\u001b[38;5;37m\\\"SYS_ADMIN\\\"\\u001b[0m\\u001b[38;5;33m]  # Violation\\u001b[0m: dangerous capability\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV021\",\n          \"AVDID\": \"AVD-KSV-0021\",\n          \"Title\": \"Runs with GID \\u003c= 10000\",\n          \"Description\": \"Force the container to run with group ID \\u003e 10000 to avoid conflicts with the host\u2019s user table.\",\n          \"Message\": \"Container 'disallowed-registry' of Deployment 'vulnerable-app' should set 'securityContext.runAsGroup' \\u003e 10000\",\n          \"Namespace\": \"builtin.kubernetes.KSV021\",\n          \"Query\": \"data.builtin.kubernetes.KSV021.deny\",\n          \"Resolution\": \"Set 'containers[].securityContext.runAsGroup' to an integer \\u003e 10000.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv021\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-runasuser/\",\n            \"https://avd.aquasec.com/misconfig/ksv021\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 29,\n            \"EndLine\": 32,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 29,\n                  \"Content\": \"        - name: disallowed-registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: disallowed-registry\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"          image: docker.io/ubuntu:20.04  # Violation: disallowed registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\\u001b[0m: disallowed registry\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            runAsNonRoot: false  # Violation: allows root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot: false  # Violation\\u001b[0m: allows root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV022\",\n          \"AVDID\": \"AVD-KSV-0022\",\n          \"Title\": \"Specific capabilities added\",\n          \"Description\": \"According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.\",\n          \"Message\": \"Container 'bad-container' of Deployment 'vulnerable-app' should not set 'securityContext.capabilities.add'\",\n          \"Namespace\": \"builtin.kubernetes.KSV022\",\n          \"Query\": \"data.builtin.kubernetes.KSV022.deny\",\n          \"Resolution\": \"Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv022\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline\",\n            \"https://avd.aquasec.com/misconfig/ksv022\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 18,\n            \"EndLine\": 26,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 18,\n                  \"Content\": \"        - name: bad-container\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: bad-container\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"          image: nginx:latest  # Violation: latest tag\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: nginx:latest  # Violation\\u001b[0m: latest tag\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"            runAsUser: 0  # Violation: running as root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsUser: 0  # Violation\\u001b[0m: running as root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"            privileged: true  # Violation: privileged mode\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mprivileged: true  # Violation\\u001b[0m: privileged mode\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"            allowPrivilegeEscalation: true  # Violation: privilege escalation\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\\u001b[0m: privilege escalation\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 24,\n                  \"Content\": \"            readOnlyRootFilesystem: false  # Violation: writable filesystem\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\\u001b[0m: writable filesystem\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 25,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"              add: [\\\"SYS_ADMIN\\\"]  # Violation: dangerous capability\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33madd\\u001b[0m: [\\u001b[38;5;37m\\\"SYS_ADMIN\\\"\\u001b[0m\\u001b[38;5;33m]  # Violation\\u001b[0m: dangerous capability\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV030\",\n          \"AVDID\": \"AVD-KSV-0030\",\n          \"Title\": \"Runtime/Default Seccomp profile not set\",\n          \"Description\": \"According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.\",\n          \"Message\": \"Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'\",\n          \"Namespace\": \"builtin.kubernetes.KSV030\",\n          \"Query\": \"data.builtin.kubernetes.KSV030.deny\",\n          \"Resolution\": \"Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv030\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted\",\n            \"https://avd.aquasec.com/misconfig/ksv030\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 29,\n            \"EndLine\": 32,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 29,\n                  \"Content\": \"        - name: disallowed-registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: disallowed-registry\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"          image: docker.io/ubuntu:20.04  # Violation: disallowed registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\\u001b[0m: disallowed registry\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            runAsNonRoot: false  # Violation: allows root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot: false  # Violation\\u001b[0m: allows root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV030\",\n          \"AVDID\": \"AVD-KSV-0030\",\n          \"Title\": \"Runtime/Default Seccomp profile not set\",\n          \"Description\": \"According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.\",\n          \"Message\": \"Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'\",\n          \"Namespace\": \"builtin.kubernetes.KSV030\",\n          \"Query\": \"data.builtin.kubernetes.KSV030.deny\",\n          \"Resolution\": \"Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv030\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted\",\n            \"https://avd.aquasec.com/misconfig/ksv030\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 18,\n            \"EndLine\": 26,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 18,\n                  \"Content\": \"        - name: bad-container\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: bad-container\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"          image: nginx:latest  # Violation: latest tag\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: nginx:latest  # Violation\\u001b[0m: latest tag\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"            runAsUser: 0  # Violation: running as root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsUser: 0  # Violation\\u001b[0m: running as root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"            privileged: true  # Violation: privileged mode\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mprivileged: true  # Violation\\u001b[0m: privileged mode\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"            allowPrivilegeEscalation: true  # Violation: privilege escalation\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\\u001b[0m: privilege escalation\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 24,\n                  \"Content\": \"            readOnlyRootFilesystem: false  # Violation: writable filesystem\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\\u001b[0m: writable filesystem\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 25,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"              add: [\\\"SYS_ADMIN\\\"]  # Violation: dangerous capability\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33madd\\u001b[0m: [\\u001b[38;5;37m\\\"SYS_ADMIN\\\"\\u001b[0m\\u001b[38;5;33m]  # Violation\\u001b[0m: dangerous capability\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV104\",\n          \"AVDID\": \"AVD-KSV-0104\",\n          \"Title\": \"Seccomp policies disabled\",\n          \"Description\": \"A program inside the container can bypass Seccomp protection policies.\",\n          \"Message\": \"container \\\"bad-container\\\" of deployment \\\"vulnerable-app\\\" in \\\"default\\\" namespace should specify a seccomp profile\",\n          \"Namespace\": \"builtin.kubernetes.KSV104\",\n          \"Query\": \"data.builtin.kubernetes.KSV104.deny\",\n          \"Resolution\": \"Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv104\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline\",\n            \"https://avd.aquasec.com/misconfig/ksv104\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"Code\": {\n              \"Lines\": null\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV104\",\n          \"AVDID\": \"AVD-KSV-0104\",\n          \"Title\": \"Seccomp policies disabled\",\n          \"Description\": \"A program inside the container can bypass Seccomp protection policies.\",\n          \"Message\": \"container \\\"disallowed-registry\\\" of deployment \\\"vulnerable-app\\\" in \\\"default\\\" namespace should specify a seccomp profile\",\n          \"Namespace\": \"builtin.kubernetes.KSV104\",\n          \"Query\": \"data.builtin.kubernetes.KSV104.deny\",\n          \"Resolution\": \"Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv104\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline\",\n            \"https://avd.aquasec.com/misconfig/ksv104\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"Code\": {\n              \"Lines\": null\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV105\",\n          \"AVDID\": \"AVD-KSV-0105\",\n          \"Title\": \"Containers must not set runAsUser to 0\",\n          \"Description\": \"Containers should be forbidden from running with a root UID.\",\n          \"Message\": \"securityContext.runAsUser should be set to a value greater than 0\",\n          \"Namespace\": \"builtin.kubernetes.KSV105\",\n          \"Query\": \"data.builtin.kubernetes.KSV105.deny\",\n          \"Resolution\": \"Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv105\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted\",\n            \"https://avd.aquasec.com/misconfig/ksv105\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 21,\n            \"EndLine\": 26,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 21,\n                  \"Content\": \"            runAsUser: 0  # Violation: running as root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsUser: 0  # Violation\\u001b[0m: running as root\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"            privileged: true  # Violation: privileged mode\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mprivileged: true  # Violation\\u001b[0m: privileged mode\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"            allowPrivilegeEscalation: true  # Violation: privilege escalation\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\\u001b[0m: privilege escalation\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 24,\n                  \"Content\": \"            readOnlyRootFilesystem: false  # Violation: writable filesystem\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\\u001b[0m: writable filesystem\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 25,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"              add: [\\\"SYS_ADMIN\\\"]  # Violation: dangerous capability\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33madd\\u001b[0m: [\\u001b[38;5;37m\\\"SYS_ADMIN\\\"\\u001b[0m\\u001b[38;5;33m]  # Violation\\u001b[0m: dangerous capability\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV106\",\n          \"AVDID\": \"AVD-KSV-0106\",\n          \"Title\": \"Container capabilities must only include NET_BIND_SERVICE\",\n          \"Description\": \"Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.\",\n          \"Message\": \"container should drop all\",\n          \"Namespace\": \"builtin.kubernetes.KSV106\",\n          \"Query\": \"data.builtin.kubernetes.KSV106.deny\",\n          \"Resolution\": \"Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv106\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted\",\n            \"https://avd.aquasec.com/misconfig/ksv106\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 29,\n            \"EndLine\": 32,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 29,\n                  \"Content\": \"        - name: disallowed-registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: disallowed-registry\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"          image: docker.io/ubuntu:20.04  # Violation: disallowed registry\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: docker.io/ubuntu:20.04  # Violation\\u001b[0m: disallowed registry\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            runAsNonRoot: false  # Violation: allows root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot: false  # Violation\\u001b[0m: allows root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV106\",\n          \"AVDID\": \"AVD-KSV-0106\",\n          \"Title\": \"Container capabilities must only include NET_BIND_SERVICE\",\n          \"Description\": \"Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.\",\n          \"Message\": \"container should drop all\",\n          \"Namespace\": \"builtin.kubernetes.KSV106\",\n          \"Query\": \"data.builtin.kubernetes.KSV106.deny\",\n          \"Resolution\": \"Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv106\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted\",\n            \"https://avd.aquasec.com/misconfig/ksv106\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 18,\n            \"EndLine\": 26,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 18,\n                  \"Content\": \"        - name: bad-container\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: bad-container\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"          image: nginx:latest  # Violation: latest tag\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage: nginx:latest  # Violation\\u001b[0m: latest tag\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"            runAsUser: 0  # Violation: running as root\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsUser: 0  # Violation\\u001b[0m: running as root\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"            privileged: true  # Violation: privileged mode\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mprivileged: true  # Violation\\u001b[0m: privileged mode\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"            allowPrivilegeEscalation: true  # Violation: privilege escalation\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mallowPrivilegeEscalation: true  # Violation\\u001b[0m: privilege escalation\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 24,\n                  \"Content\": \"            readOnlyRootFilesystem: false  # Violation: writable filesystem\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mreadOnlyRootFilesystem: false  # Violation\\u001b[0m: writable filesystem\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 25,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"              add: [\\\"SYS_ADMIN\\\"]  # Violation: dangerous capability\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33madd\\u001b[0m: [\\u001b[38;5;37m\\\"SYS_ADMIN\\\"\\u001b[0m\\u001b[38;5;33m]  # Violation\\u001b[0m: dangerous capability\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV110\",\n          \"AVDID\": \"AVD-KSV-0110\",\n          \"Title\": \"Workloads in the default namespace\",\n          \"Description\": \"Checks whether a workload is running in the default namespace.\",\n          \"Message\": \"deployment vulnerable-app in default namespace should set metadata.namespace to a non-default namespace\",\n          \"Namespace\": \"builtin.kubernetes.KSV110\",\n          \"Query\": \"data.builtin.kubernetes.KSV110.deny\",\n          \"Resolution\": \"Set 'metadata.namespace' to a non-default namespace.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv110\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/\",\n            \"https://avd.aquasec.com/misconfig/ksv110\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"Code\": {\n              \"Lines\": null\n            }\n          }\n        }\n      ]\n    },\n    {\n      \"Target\": \"GP-copilot/gatekeeper-temps/container-security.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"GP-copilot/gatekeeper-temps/image-security.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"GP-copilot/gatekeeper-temps/pod-security-standards.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"GP-copilot/gatekeeper-temps/resource-limits.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"api/Dockerfile\",\n      \"Class\": \"config\",\n      \"Type\": \"dockerfile\",\n      \"MisconfSummary\": {\n        \"Successes\": 27,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"data/chromadb-config/Dockerfile\",\n      \"Class\": \"config\",\n      \"Type\": \"dockerfile\",\n      \"MisconfSummary\": {\n        \"Successes\": 24,\n        \"Failures\": 3,\n        \"Exceptions\": 0\n      },\n      \"Misconfigurations\": [\n        {\n          \"Type\": \"Dockerfile Security Check\",\n          \"ID\": \"DS001\",\n          \"AVDID\": \"AVD-DS-0001\",\n          \"Title\": \"':latest' tag used\",\n          \"Description\": \"When using a 'FROM' statement you should use a specific tag to avoid uncontrolled behavior when the image is updated.\",\n          \"Message\": \"Specify a tag in the 'FROM' statement for image 'chromadb/chroma'\",\n          \"Namespace\": \"builtin.dockerfile.DS001\",\n          \"Query\": \"data.builtin.dockerfile.DS001.deny\",\n          \"Resolution\": \"Add a tag to the image in the 'FROM' statement\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ds001\",\n          \"References\": [\n            \"https://avd.aquasec.com/misconfig/ds001\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Dockerfile\",\n            \"Service\": \"general\",\n            \"StartLine\": 1,\n            \"EndLine\": 1,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 1,\n                  \"Content\": \"FROM chromadb/chroma:latest\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;64mFROM\\u001b[0m\\u001b[38;5;37m chromadb/chroma:latest\",\n                  \"FirstCause\": true,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Dockerfile Security Check\",\n          \"ID\": \"DS026\",\n          \"AVDID\": \"AVD-DS-0026\",\n          \"Title\": \"No HEALTHCHECK defined\",\n          \"Description\": \"You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.\",\n          \"Message\": \"Add HEALTHCHECK instruction in your Dockerfile\",\n          \"Namespace\": \"builtin.dockerfile.DS026\",\n          \"Query\": \"data.builtin.dockerfile.DS026.deny\",\n          \"Resolution\": \"Add HEALTHCHECK instruction in Dockerfile\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ds026\",\n          \"References\": [\n            \"https://blog.aquasec.com/docker-security-best-practices\",\n            \"https://avd.aquasec.com/misconfig/ds026\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Dockerfile\",\n            \"Service\": \"general\",\n            \"Code\": {\n              \"Lines\": null\n            }\n          }\n        },\n        {\n          \"Type\": \"Dockerfile Security Check\",\n          \"ID\": \"DS029\",\n          \"AVDID\": \"AVD-DS-0029\",\n          \"Title\": \"'apt-get' missing '--no-install-recommends'\",\n          \"Description\": \"'apt-get' install should use '--no-install-recommends' to minimize image size.\",\n          \"Message\": \"'--no-install-recommends' flag is missed: 'apt-get update \\u0026\\u0026 apt-get install -y curl \\u0026\\u0026 rm -rf /var/lib/apt/lists/*'\",\n          \"Namespace\": \"builtin.dockerfile.DS029\",\n          \"Query\": \"data.builtin.dockerfile.DS029.deny\",\n          \"Resolution\": \"Add '--no-install-recommends' flag to 'apt-get'\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ds029\",\n          \"References\": [\n            \"https://docs.docker.com/develop/develop-images/dockerfile_best-practices/\",\n            \"https://avd.aquasec.com/misconfig/ds029\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Dockerfile\",\n            \"Service\": \"general\",\n            \"StartLine\": 8,\n            \"EndLine\": 8,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 8,\n                  \"Content\": \"RUN apt-get update \\u0026\\u0026 apt-get install -y curl \\u0026\\u0026 rm -rf /var/lib/apt/lists/*\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;64mRUN\\u001b[0m apt-get update \\u001b[38;5;245m\\u0026\\u0026\\u001b[0m apt-get install -y curl \\u001b[38;5;245m\\u0026\\u0026\\u001b[0m rm -rf /var/lib/apt/lists/*\",\n                  \"FirstCause\": true,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        }\n      ]\n    },\n    {\n      \"Target\": \"infrastructure/method1-simple-kubectl/01-namespace.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method1-simple-kubectl/03-chroma-pv-local.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method1-simple-kubectl/03b-chroma-log-config.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method1-simple-kubectl/04-chroma-deployment.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 3,\n        \"Exceptions\": 0\n      },\n      \"Misconfigurations\": [\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV014\",\n          \"AVDID\": \"AVD-KSV-0014\",\n          \"Title\": \"Root file system is not read-only\",\n          \"Description\": \"An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.\",\n          \"Message\": \"Container 'chromadb' of Deployment 'chromadb' should set 'securityContext.readOnlyRootFilesystem' to true\",\n          \"Namespace\": \"builtin.kubernetes.KSV014\",\n          \"Query\": \"data.builtin.kubernetes.KSV014.deny\",\n          \"Resolution\": \"Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv014\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/\",\n            \"https://avd.aquasec.com/misconfig/ksv014\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 26,\n            \"EndLine\": 59,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 26,\n                  \"Content\": \"        - name: chromadb\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: chromadb\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"          image: chromadb/chroma:0.5.18\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage\\u001b[0m: chromadb/chroma:0.5.18\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"          imagePullPolicy: IfNotPresent\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimagePullPolicy\\u001b[0m: IfNotPresent\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"            runAsNonRoot: true\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot\\u001b[0m: \\u001b[38;5;166mtrue\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"            runAsUser: 1000\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsUser\\u001b[0m: \\u001b[38;5;37m1000\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            runAsGroup: 1000\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsGroup\\u001b[0m: \\u001b[38;5;37m1000\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"            allowPrivilegeEscalation: false\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mallowPrivilegeEscalation\\u001b[0m: \\u001b[38;5;166mfalse\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 34,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 35,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV020\",\n          \"AVDID\": \"AVD-KSV-0020\",\n          \"Title\": \"Runs with UID \\u003c= 10000\",\n          \"Description\": \"Force the container to run with user ID \\u003e 10000 to avoid conflicts with the host\u2019s user table.\",\n          \"Message\": \"Container 'chromadb' of Deployment 'chromadb' should set 'securityContext.runAsUser' \\u003e 10000\",\n          \"Namespace\": \"builtin.kubernetes.KSV020\",\n          \"Query\": \"data.builtin.kubernetes.KSV020.deny\",\n          \"Resolution\": \"Set 'containers[].securityContext.runAsUser' to an integer \\u003e 10000.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv020\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-runasuser/\",\n            \"https://avd.aquasec.com/misconfig/ksv020\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 26,\n            \"EndLine\": 59,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 26,\n                  \"Content\": \"        - name: chromadb\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: chromadb\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"          image: chromadb/chroma:0.5.18\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage\\u001b[0m: chromadb/chroma:0.5.18\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"          imagePullPolicy: IfNotPresent\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimagePullPolicy\\u001b[0m: IfNotPresent\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"            runAsNonRoot: true\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot\\u001b[0m: \\u001b[38;5;166mtrue\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"            runAsUser: 1000\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsUser\\u001b[0m: \\u001b[38;5;37m1000\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            runAsGroup: 1000\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsGroup\\u001b[0m: \\u001b[38;5;37m1000\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"            allowPrivilegeEscalation: false\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mallowPrivilegeEscalation\\u001b[0m: \\u001b[38;5;166mfalse\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 34,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 35,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV021\",\n          \"AVDID\": \"AVD-KSV-0021\",\n          \"Title\": \"Runs with GID \\u003c= 10000\",\n          \"Description\": \"Force the container to run with group ID \\u003e 10000 to avoid conflicts with the host\u2019s user table.\",\n          \"Message\": \"Container 'chromadb' of Deployment 'chromadb' should set 'securityContext.runAsGroup' \\u003e 10000\",\n          \"Namespace\": \"builtin.kubernetes.KSV021\",\n          \"Query\": \"data.builtin.kubernetes.KSV021.deny\",\n          \"Resolution\": \"Set 'containers[].securityContext.runAsGroup' to an integer \\u003e 10000.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv021\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-runasuser/\",\n            \"https://avd.aquasec.com/misconfig/ksv021\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 26,\n            \"EndLine\": 59,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 26,\n                  \"Content\": \"        - name: chromadb\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"        - \\u001b[38;5;33mname\\u001b[0m: chromadb\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"          image: chromadb/chroma:0.5.18\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage\\u001b[0m: chromadb/chroma:0.5.18\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"          imagePullPolicy: IfNotPresent\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimagePullPolicy\\u001b[0m: IfNotPresent\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"            runAsNonRoot: true\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot\\u001b[0m: \\u001b[38;5;166mtrue\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"            runAsUser: 1000\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsUser\\u001b[0m: \\u001b[38;5;37m1000\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            runAsGroup: 1000\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsGroup\\u001b[0m: \\u001b[38;5;37m1000\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"            allowPrivilegeEscalation: false\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mallowPrivilegeEscalation\\u001b[0m: \\u001b[38;5;166mfalse\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 34,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 35,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        }\n      ]\n    },\n    {\n      \"Target\": \"infrastructure/method1-simple-kubectl/05-api-deployment.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 8,\n        \"Exceptions\": 0\n      },\n      \"Misconfigurations\": [\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV011\",\n          \"AVDID\": \"AVD-KSV-0011\",\n          \"Title\": \"CPU not limited\",\n          \"Description\": \"Enforcing CPU limits prevents DoS via resource exhaustion.\",\n          \"Message\": \"Container 'wait-for-chromadb' of Deployment 'portfolio-api' should set 'resources.limits.cpu'\",\n          \"Namespace\": \"builtin.kubernetes.KSV011\",\n          \"Query\": \"data.builtin.kubernetes.KSV011.deny\",\n          \"Resolution\": \"Set a limit value under 'containers[].resources.limits.cpu'.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv011\",\n          \"References\": [\n            \"https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits\",\n            \"https://avd.aquasec.com/misconfig/ksv011\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 27,\n            \"EndLine\": 39,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 27,\n                  \"Content\": \"        - name: wait-for-chromadb\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: wait-for-chromadb\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"          image: busybox:1.36\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage\\u001b[0m: busybox:1.36\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"            runAsNonRoot: true\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot\\u001b[0m: \\u001b[38;5;166mtrue\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"            runAsUser: 10001\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsUser\\u001b[0m: \\u001b[38;5;37m10001\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            allowPrivilegeEscalation: false\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mallowPrivilegeEscalation\\u001b[0m: \\u001b[38;5;166mfalse\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 34,\n                  \"Content\": \"              drop:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33mdrop\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 35,\n                  \"Content\": \"                - ALL\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"                - ALL\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV014\",\n          \"AVDID\": \"AVD-KSV-0014\",\n          \"Title\": \"Root file system is not read-only\",\n          \"Description\": \"An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.\",\n          \"Message\": \"Container 'rag-sync' of Deployment 'portfolio-api' should set 'securityContext.readOnlyRootFilesystem' to true\",\n          \"Namespace\": \"builtin.kubernetes.KSV014\",\n          \"Query\": \"data.builtin.kubernetes.KSV014.deny\",\n          \"Resolution\": \"Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv014\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/\",\n            \"https://avd.aquasec.com/misconfig/ksv014\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 51,\n            \"EndLine\": 156,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 51,\n                  \"Content\": \"        - name: rag-sync\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: rag-sync\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 52,\n                  \"Content\": \"          image: python:3.11-slim\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage\\u001b[0m: python:3.11-slim\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 53,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 54,\n                  \"Content\": \"            runAsNonRoot: true\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot\\u001b[0m: \\u001b[38;5;166mtrue\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 55,\n                  \"Content\": \"            runAsUser: 10001\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsUser\\u001b[0m: \\u001b[38;5;37m10001\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 56,\n                  \"Content\": \"            allowPrivilegeEscalation: false\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mallowPrivilegeEscalation\\u001b[0m: \\u001b[38;5;166mfalse\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 57,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 58,\n                  \"Content\": \"              drop:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33mdrop\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 59,\n                  \"Content\": \"                - ALL\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"                - ALL\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 60,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV014\",\n          \"AVDID\": \"AVD-KSV-0014\",\n          \"Title\": \"Root file system is not read-only\",\n          \"Description\": \"An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.\",\n          \"Message\": \"Container 'wait-for-chromadb' of Deployment 'portfolio-api' should set 'securityContext.readOnlyRootFilesystem' to true\",\n          \"Namespace\": \"builtin.kubernetes.KSV014\",\n          \"Query\": \"data.builtin.kubernetes.KSV014.deny\",\n          \"Resolution\": \"Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv014\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/\",\n            \"https://avd.aquasec.com/misconfig/ksv014\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 27,\n            \"EndLine\": 39,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 27,\n                  \"Content\": \"        - name: wait-for-chromadb\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: wait-for-chromadb\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"          image: busybox:1.36\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage\\u001b[0m: busybox:1.36\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"            runAsNonRoot: true\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot\\u001b[0m: \\u001b[38;5;166mtrue\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"            runAsUser: 10001\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsUser\\u001b[0m: \\u001b[38;5;37m10001\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            allowPrivilegeEscalation: false\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mallowPrivilegeEscalation\\u001b[0m: \\u001b[38;5;166mfalse\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 34,\n                  \"Content\": \"              drop:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33mdrop\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 35,\n                  \"Content\": \"                - ALL\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"                - ALL\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV015\",\n          \"AVDID\": \"AVD-KSV-0015\",\n          \"Title\": \"CPU requests not specified\",\n          \"Description\": \"When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.\",\n          \"Message\": \"Container 'wait-for-chromadb' of Deployment 'portfolio-api' should set 'resources.requests.cpu'\",\n          \"Namespace\": \"builtin.kubernetes.KSV015\",\n          \"Query\": \"data.builtin.kubernetes.KSV015.deny\",\n          \"Resolution\": \"Set 'containers[].resources.requests.cpu'.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv015\",\n          \"References\": [\n            \"https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits\",\n            \"https://avd.aquasec.com/misconfig/ksv015\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 27,\n            \"EndLine\": 39,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 27,\n                  \"Content\": \"        - name: wait-for-chromadb\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: wait-for-chromadb\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"          image: busybox:1.36\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage\\u001b[0m: busybox:1.36\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"            runAsNonRoot: true\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot\\u001b[0m: \\u001b[38;5;166mtrue\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"            runAsUser: 10001\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsUser\\u001b[0m: \\u001b[38;5;37m10001\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            allowPrivilegeEscalation: false\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mallowPrivilegeEscalation\\u001b[0m: \\u001b[38;5;166mfalse\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 34,\n                  \"Content\": \"              drop:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33mdrop\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 35,\n                  \"Content\": \"                - ALL\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"                - ALL\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV016\",\n          \"AVDID\": \"AVD-KSV-0016\",\n          \"Title\": \"Memory requests not specified\",\n          \"Description\": \"When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.\",\n          \"Message\": \"Container 'wait-for-chromadb' of Deployment 'portfolio-api' should set 'resources.requests.memory'\",\n          \"Namespace\": \"builtin.kubernetes.KSV016\",\n          \"Query\": \"data.builtin.kubernetes.KSV016.deny\",\n          \"Resolution\": \"Set 'containers[].resources.requests.memory'.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv016\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-resources-limits-memory/\",\n            \"https://avd.aquasec.com/misconfig/ksv016\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 27,\n            \"EndLine\": 39,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 27,\n                  \"Content\": \"        - name: wait-for-chromadb\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: wait-for-chromadb\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"          image: busybox:1.36\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage\\u001b[0m: busybox:1.36\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"            runAsNonRoot: true\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot\\u001b[0m: \\u001b[38;5;166mtrue\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"            runAsUser: 10001\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsUser\\u001b[0m: \\u001b[38;5;37m10001\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            allowPrivilegeEscalation: false\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mallowPrivilegeEscalation\\u001b[0m: \\u001b[38;5;166mfalse\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 34,\n                  \"Content\": \"              drop:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33mdrop\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 35,\n                  \"Content\": \"                - ALL\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"                - ALL\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV018\",\n          \"AVDID\": \"AVD-KSV-0018\",\n          \"Title\": \"Memory not limited\",\n          \"Description\": \"Enforcing memory limits prevents DoS via resource exhaustion.\",\n          \"Message\": \"Container 'wait-for-chromadb' of Deployment 'portfolio-api' should set 'resources.limits.memory'\",\n          \"Namespace\": \"builtin.kubernetes.KSV018\",\n          \"Query\": \"data.builtin.kubernetes.KSV018.deny\",\n          \"Resolution\": \"Set a limit value under 'containers[].resources.limits.memory'.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv018\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-resources-limits-memory/\",\n            \"https://avd.aquasec.com/misconfig/ksv018\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 27,\n            \"EndLine\": 39,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 27,\n                  \"Content\": \"        - name: wait-for-chromadb\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: wait-for-chromadb\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"          image: busybox:1.36\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage\\u001b[0m: busybox:1.36\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"            runAsNonRoot: true\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot\\u001b[0m: \\u001b[38;5;166mtrue\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"            runAsUser: 10001\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsUser\\u001b[0m: \\u001b[38;5;37m10001\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            allowPrivilegeEscalation: false\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mallowPrivilegeEscalation\\u001b[0m: \\u001b[38;5;166mfalse\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 34,\n                  \"Content\": \"              drop:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33mdrop\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 35,\n                  \"Content\": \"                - ALL\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"                - ALL\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV021\",\n          \"AVDID\": \"AVD-KSV-0021\",\n          \"Title\": \"Runs with GID \\u003c= 10000\",\n          \"Description\": \"Force the container to run with group ID \\u003e 10000 to avoid conflicts with the host\u2019s user table.\",\n          \"Message\": \"Container 'rag-sync' of Deployment 'portfolio-api' should set 'securityContext.runAsGroup' \\u003e 10000\",\n          \"Namespace\": \"builtin.kubernetes.KSV021\",\n          \"Query\": \"data.builtin.kubernetes.KSV021.deny\",\n          \"Resolution\": \"Set 'containers[].securityContext.runAsGroup' to an integer \\u003e 10000.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv021\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-runasuser/\",\n            \"https://avd.aquasec.com/misconfig/ksv021\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 51,\n            \"EndLine\": 156,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 51,\n                  \"Content\": \"        - name: rag-sync\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: rag-sync\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 52,\n                  \"Content\": \"          image: python:3.11-slim\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage\\u001b[0m: python:3.11-slim\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 53,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 54,\n                  \"Content\": \"            runAsNonRoot: true\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot\\u001b[0m: \\u001b[38;5;166mtrue\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 55,\n                  \"Content\": \"            runAsUser: 10001\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsUser\\u001b[0m: \\u001b[38;5;37m10001\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 56,\n                  \"Content\": \"            allowPrivilegeEscalation: false\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mallowPrivilegeEscalation\\u001b[0m: \\u001b[38;5;166mfalse\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 57,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 58,\n                  \"Content\": \"              drop:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33mdrop\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 59,\n                  \"Content\": \"                - ALL\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"                - ALL\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 60,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV021\",\n          \"AVDID\": \"AVD-KSV-0021\",\n          \"Title\": \"Runs with GID \\u003c= 10000\",\n          \"Description\": \"Force the container to run with group ID \\u003e 10000 to avoid conflicts with the host\u2019s user table.\",\n          \"Message\": \"Container 'wait-for-chromadb' of Deployment 'portfolio-api' should set 'securityContext.runAsGroup' \\u003e 10000\",\n          \"Namespace\": \"builtin.kubernetes.KSV021\",\n          \"Query\": \"data.builtin.kubernetes.KSV021.deny\",\n          \"Resolution\": \"Set 'containers[].securityContext.runAsGroup' to an integer \\u003e 10000.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv021\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-runasuser/\",\n            \"https://avd.aquasec.com/misconfig/ksv021\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 27,\n            \"EndLine\": 39,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 27,\n                  \"Content\": \"        - name: wait-for-chromadb\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m        - \\u001b[38;5;33mname\\u001b[0m: wait-for-chromadb\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"          image: busybox:1.36\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33mimage\\u001b[0m: busybox:1.36\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"          securityContext:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;33msecurityContext\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"            runAsNonRoot: true\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"            \\u001b[38;5;33mrunAsNonRoot\\u001b[0m: \\u001b[38;5;166mtrue\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"            runAsUser: 10001\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mrunAsUser\\u001b[0m: \\u001b[38;5;37m10001\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"            allowPrivilegeEscalation: false\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mallowPrivilegeEscalation\\u001b[0m: \\u001b[38;5;166mfalse\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"            capabilities:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m            \\u001b[38;5;33mcapabilities\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 34,\n                  \"Content\": \"              drop:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"              \\u001b[38;5;33mdrop\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 35,\n                  \"Content\": \"                - ALL\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"                - ALL\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        }\n      ]\n    },\n    {\n      \"Target\": \"infrastructure/method1-simple-kubectl/06-ui-deployment.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 1,\n        \"Exceptions\": 0\n      },\n      \"Misconfigurations\": [\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV117\",\n          \"AVDID\": \"AVD-KSV-0117\",\n          \"Title\": \"Prevent binding to privileged ports\",\n          \"Description\": \"The ports which are lower than 1024 receive and transmit various sensitive and privileged data. Allowing containers to use them can bring serious implications.\",\n          \"Message\": \"deployment portfolio-ui in portfolio namespace should not set spec.template.spec.containers.ports.containerPort to less than 1024\",\n          \"Namespace\": \"builtin.kubernetes.KSV117\",\n          \"Query\": \"data.builtin.kubernetes.KSV117.deny\",\n          \"Resolution\": \"Do not map the container ports to privileged host ports when starting a container.\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv117\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/pod-security-standards/\",\n            \"https://avd.aquasec.com/misconfig/ksv117\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"Code\": {\n              \"Lines\": null\n            }\n          }\n        }\n      ]\n    },\n    {\n      \"Target\": \"infrastructure/method1-simple-kubectl/07-ingress.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method1-simple-kubectl/k8s-security/network-policies/allow-dns.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method1-simple-kubectl/k8s-security/network-policies/default-deny-all.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method1-simple-kubectl/k8s-security/pod-security/security-standards.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method1-simple-kubectl/k8s-security/rbac/role-bindings.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method1-simple-kubectl/k8s-security/rbac/roles.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 156,\n        \"Failures\": 1,\n        \"Exceptions\": 0\n      },\n      \"Misconfigurations\": [\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV113\",\n          \"AVDID\": \"AVD-KSV-0113\",\n          \"Title\": \"Manage namespace secrets\",\n          \"Description\": \"Viewing secrets at the namespace scope can lead to escalation if another service account in that namespace has a higher privileged rolebinding or clusterrolebinding bound.\",\n          \"Message\": \"Role 'app-role' shouldn't have access to manage secrets in namespace 'default'\",\n          \"Namespace\": \"builtin.kubernetes.KSV113\",\n          \"Query\": \"data.builtin.kubernetes.KSV113.deny\",\n          \"Resolution\": \"Manage namespace secrets are not allowed. Remove resource 'secrets' from role\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv113\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/rbac-good-practices/\",\n            \"https://avd.aquasec.com/misconfig/ksv113\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 7,\n            \"EndLine\": 14,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 7,\n                  \"Content\": \"- apiGroups:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"- \\u001b[38;5;33mapiGroups\\u001b[0m:\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 8,\n                  \"Content\": \"  - ''\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  - \\u001b[38;5;37m''\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 9,\n                  \"Content\": \"  resources:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;33mresources\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 10,\n                  \"Content\": \"  - configmaps\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  - configmaps\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 11,\n                  \"Content\": \"  - secrets\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  - secrets\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 12,\n                  \"Content\": \"  verbs:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;33mverbs\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 13,\n                  \"Content\": \"  - get\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  - get\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 14,\n                  \"Content\": \"  - list\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  - list\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        }\n      ]\n    },\n    {\n      \"Target\": \"infrastructure/method1-simple-kubectl/k8s-security/rbac/service-accounts.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method2-terraform-localstack/s0-shared-mods/cloudflare-tunnel\",\n      \"Class\": \"config\",\n      \"Type\": \"terraform\",\n      \"MisconfSummary\": {\n        \"Successes\": 1,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf\",\n      \"Class\": \"config\",\n      \"Type\": \"terraform\",\n      \"MisconfSummary\": {\n        \"Successes\": 15,\n        \"Failures\": 3,\n        \"Exceptions\": 0\n      },\n      \"Misconfigurations\": [\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-KUBE-0001\",\n          \"AVDID\": \"AVD-KUBE-0001\",\n          \"Title\": \"Public ingress should not be allowed via network policies\",\n          \"Description\": \"You should not expose infrastructure to the public internet except where explicitly required\",\n          \"Message\": \"Network policy allows ingress from the public internet.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Remove public access except where explicitly required\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-kube-0001\",\n          \"References\": [\n            \"https://avd.aquasec.com/misconfig/avd-kube-0001\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.kubernetes_app\",\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"network\",\n            \"StartLine\": 85,\n            \"EndLine\": 85,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 66,\n                  \"Content\": \"resource \\\"kubernetes_network_policy\\\" \\\"ui_ingress\\\" {\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"kubernetes_network_policy\\\"\\u001b[0m \\u001b[38;5;37m\\\"ui_ingress\\\"\\u001b[0m {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 67,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 85,\n                  \"Content\": \"          cidr = \\\"0.0.0.0/0\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\\\"0.0.0.0/0\\\"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;245mcidr\\u001b[0m = \\u001b[38;5;37m\\\"0.0.0.0/0\\\"\",\n                  \"FirstCause\": true,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 94,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 95,\n                  \"Content\": \"}\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"ip_block\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf\",\n                \"Location\": {\n                  \"StartLine\": 84,\n                  \"EndLine\": 86\n                }\n              },\n              {\n                \"Resource\": \"from\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf\",\n                \"Location\": {\n                  \"StartLine\": 82,\n                  \"EndLine\": 87\n                }\n              },\n              {\n                \"Resource\": \"ingress\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf\",\n                \"Location\": {\n                  \"StartLine\": 81,\n                  \"EndLine\": 93\n                }\n              },\n              {\n                \"Resource\": \"spec\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 94\n                }\n              },\n              {\n                \"Resource\": \"kubernetes_network_policy.ui_ingress\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf\",\n                \"Location\": {\n                  \"StartLine\": 66,\n                  \"EndLine\": 95\n                }\n              },\n              {\n                \"Resource\": \"module.kubernetes_app\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 63,\n                  \"EndLine\": 88\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-KUBE-0001\",\n          \"AVDID\": \"AVD-KUBE-0001\",\n          \"Title\": \"Public ingress should not be allowed via network policies\",\n          \"Description\": \"You should not expose infrastructure to the public internet except where explicitly required\",\n          \"Message\": \"Network policy allows ingress from the public internet.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Remove public access except where explicitly required\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-kube-0001\",\n          \"References\": [\n            \"https://avd.aquasec.com/misconfig/avd-kube-0001\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.kubernetes_app\",\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"network\",\n            \"StartLine\": 85,\n            \"EndLine\": 85,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 66,\n                  \"Content\": \"resource \\\"kubernetes_network_policy\\\" \\\"ui_ingress\\\" {\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"kubernetes_network_policy\\\"\\u001b[0m \\u001b[38;5;37m\\\"ui_ingress\\\"\\u001b[0m {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 67,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 85,\n                  \"Content\": \"          cidr = \\\"0.0.0.0/0\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\\\"0.0.0.0/0\\\"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;245mcidr\\u001b[0m = \\u001b[38;5;37m\\\"0.0.0.0/0\\\"\",\n                  \"FirstCause\": true,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 94,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 95,\n                  \"Content\": \"}\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"ip_block\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf\",\n                \"Location\": {\n                  \"StartLine\": 84,\n                  \"EndLine\": 86\n                }\n              },\n              {\n                \"Resource\": \"from\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf\",\n                \"Location\": {\n                  \"StartLine\": 82,\n                  \"EndLine\": 87\n                }\n              },\n              {\n                \"Resource\": \"ingress\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf\",\n                \"Location\": {\n                  \"StartLine\": 81,\n                  \"EndLine\": 93\n                }\n              },\n              {\n                \"Resource\": \"spec\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 94\n                }\n              },\n              {\n                \"Resource\": \"kubernetes_network_policy.ui_ingress\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf\",\n                \"Location\": {\n                  \"StartLine\": 66,\n                  \"EndLine\": 95\n                }\n              },\n              {\n                \"Resource\": \"module.kubernetes_app\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 46,\n                  \"EndLine\": 66\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-KUBE-0001\",\n          \"AVDID\": \"AVD-KUBE-0001\",\n          \"Title\": \"Public ingress should not be allowed via network policies\",\n          \"Description\": \"You should not expose infrastructure to the public internet except where explicitly required\",\n          \"Message\": \"Network policy allows ingress from the public internet.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Remove public access except where explicitly required\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-kube-0001\",\n          \"References\": [\n            \"https://avd.aquasec.com/misconfig/avd-kube-0001\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.portfolio\",\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"network\",\n            \"StartLine\": 85,\n            \"EndLine\": 85,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 66,\n                  \"Content\": \"resource \\\"kubernetes_network_policy\\\" \\\"ui_ingress\\\" {\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"kubernetes_network_policy\\\"\\u001b[0m \\u001b[38;5;37m\\\"ui_ingress\\\"\\u001b[0m {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 67,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 85,\n                  \"Content\": \"          cidr = \\\"0.0.0.0/0\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\\\"0.0.0.0/0\\\"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"          \\u001b[38;5;245mcidr\\u001b[0m = \\u001b[38;5;37m\\\"0.0.0.0/0\\\"\",\n                  \"FirstCause\": true,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 94,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 95,\n                  \"Content\": \"}\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"ip_block\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf\",\n                \"Location\": {\n                  \"StartLine\": 84,\n                  \"EndLine\": 86\n                }\n              },\n              {\n                \"Resource\": \"from\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf\",\n                \"Location\": {\n                  \"StartLine\": 82,\n                  \"EndLine\": 87\n                }\n              },\n              {\n                \"Resource\": \"ingress\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf\",\n                \"Location\": {\n                  \"StartLine\": 81,\n                  \"EndLine\": 93\n                }\n              },\n              {\n                \"Resource\": \"spec\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 94\n                }\n              },\n              {\n                \"Resource\": \"kubernetes_network_policy.ui_ingress\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s0-shared-mods/portfolio-app/network-policies.tf\",\n                \"Location\": {\n                  \"StartLine\": 66,\n                  \"EndLine\": 95\n                }\n              },\n              {\n                \"Resource\": \"module.portfolio\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s1-terraform-simple/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 57,\n                  \"EndLine\": 78\n                }\n              }\n            ]\n          }\n        }\n      ]\n    },\n    {\n      \"Target\": \"infrastructure/method2-terraform-localstack/s1-terraform-simple\",\n      \"Class\": \"config\",\n      \"Type\": \"terraform\",\n      \"MisconfSummary\": {\n        \"Successes\": 1,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack\",\n      \"Class\": \"config\",\n      \"Type\": \"terraform\",\n      \"MisconfSummary\": {\n        \"Successes\": 2,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/modules/aws-resources/lambda\",\n      \"Class\": \"config\",\n      \"Type\": \"terraform\",\n      \"MisconfSummary\": {\n        \"Successes\": 1,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/modules/aws-resources/lambda/main.tf\",\n      \"Class\": \"config\",\n      \"Type\": \"terraform\",\n      \"MisconfSummary\": {\n        \"Successes\": 0,\n        \"Failures\": 2,\n        \"Exceptions\": 0\n      },\n      \"Misconfigurations\": [\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0017\",\n          \"AVDID\": \"AVD-AWS-0017\",\n          \"Title\": \"CloudWatch log groups should be encrypted using CMK\",\n          \"Description\": \"CloudWatch log groups are encrypted by default, however, to get the full benefit of controlling key rotation and other KMS aspects a KMS CMK should be used.\",\n          \"Message\": \"Log group is not encrypted.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable CMK encryption of CloudWatch Log Groups\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0017\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0017\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"aws_cloudwatch_log_group.lambda_chat\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"cloudwatch\",\n            \"StartLine\": 88,\n            \"EndLine\": 97,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 88,\n                  \"Content\": \"resource \\\"aws_cloudwatch_log_group\\\" \\\"lambda_chat\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_cloudwatch_log_group\\\"\\u001b[0m \\u001b[38;5;37m\\\"lambda_chat\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 89,\n                  \"Content\": \"  name              = \\\"/aws/lambda/${aws_lambda_function.chat_handler.function_name}\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m              = \\u001b[38;5;37m\\\"/aws/lambda/\\u001b[0m\\u001b[38;5;37m${\\u001b[0maws_lambda_function.chat_handler.function_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 90,\n                  \"Content\": \"  retention_in_days = 7\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mretention_in_days\\u001b[0m = \\u001b[38;5;37m7\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 91,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 92,\n                  \"Content\": \"  tags = {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m = {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 93,\n                  \"Content\": \"    Project     = var.project_name\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mProject\\u001b[0m     = \\u001b[38;5;33mvar\\u001b[0m.project_name\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 94,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 95,\n                  \"Content\": \"    Function    = \\\"chat-handler\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mFunction\\u001b[0m    = \\u001b[38;5;37m\\\"chat-handler\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 96,\n                  \"Content\": \"  }\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  }\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 97,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0066\",\n          \"AVDID\": \"AVD-AWS-0066\",\n          \"Title\": \"Lambda functions should have X-Ray tracing enabled\",\n          \"Description\": \"X-Ray tracing enables end-to-end debugging and analysis of all function activity. This will allow for identifying bottlenecks, slow downs and timeouts.\",\n          \"Message\": \"Function does not have tracing enabled.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable tracing\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0066\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/lambda/latest/dg/services-xray.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0066\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"aws_lambda_function.chat_handler\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"lambda\",\n            \"StartLine\": 57,\n            \"EndLine\": 82,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 57,\n                  \"Content\": \"resource \\\"aws_lambda_function\\\" \\\"chat_handler\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_lambda_function\\\"\\u001b[0m \\u001b[38;5;37m\\\"chat_handler\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 58,\n                  \"Content\": \"  filename      = \\\"${path.module}/../../../lambda-functions/chat-handler.zip\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mfilename\\u001b[0m      = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0mpath.\\u001b[38;5;33mmodule\\u001b[0m\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m/../../../lambda-functions/chat-handler.zip\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 59,\n                  \"Content\": \"  function_name = \\\"${var.project_name}-chat-handler\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mfunction_name\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-chat-handler\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 60,\n                  \"Content\": \"  role          = aws_iam_role.lambda_exec.arn\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mrole\\u001b[0m          = aws_iam_role.lambda_exec.arn\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 61,\n                  \"Content\": \"  handler       = \\\"lambda_function.lambda_handler\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mhandler\\u001b[0m       = \\u001b[38;5;37m\\\"lambda_function.lambda_handler\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 62,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 63,\n                  \"Content\": \"  source_code_hash = filebase64sha256(\\\"${path.module}/../../../lambda-functions/chat-handler.zip\\\")\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245msource_code_hash\\u001b[0m = \\u001b[38;5;33mfilebase64sha256\\u001b[0m(\\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0mpath.\\u001b[38;5;33mmodule\\u001b[0m\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m/../../../lambda-functions/chat-handler.zip\\\"\\u001b[0m)\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 64,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 65,\n                  \"Content\": \"  runtime = \\\"python3.11\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mruntime\\u001b[0m = \\u001b[38;5;37m\\\"python3.11\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 66,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        }\n      ]\n    },\n    {\n      \"Target\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/modules/aws-resources/secrets\",\n      \"Class\": \"config\",\n      \"Type\": \"terraform\",\n      \"MisconfSummary\": {\n        \"Successes\": 1,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/modules/aws-resources/secrets/main.tf\",\n      \"Class\": \"config\",\n      \"Type\": \"terraform\",\n      \"MisconfSummary\": {\n        \"Successes\": 1,\n        \"Failures\": 6,\n        \"Exceptions\": 0\n      },\n      \"Misconfigurations\": [\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0057\",\n          \"AVDID\": \"AVD-AWS-0057\",\n          \"Title\": \"IAM policy should avoid use of wildcards and instead apply the principle of least privilege\",\n          \"Description\": \"You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.\",\n          \"Message\": \"IAM policy document uses sensitive action 'logs:CreateLogStream' on wildcarded resource 'arn:aws:logs:*:*:*'\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Specify the exact permissions required, and to which resources they should apply instead of using wildcards.\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0057\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0057\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"data.aws_iam_policy_document.lambda_secrets_access\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"iam\",\n            \"StartLine\": 155,\n            \"EndLine\": 155,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 126,\n                  \"Content\": \"data \\\"aws_iam_policy_document\\\" \\\"lambda_secrets_access\\\" {\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mdata\\u001b[0m \\u001b[38;5;37m\\\"aws_iam_policy_document\\\"\\u001b[0m \\u001b[38;5;37m\\\"lambda_secrets_access\\\"\\u001b[0m {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 127,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 155,\n                  \"Content\": \"    resources = [\\\"arn:aws:logs:*:*:*\\\"]\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mresources\\u001b[0m = [\\u001b[38;5;37m\\\"arn:aws:logs:*:*:*\\\"\\u001b[0m]\",\n                  \"FirstCause\": true,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 156,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 157,\n                  \"Content\": \"}\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"data.aws_iam_policy_document.lambda_secrets_access\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/modules/aws-resources/secrets/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 145,\n                  \"EndLine\": 156\n                }\n              },\n              {\n                \"Resource\": \"data.aws_iam_policy_document.lambda_secrets_access\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/modules/aws-resources/secrets/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 126,\n                  \"EndLine\": 157\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0098\",\n          \"AVDID\": \"AVD-AWS-0098\",\n          \"Title\": \"Secrets Manager should use customer managed keys\",\n          \"Description\": \"Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.\",\n          \"Message\": \"Secret explicitly uses the default key.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Use customer managed keys\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0098\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0098\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"aws_secretsmanager_secret.claude_api_key\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"ssm\",\n            \"StartLine\": 17,\n            \"EndLine\": 27,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 17,\n                  \"Content\": \"resource \\\"aws_secretsmanager_secret\\\" \\\"claude_api_key\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_secretsmanager_secret\\\"\\u001b[0m \\u001b[38;5;37m\\\"claude_api_key\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 18,\n                  \"Content\": \"  name        = \\\"${var.project_name}/claude-api-key\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m/claude-api-key\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"  description = \\\"Anthropic Claude API key for LLM chat completions\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mdescription\\u001b[0m = \\u001b[38;5;37m\\\"Anthropic Claude API key for LLM chat completions\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"  tags = {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m = {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"    Project     = var.project_name\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mProject\\u001b[0m     = \\u001b[38;5;33mvar\\u001b[0m.project_name\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 24,\n                  \"Content\": \"    ManagedBy   = \\\"terraform\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mManagedBy\\u001b[0m   = \\u001b[38;5;37m\\\"terraform\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 25,\n                  \"Content\": \"    Service     = \\\"llm\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mService\\u001b[0m     = \\u001b[38;5;37m\\\"llm\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0098\",\n          \"AVDID\": \"AVD-AWS-0098\",\n          \"Title\": \"Secrets Manager should use customer managed keys\",\n          \"Description\": \"Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.\",\n          \"Message\": \"Secret explicitly uses the default key.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Use customer managed keys\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0098\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0098\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"aws_secretsmanager_secret.database_credentials\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"ssm\",\n            \"StartLine\": 101,\n            \"EndLine\": 111,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 101,\n                  \"Content\": \"resource \\\"aws_secretsmanager_secret\\\" \\\"database_credentials\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_secretsmanager_secret\\\"\\u001b[0m \\u001b[38;5;37m\\\"database_credentials\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 102,\n                  \"Content\": \"  name        = \\\"${var.project_name}/database-credentials\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m/database-credentials\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 103,\n                  \"Content\": \"  description = \\\"ChromaDB connection credentials\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mdescription\\u001b[0m = \\u001b[38;5;37m\\\"ChromaDB connection credentials\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 104,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 105,\n                  \"Content\": \"  tags = {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m = {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 106,\n                  \"Content\": \"    Project     = var.project_name\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mProject\\u001b[0m     = \\u001b[38;5;33mvar\\u001b[0m.project_name\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 107,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 108,\n                  \"Content\": \"    ManagedBy   = \\\"terraform\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mManagedBy\\u001b[0m   = \\u001b[38;5;37m\\\"terraform\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 109,\n                  \"Content\": \"    Service     = \\\"database\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mService\\u001b[0m     = \\u001b[38;5;37m\\\"database\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 110,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0098\",\n          \"AVDID\": \"AVD-AWS-0098\",\n          \"Title\": \"Secrets Manager should use customer managed keys\",\n          \"Description\": \"Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.\",\n          \"Message\": \"Secret explicitly uses the default key.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Use customer managed keys\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0098\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0098\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"aws_secretsmanager_secret.did_api_key\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"ssm\",\n            \"StartLine\": 80,\n            \"EndLine\": 90,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 80,\n                  \"Content\": \"resource \\\"aws_secretsmanager_secret\\\" \\\"did_api_key\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_secretsmanager_secret\\\"\\u001b[0m \\u001b[38;5;37m\\\"did_api_key\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 81,\n                  \"Content\": \"  name        = \\\"${var.project_name}/did-api-key\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m/did-api-key\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 82,\n                  \"Content\": \"  description = \\\"D-ID API key for avatar generation\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mdescription\\u001b[0m = \\u001b[38;5;37m\\\"D-ID API key for avatar generation\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 83,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 84,\n                  \"Content\": \"  tags = {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m = {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 85,\n                  \"Content\": \"    Project     = var.project_name\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mProject\\u001b[0m     = \\u001b[38;5;33mvar\\u001b[0m.project_name\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 86,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 87,\n                  \"Content\": \"    ManagedBy   = \\\"terraform\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mManagedBy\\u001b[0m   = \\u001b[38;5;37m\\\"terraform\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 88,\n                  \"Content\": \"    Service     = \\\"avatar\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mService\\u001b[0m     = \\u001b[38;5;37m\\\"avatar\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 89,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0098\",\n          \"AVDID\": \"AVD-AWS-0098\",\n          \"Title\": \"Secrets Manager should use customer managed keys\",\n          \"Description\": \"Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.\",\n          \"Message\": \"Secret explicitly uses the default key.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Use customer managed keys\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0098\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0098\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"aws_secretsmanager_secret.elevenlabs_api_key\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"ssm\",\n            \"StartLine\": 59,\n            \"EndLine\": 69,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 59,\n                  \"Content\": \"resource \\\"aws_secretsmanager_secret\\\" \\\"elevenlabs_api_key\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_secretsmanager_secret\\\"\\u001b[0m \\u001b[38;5;37m\\\"elevenlabs_api_key\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 60,\n                  \"Content\": \"  name        = \\\"${var.project_name}/elevenlabs-api-key\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m/elevenlabs-api-key\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 61,\n                  \"Content\": \"  description = \\\"ElevenLabs API key for voice synthesis\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mdescription\\u001b[0m = \\u001b[38;5;37m\\\"ElevenLabs API key for voice synthesis\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 62,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 63,\n                  \"Content\": \"  tags = {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m = {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 64,\n                  \"Content\": \"    Project     = var.project_name\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mProject\\u001b[0m     = \\u001b[38;5;33mvar\\u001b[0m.project_name\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 65,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 66,\n                  \"Content\": \"    ManagedBy   = \\\"terraform\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mManagedBy\\u001b[0m   = \\u001b[38;5;37m\\\"terraform\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 67,\n                  \"Content\": \"    Service     = \\\"voice\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mService\\u001b[0m     = \\u001b[38;5;37m\\\"voice\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 68,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0098\",\n          \"AVDID\": \"AVD-AWS-0098\",\n          \"Title\": \"Secrets Manager should use customer managed keys\",\n          \"Description\": \"Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.\",\n          \"Message\": \"Secret explicitly uses the default key.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Use customer managed keys\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0098\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0098\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"aws_secretsmanager_secret.openai_api_key\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"ssm\",\n            \"StartLine\": 38,\n            \"EndLine\": 48,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 38,\n                  \"Content\": \"resource \\\"aws_secretsmanager_secret\\\" \\\"openai_api_key\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_secretsmanager_secret\\\"\\u001b[0m \\u001b[38;5;37m\\\"openai_api_key\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 39,\n                  \"Content\": \"  name        = \\\"${var.project_name}/openai-api-key\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m/openai-api-key\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 40,\n                  \"Content\": \"  description = \\\"OpenAI API key for fallback LLM and embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mdescription\\u001b[0m = \\u001b[38;5;37m\\\"OpenAI API key for fallback LLM and embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 41,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 42,\n                  \"Content\": \"  tags = {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m = {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 43,\n                  \"Content\": \"    Project     = var.project_name\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mProject\\u001b[0m     = \\u001b[38;5;33mvar\\u001b[0m.project_name\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 44,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 45,\n                  \"Content\": \"    ManagedBy   = \\\"terraform\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mManagedBy\\u001b[0m   = \\u001b[38;5;37m\\\"terraform\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 46,\n                  \"Content\": \"    Service     = \\\"llm\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mService\\u001b[0m     = \\u001b[38;5;37m\\\"llm\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 47,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            }\n          }\n        }\n      ]\n    },\n    {\n      \"Target\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/modules/aws-resources/storage/kms.tf\",\n      \"Class\": \"config\",\n      \"Type\": \"terraform\",\n      \"MisconfSummary\": {\n        \"Successes\": 1,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/modules/aws-resources/storage/main.tf\",\n      \"Class\": \"config\",\n      \"Type\": \"terraform\",\n      \"MisconfSummary\": {\n        \"Successes\": 20,\n        \"Failures\": 70,\n        \"Exceptions\": 0\n      },\n      \"Misconfigurations\": [\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0024\",\n          \"AVDID\": \"AVD-AWS-0024\",\n          \"Title\": \"Point in time recovery should be enabled to protect DynamoDB table\",\n          \"Description\": \"DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\\n\\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.\",\n          \"Message\": \"Point-in-time recovery is not enabled.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable point in time recovery\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0024\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0024\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"dynamodb\",\n            \"StartLine\": 150,\n            \"EndLine\": 191,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 150,\n                  \"Content\": \"resource \\\"aws_dynamodb_table\\\" \\\"ingestion_jobs\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_dynamodb_table\\\"\\u001b[0m \\u001b[38;5;37m\\\"ingestion_jobs\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 151,\n                  \"Content\": \"  name           = \\\"${var.project_name}-ingestion-jobs\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m           = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-ingestion-jobs\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 152,\n                  \"Content\": \"  billing_mode   = \\\"PAY_PER_REQUEST\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mbilling_mode\\u001b[0m   = \\u001b[38;5;37m\\\"PAY_PER_REQUEST\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 153,\n                  \"Content\": \"  hash_key       = \\\"job_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mhash_key\\u001b[0m       = \\u001b[38;5;37m\\\"job_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 154,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 155,\n                  \"Content\": \"  attribute {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  attribute {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 156,\n                  \"Content\": \"    name = \\\"job_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mname\\u001b[0m = \\u001b[38;5;37m\\\"job_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 157,\n                  \"Content\": \"    type = \\\"S\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mtype\\u001b[0m = \\u001b[38;5;37m\\\"S\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 158,\n                  \"Content\": \"  }\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  }\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 159,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0024\",\n          \"AVDID\": \"AVD-AWS-0024\",\n          \"Title\": \"Point in time recovery should be enabled to protect DynamoDB table\",\n          \"Description\": \"DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\\n\\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.\",\n          \"Message\": \"Point-in-time recovery is not enabled.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable point in time recovery\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0024\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0024\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"dynamodb\",\n            \"StartLine\": 150,\n            \"EndLine\": 191,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 150,\n                  \"Content\": \"resource \\\"aws_dynamodb_table\\\" \\\"ingestion_jobs\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_dynamodb_table\\\"\\u001b[0m \\u001b[38;5;37m\\\"ingestion_jobs\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 151,\n                  \"Content\": \"  name           = \\\"${var.project_name}-ingestion-jobs\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m           = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-ingestion-jobs\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 152,\n                  \"Content\": \"  billing_mode   = \\\"PAY_PER_REQUEST\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mbilling_mode\\u001b[0m   = \\u001b[38;5;37m\\\"PAY_PER_REQUEST\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 153,\n                  \"Content\": \"  hash_key       = \\\"job_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mhash_key\\u001b[0m       = \\u001b[38;5;37m\\\"job_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 154,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 155,\n                  \"Content\": \"  attribute {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  attribute {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 156,\n                  \"Content\": \"    name = \\\"job_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mname\\u001b[0m = \\u001b[38;5;37m\\\"job_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 157,\n                  \"Content\": \"    type = \\\"S\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mtype\\u001b[0m = \\u001b[38;5;37m\\\"S\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 158,\n                  \"Content\": \"  }\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  }\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 159,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0024\",\n          \"AVDID\": \"AVD-AWS-0024\",\n          \"Title\": \"Point in time recovery should be enabled to protect DynamoDB table\",\n          \"Description\": \"DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\\n\\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.\",\n          \"Message\": \"Point-in-time recovery is not enabled.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable point in time recovery\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0024\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0024\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"dynamodb\",\n            \"StartLine\": 105,\n            \"EndLine\": 147,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 105,\n                  \"Content\": \"resource \\\"aws_dynamodb_table\\\" \\\"embedding_chunks\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_dynamodb_table\\\"\\u001b[0m \\u001b[38;5;37m\\\"embedding_chunks\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 106,\n                  \"Content\": \"  name           = \\\"${var.project_name}-embedding-chunks\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m           = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embedding-chunks\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 107,\n                  \"Content\": \"  billing_mode   = \\\"PAY_PER_REQUEST\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mbilling_mode\\u001b[0m   = \\u001b[38;5;37m\\\"PAY_PER_REQUEST\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 108,\n                  \"Content\": \"  hash_key       = \\\"chunk_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mhash_key\\u001b[0m       = \\u001b[38;5;37m\\\"chunk_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 109,\n                  \"Content\": \"  range_key      = \\\"document_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mrange_key\\u001b[0m      = \\u001b[38;5;37m\\\"document_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 110,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 111,\n                  \"Content\": \"  attribute {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  attribute {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 112,\n                  \"Content\": \"    name = \\\"chunk_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mname\\u001b[0m = \\u001b[38;5;37m\\\"chunk_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 113,\n                  \"Content\": \"    type = \\\"S\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mtype\\u001b[0m = \\u001b[38;5;37m\\\"S\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 114,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0024\",\n          \"AVDID\": \"AVD-AWS-0024\",\n          \"Title\": \"Point in time recovery should be enabled to protect DynamoDB table\",\n          \"Description\": \"DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\\n\\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.\",\n          \"Message\": \"Point-in-time recovery is not enabled.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable point in time recovery\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0024\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0024\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"dynamodb\",\n            \"StartLine\": 55,\n            \"EndLine\": 102,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 55,\n                  \"Content\": \"resource \\\"aws_dynamodb_table\\\" \\\"document_registry\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_dynamodb_table\\\"\\u001b[0m \\u001b[38;5;37m\\\"document_registry\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 56,\n                  \"Content\": \"  name           = \\\"${var.project_name}-document-registry\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m           = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-document-registry\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 57,\n                  \"Content\": \"  billing_mode   = \\\"PAY_PER_REQUEST\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mbilling_mode\\u001b[0m   = \\u001b[38;5;37m\\\"PAY_PER_REQUEST\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 58,\n                  \"Content\": \"  hash_key       = \\\"document_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mhash_key\\u001b[0m       = \\u001b[38;5;37m\\\"document_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 59,\n                  \"Content\": \"  range_key      = \\\"version\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mrange_key\\u001b[0m      = \\u001b[38;5;37m\\\"version\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 60,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 61,\n                  \"Content\": \"  attribute {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  attribute {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 62,\n                  \"Content\": \"    name = \\\"document_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mname\\u001b[0m = \\u001b[38;5;37m\\\"document_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 63,\n                  \"Content\": \"    type = \\\"S\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mtype\\u001b[0m = \\u001b[38;5;37m\\\"S\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 64,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0024\",\n          \"AVDID\": \"AVD-AWS-0024\",\n          \"Title\": \"Point in time recovery should be enabled to protect DynamoDB table\",\n          \"Description\": \"DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\\n\\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.\",\n          \"Message\": \"Point-in-time recovery is not enabled.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable point in time recovery\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0024\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0024\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"dynamodb\",\n            \"StartLine\": 55,\n            \"EndLine\": 102,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 55,\n                  \"Content\": \"resource \\\"aws_dynamodb_table\\\" \\\"document_registry\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_dynamodb_table\\\"\\u001b[0m \\u001b[38;5;37m\\\"document_registry\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 56,\n                  \"Content\": \"  name           = \\\"${var.project_name}-document-registry\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m           = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-document-registry\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 57,\n                  \"Content\": \"  billing_mode   = \\\"PAY_PER_REQUEST\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mbilling_mode\\u001b[0m   = \\u001b[38;5;37m\\\"PAY_PER_REQUEST\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 58,\n                  \"Content\": \"  hash_key       = \\\"document_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mhash_key\\u001b[0m       = \\u001b[38;5;37m\\\"document_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 59,\n                  \"Content\": \"  range_key      = \\\"version\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mrange_key\\u001b[0m      = \\u001b[38;5;37m\\\"version\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 60,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 61,\n                  \"Content\": \"  attribute {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  attribute {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 62,\n                  \"Content\": \"    name = \\\"document_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mname\\u001b[0m = \\u001b[38;5;37m\\\"document_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 63,\n                  \"Content\": \"    type = \\\"S\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mtype\\u001b[0m = \\u001b[38;5;37m\\\"S\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 64,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0024\",\n          \"AVDID\": \"AVD-AWS-0024\",\n          \"Title\": \"Point in time recovery should be enabled to protect DynamoDB table\",\n          \"Description\": \"DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.\\n\\nBy enabling point-in-time-recovery you can restore to a known point in the event of loss of data.\",\n          \"Message\": \"Point-in-time recovery is not enabled.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable point in time recovery\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0024\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0024\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"dynamodb\",\n            \"StartLine\": 105,\n            \"EndLine\": 147,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 105,\n                  \"Content\": \"resource \\\"aws_dynamodb_table\\\" \\\"embedding_chunks\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_dynamodb_table\\\"\\u001b[0m \\u001b[38;5;37m\\\"embedding_chunks\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 106,\n                  \"Content\": \"  name           = \\\"${var.project_name}-embedding-chunks\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m           = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embedding-chunks\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 107,\n                  \"Content\": \"  billing_mode   = \\\"PAY_PER_REQUEST\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mbilling_mode\\u001b[0m   = \\u001b[38;5;37m\\\"PAY_PER_REQUEST\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 108,\n                  \"Content\": \"  hash_key       = \\\"chunk_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mhash_key\\u001b[0m       = \\u001b[38;5;37m\\\"chunk_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 109,\n                  \"Content\": \"  range_key      = \\\"document_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mrange_key\\u001b[0m      = \\u001b[38;5;37m\\\"document_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 110,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 111,\n                  \"Content\": \"  attribute {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  attribute {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 112,\n                  \"Content\": \"    name = \\\"chunk_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mname\\u001b[0m = \\u001b[38;5;37m\\\"chunk_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 113,\n                  \"Content\": \"    type = \\\"S\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mtype\\u001b[0m = \\u001b[38;5;37m\\\"S\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 114,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0025\",\n          \"AVDID\": \"AVD-AWS-0025\",\n          \"Title\": \"DynamoDB tables should use at rest encryption with a Customer Managed Key\",\n          \"Description\": \"DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.\",\n          \"Message\": \"Table encryption does not use a customer-managed KMS key.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable server side encryption with a customer managed key\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0025\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0025\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"dynamodb\",\n            \"StartLine\": 150,\n            \"EndLine\": 191,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 150,\n                  \"Content\": \"resource \\\"aws_dynamodb_table\\\" \\\"ingestion_jobs\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_dynamodb_table\\\"\\u001b[0m \\u001b[38;5;37m\\\"ingestion_jobs\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 151,\n                  \"Content\": \"  name           = \\\"${var.project_name}-ingestion-jobs\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m           = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-ingestion-jobs\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 152,\n                  \"Content\": \"  billing_mode   = \\\"PAY_PER_REQUEST\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mbilling_mode\\u001b[0m   = \\u001b[38;5;37m\\\"PAY_PER_REQUEST\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 153,\n                  \"Content\": \"  hash_key       = \\\"job_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mhash_key\\u001b[0m       = \\u001b[38;5;37m\\\"job_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 154,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 155,\n                  \"Content\": \"  attribute {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  attribute {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 156,\n                  \"Content\": \"    name = \\\"job_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mname\\u001b[0m = \\u001b[38;5;37m\\\"job_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 157,\n                  \"Content\": \"    type = \\\"S\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mtype\\u001b[0m = \\u001b[38;5;37m\\\"S\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 158,\n                  \"Content\": \"  }\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  }\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 159,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0025\",\n          \"AVDID\": \"AVD-AWS-0025\",\n          \"Title\": \"DynamoDB tables should use at rest encryption with a Customer Managed Key\",\n          \"Description\": \"DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.\",\n          \"Message\": \"Table encryption does not use a customer-managed KMS key.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable server side encryption with a customer managed key\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0025\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0025\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"dynamodb\",\n            \"StartLine\": 105,\n            \"EndLine\": 147,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 105,\n                  \"Content\": \"resource \\\"aws_dynamodb_table\\\" \\\"embedding_chunks\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_dynamodb_table\\\"\\u001b[0m \\u001b[38;5;37m\\\"embedding_chunks\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 106,\n                  \"Content\": \"  name           = \\\"${var.project_name}-embedding-chunks\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m           = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embedding-chunks\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 107,\n                  \"Content\": \"  billing_mode   = \\\"PAY_PER_REQUEST\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mbilling_mode\\u001b[0m   = \\u001b[38;5;37m\\\"PAY_PER_REQUEST\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 108,\n                  \"Content\": \"  hash_key       = \\\"chunk_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mhash_key\\u001b[0m       = \\u001b[38;5;37m\\\"chunk_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 109,\n                  \"Content\": \"  range_key      = \\\"document_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mrange_key\\u001b[0m      = \\u001b[38;5;37m\\\"document_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 110,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 111,\n                  \"Content\": \"  attribute {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  attribute {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 112,\n                  \"Content\": \"    name = \\\"chunk_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mname\\u001b[0m = \\u001b[38;5;37m\\\"chunk_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 113,\n                  \"Content\": \"    type = \\\"S\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mtype\\u001b[0m = \\u001b[38;5;37m\\\"S\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 114,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0025\",\n          \"AVDID\": \"AVD-AWS-0025\",\n          \"Title\": \"DynamoDB tables should use at rest encryption with a Customer Managed Key\",\n          \"Description\": \"DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.\",\n          \"Message\": \"Table encryption does not use a customer-managed KMS key.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable server side encryption with a customer managed key\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0025\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0025\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"dynamodb\",\n            \"StartLine\": 55,\n            \"EndLine\": 102,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 55,\n                  \"Content\": \"resource \\\"aws_dynamodb_table\\\" \\\"document_registry\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_dynamodb_table\\\"\\u001b[0m \\u001b[38;5;37m\\\"document_registry\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 56,\n                  \"Content\": \"  name           = \\\"${var.project_name}-document-registry\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m           = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-document-registry\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 57,\n                  \"Content\": \"  billing_mode   = \\\"PAY_PER_REQUEST\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mbilling_mode\\u001b[0m   = \\u001b[38;5;37m\\\"PAY_PER_REQUEST\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 58,\n                  \"Content\": \"  hash_key       = \\\"document_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mhash_key\\u001b[0m       = \\u001b[38;5;37m\\\"document_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 59,\n                  \"Content\": \"  range_key      = \\\"version\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mrange_key\\u001b[0m      = \\u001b[38;5;37m\\\"version\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 60,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 61,\n                  \"Content\": \"  attribute {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  attribute {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 62,\n                  \"Content\": \"    name = \\\"document_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mname\\u001b[0m = \\u001b[38;5;37m\\\"document_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 63,\n                  \"Content\": \"    type = \\\"S\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mtype\\u001b[0m = \\u001b[38;5;37m\\\"S\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 64,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0025\",\n          \"AVDID\": \"AVD-AWS-0025\",\n          \"Title\": \"DynamoDB tables should use at rest encryption with a Customer Managed Key\",\n          \"Description\": \"DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.\",\n          \"Message\": \"Table encryption does not use a customer-managed KMS key.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable server side encryption with a customer managed key\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0025\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0025\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"dynamodb\",\n            \"StartLine\": 150,\n            \"EndLine\": 191,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 150,\n                  \"Content\": \"resource \\\"aws_dynamodb_table\\\" \\\"ingestion_jobs\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_dynamodb_table\\\"\\u001b[0m \\u001b[38;5;37m\\\"ingestion_jobs\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 151,\n                  \"Content\": \"  name           = \\\"${var.project_name}-ingestion-jobs\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m           = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-ingestion-jobs\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 152,\n                  \"Content\": \"  billing_mode   = \\\"PAY_PER_REQUEST\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mbilling_mode\\u001b[0m   = \\u001b[38;5;37m\\\"PAY_PER_REQUEST\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 153,\n                  \"Content\": \"  hash_key       = \\\"job_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mhash_key\\u001b[0m       = \\u001b[38;5;37m\\\"job_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 154,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 155,\n                  \"Content\": \"  attribute {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  attribute {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 156,\n                  \"Content\": \"    name = \\\"job_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mname\\u001b[0m = \\u001b[38;5;37m\\\"job_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 157,\n                  \"Content\": \"    type = \\\"S\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mtype\\u001b[0m = \\u001b[38;5;37m\\\"S\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 158,\n                  \"Content\": \"  }\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  }\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 159,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0025\",\n          \"AVDID\": \"AVD-AWS-0025\",\n          \"Title\": \"DynamoDB tables should use at rest encryption with a Customer Managed Key\",\n          \"Description\": \"DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.\",\n          \"Message\": \"Table encryption does not use a customer-managed KMS key.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable server side encryption with a customer managed key\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0025\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0025\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"dynamodb\",\n            \"StartLine\": 105,\n            \"EndLine\": 147,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 105,\n                  \"Content\": \"resource \\\"aws_dynamodb_table\\\" \\\"embedding_chunks\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_dynamodb_table\\\"\\u001b[0m \\u001b[38;5;37m\\\"embedding_chunks\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 106,\n                  \"Content\": \"  name           = \\\"${var.project_name}-embedding-chunks\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m           = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embedding-chunks\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 107,\n                  \"Content\": \"  billing_mode   = \\\"PAY_PER_REQUEST\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mbilling_mode\\u001b[0m   = \\u001b[38;5;37m\\\"PAY_PER_REQUEST\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 108,\n                  \"Content\": \"  hash_key       = \\\"chunk_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mhash_key\\u001b[0m       = \\u001b[38;5;37m\\\"chunk_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 109,\n                  \"Content\": \"  range_key      = \\\"document_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mrange_key\\u001b[0m      = \\u001b[38;5;37m\\\"document_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 110,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 111,\n                  \"Content\": \"  attribute {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  attribute {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 112,\n                  \"Content\": \"    name = \\\"chunk_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mname\\u001b[0m = \\u001b[38;5;37m\\\"chunk_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 113,\n                  \"Content\": \"    type = \\\"S\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mtype\\u001b[0m = \\u001b[38;5;37m\\\"S\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 114,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0025\",\n          \"AVDID\": \"AVD-AWS-0025\",\n          \"Title\": \"DynamoDB tables should use at rest encryption with a Customer Managed Key\",\n          \"Description\": \"DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.\",\n          \"Message\": \"Table encryption does not use a customer-managed KMS key.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable server side encryption with a customer managed key\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0025\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0025\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"dynamodb\",\n            \"StartLine\": 55,\n            \"EndLine\": 102,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 55,\n                  \"Content\": \"resource \\\"aws_dynamodb_table\\\" \\\"document_registry\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_dynamodb_table\\\"\\u001b[0m \\u001b[38;5;37m\\\"document_registry\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 56,\n                  \"Content\": \"  name           = \\\"${var.project_name}-document-registry\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m           = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-document-registry\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 57,\n                  \"Content\": \"  billing_mode   = \\\"PAY_PER_REQUEST\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mbilling_mode\\u001b[0m   = \\u001b[38;5;37m\\\"PAY_PER_REQUEST\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 58,\n                  \"Content\": \"  hash_key       = \\\"document_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mhash_key\\u001b[0m       = \\u001b[38;5;37m\\\"document_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 59,\n                  \"Content\": \"  range_key      = \\\"version\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mrange_key\\u001b[0m      = \\u001b[38;5;37m\\\"version\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 60,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 61,\n                  \"Content\": \"  attribute {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  attribute {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 62,\n                  \"Content\": \"    name = \\\"document_id\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mname\\u001b[0m = \\u001b[38;5;37m\\\"document_id\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 63,\n                  \"Content\": \"    type = \\\"S\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mtype\\u001b[0m = \\u001b[38;5;37m\\\"S\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 64,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0086\",\n          \"AVDID\": \"AVD-AWS-0086\",\n          \"Title\": \"S3 Access block should block public ACL\",\n          \"Description\": \"\\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\\n\",\n          \"Message\": \"No public access block so not blocking public acls\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable blocking any PUT calls with a public ACL specified\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0086\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0086\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 25,\n            \"EndLine\": 33,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_embeddings\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_embeddings\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"    Purpose     = \\\"Processed embeddings storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Processed embeddings storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0086\",\n          \"AVDID\": \"AVD-AWS-0086\",\n          \"Title\": \"S3 Access block should block public ACL\",\n          \"Description\": \"\\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\\n\",\n          \"Message\": \"No public access block so not blocking public acls\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable blocking any PUT calls with a public ACL specified\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0086\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0086\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 15,\n            \"EndLine\": 23,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 15,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_raw\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_raw\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 16,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 17,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 18,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"    Purpose     = \\\"Raw document storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Raw document storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0086\",\n          \"AVDID\": \"AVD-AWS-0086\",\n          \"Title\": \"S3 Access block should block public ACL\",\n          \"Description\": \"\\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\\n\",\n          \"Message\": \"No public access block so not blocking public acls\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable blocking any PUT calls with a public ACL specified\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0086\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0086\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 35,\n            \"EndLine\": 43,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 35,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_config\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_config\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 37,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 38,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 39,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 40,\n                  \"Content\": \"    Purpose     = \\\"Configuration and secrets\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Configuration and secrets\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 41,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 42,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 43,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0086\",\n          \"AVDID\": \"AVD-AWS-0086\",\n          \"Title\": \"S3 Access block should block public ACL\",\n          \"Description\": \"\\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\\n\",\n          \"Message\": \"No public access block so not blocking public acls\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable blocking any PUT calls with a public ACL specified\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0086\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0086\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 35,\n            \"EndLine\": 43,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 35,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_config\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_config\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 37,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 38,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 39,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 40,\n                  \"Content\": \"    Purpose     = \\\"Configuration and secrets\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Configuration and secrets\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 41,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 42,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 43,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0086\",\n          \"AVDID\": \"AVD-AWS-0086\",\n          \"Title\": \"S3 Access block should block public ACL\",\n          \"Description\": \"\\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\\n\",\n          \"Message\": \"No public access block so not blocking public acls\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable blocking any PUT calls with a public ACL specified\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0086\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0086\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 25,\n            \"EndLine\": 33,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_embeddings\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_embeddings\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"    Purpose     = \\\"Processed embeddings storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Processed embeddings storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0086\",\n          \"AVDID\": \"AVD-AWS-0086\",\n          \"Title\": \"S3 Access block should block public ACL\",\n          \"Description\": \"\\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\\n\",\n          \"Message\": \"No public access block so not blocking public acls\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable blocking any PUT calls with a public ACL specified\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0086\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0086\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 15,\n            \"EndLine\": 23,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 15,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_raw\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_raw\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 16,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 17,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 18,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"    Purpose     = \\\"Raw document storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Raw document storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0087\",\n          \"AVDID\": \"AVD-AWS-0087\",\n          \"Title\": \"S3 Access block should block public policy\",\n          \"Description\": \"\\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\\n\",\n          \"Message\": \"No public access block so not blocking public policies\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Prevent policies that allow public access being PUT\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0087\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0087\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 35,\n            \"EndLine\": 43,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 35,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_config\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_config\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 37,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 38,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 39,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 40,\n                  \"Content\": \"    Purpose     = \\\"Configuration and secrets\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Configuration and secrets\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 41,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 42,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 43,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0087\",\n          \"AVDID\": \"AVD-AWS-0087\",\n          \"Title\": \"S3 Access block should block public policy\",\n          \"Description\": \"\\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\\n\",\n          \"Message\": \"No public access block so not blocking public policies\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Prevent policies that allow public access being PUT\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0087\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0087\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 15,\n            \"EndLine\": 23,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 15,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_raw\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_raw\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 16,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 17,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 18,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"    Purpose     = \\\"Raw document storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Raw document storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0087\",\n          \"AVDID\": \"AVD-AWS-0087\",\n          \"Title\": \"S3 Access block should block public policy\",\n          \"Description\": \"\\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\\n\",\n          \"Message\": \"No public access block so not blocking public policies\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Prevent policies that allow public access being PUT\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0087\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0087\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 25,\n            \"EndLine\": 33,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_embeddings\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_embeddings\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"    Purpose     = \\\"Processed embeddings storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Processed embeddings storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0087\",\n          \"AVDID\": \"AVD-AWS-0087\",\n          \"Title\": \"S3 Access block should block public policy\",\n          \"Description\": \"\\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\\n\",\n          \"Message\": \"No public access block so not blocking public policies\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Prevent policies that allow public access being PUT\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0087\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0087\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 15,\n            \"EndLine\": 23,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 15,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_raw\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_raw\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 16,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 17,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 18,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"    Purpose     = \\\"Raw document storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Raw document storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0087\",\n          \"AVDID\": \"AVD-AWS-0087\",\n          \"Title\": \"S3 Access block should block public policy\",\n          \"Description\": \"\\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\\n\",\n          \"Message\": \"No public access block so not blocking public policies\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Prevent policies that allow public access being PUT\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0087\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0087\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 25,\n            \"EndLine\": 33,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_embeddings\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_embeddings\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"    Purpose     = \\\"Processed embeddings storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Processed embeddings storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0087\",\n          \"AVDID\": \"AVD-AWS-0087\",\n          \"Title\": \"S3 Access block should block public policy\",\n          \"Description\": \"\\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\\n\",\n          \"Message\": \"No public access block so not blocking public policies\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Prevent policies that allow public access being PUT\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0087\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0087\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 35,\n            \"EndLine\": 43,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 35,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_config\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_config\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 37,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 38,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 39,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 40,\n                  \"Content\": \"    Purpose     = \\\"Configuration and secrets\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Configuration and secrets\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 41,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 42,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 43,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0088\",\n          \"AVDID\": \"AVD-AWS-0088\",\n          \"Title\": \"Unencrypted S3 bucket.\",\n          \"Description\": \"S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\",\n          \"Message\": \"Bucket does not have encryption enabled\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Configure bucket encryption\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0088\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0088\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 35,\n            \"EndLine\": 43,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 35,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_config\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_config\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 37,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 38,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 39,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 40,\n                  \"Content\": \"    Purpose     = \\\"Configuration and secrets\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Configuration and secrets\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 41,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 42,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 43,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0088\",\n          \"AVDID\": \"AVD-AWS-0088\",\n          \"Title\": \"Unencrypted S3 bucket.\",\n          \"Description\": \"S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\",\n          \"Message\": \"Bucket does not have encryption enabled\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Configure bucket encryption\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0088\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0088\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 25,\n            \"EndLine\": 33,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_embeddings\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_embeddings\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"    Purpose     = \\\"Processed embeddings storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Processed embeddings storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0088\",\n          \"AVDID\": \"AVD-AWS-0088\",\n          \"Title\": \"Unencrypted S3 bucket.\",\n          \"Description\": \"S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\",\n          \"Message\": \"Bucket does not have encryption enabled\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Configure bucket encryption\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0088\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0088\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 15,\n            \"EndLine\": 23,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 15,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_raw\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_raw\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 16,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 17,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 18,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"    Purpose     = \\\"Raw document storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Raw document storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0088\",\n          \"AVDID\": \"AVD-AWS-0088\",\n          \"Title\": \"Unencrypted S3 bucket.\",\n          \"Description\": \"S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\",\n          \"Message\": \"Bucket does not have encryption enabled\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Configure bucket encryption\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0088\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0088\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 15,\n            \"EndLine\": 23,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 15,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_raw\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_raw\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 16,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 17,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 18,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"    Purpose     = \\\"Raw document storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Raw document storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0088\",\n          \"AVDID\": \"AVD-AWS-0088\",\n          \"Title\": \"Unencrypted S3 bucket.\",\n          \"Description\": \"S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\",\n          \"Message\": \"Bucket does not have encryption enabled\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Configure bucket encryption\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0088\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0088\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 25,\n            \"EndLine\": 33,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_embeddings\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_embeddings\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"    Purpose     = \\\"Processed embeddings storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Processed embeddings storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0088\",\n          \"AVDID\": \"AVD-AWS-0088\",\n          \"Title\": \"Unencrypted S3 bucket.\",\n          \"Description\": \"S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\",\n          \"Message\": \"Bucket does not have encryption enabled\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Configure bucket encryption\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0088\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0088\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 35,\n            \"EndLine\": 43,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 35,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_config\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_config\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 37,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 38,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 39,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 40,\n                  \"Content\": \"    Purpose     = \\\"Configuration and secrets\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Configuration and secrets\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 41,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 42,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 43,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0089\",\n          \"AVDID\": \"AVD-AWS-0089\",\n          \"Title\": \"S3 Bucket Logging\",\n          \"Description\": \"Ensures S3 bucket logging is enabled for S3 buckets\",\n          \"Message\": \"Bucket has logging disabled\",\n          \"Namespace\": \"builtin.aws.s3.aws0089\",\n          \"Query\": \"data.builtin.aws.s3.aws0089.deny\",\n          \"Resolution\": \"Add a logging block to the resource to enable access logging\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0089\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0089\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 25,\n            \"EndLine\": 33,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_embeddings\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_embeddings\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"    Purpose     = \\\"Processed embeddings storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Processed embeddings storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0089\",\n          \"AVDID\": \"AVD-AWS-0089\",\n          \"Title\": \"S3 Bucket Logging\",\n          \"Description\": \"Ensures S3 bucket logging is enabled for S3 buckets\",\n          \"Message\": \"Bucket has logging disabled\",\n          \"Namespace\": \"builtin.aws.s3.aws0089\",\n          \"Query\": \"data.builtin.aws.s3.aws0089.deny\",\n          \"Resolution\": \"Add a logging block to the resource to enable access logging\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0089\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0089\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 15,\n            \"EndLine\": 23,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 15,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_raw\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_raw\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 16,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 17,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 18,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"    Purpose     = \\\"Raw document storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Raw document storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0089\",\n          \"AVDID\": \"AVD-AWS-0089\",\n          \"Title\": \"S3 Bucket Logging\",\n          \"Description\": \"Ensures S3 bucket logging is enabled for S3 buckets\",\n          \"Message\": \"Bucket has logging disabled\",\n          \"Namespace\": \"builtin.aws.s3.aws0089\",\n          \"Query\": \"data.builtin.aws.s3.aws0089.deny\",\n          \"Resolution\": \"Add a logging block to the resource to enable access logging\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0089\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0089\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 35,\n            \"EndLine\": 43,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 35,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_config\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_config\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 37,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 38,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 39,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 40,\n                  \"Content\": \"    Purpose     = \\\"Configuration and secrets\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Configuration and secrets\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 41,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 42,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 43,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0089\",\n          \"AVDID\": \"AVD-AWS-0089\",\n          \"Title\": \"S3 Bucket Logging\",\n          \"Description\": \"Ensures S3 bucket logging is enabled for S3 buckets\",\n          \"Message\": \"Bucket has logging disabled\",\n          \"Namespace\": \"builtin.aws.s3.aws0089\",\n          \"Query\": \"data.builtin.aws.s3.aws0089.deny\",\n          \"Resolution\": \"Add a logging block to the resource to enable access logging\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0089\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0089\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 35,\n            \"EndLine\": 43,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 35,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_config\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_config\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 37,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 38,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 39,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 40,\n                  \"Content\": \"    Purpose     = \\\"Configuration and secrets\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Configuration and secrets\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 41,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 42,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 43,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0089\",\n          \"AVDID\": \"AVD-AWS-0089\",\n          \"Title\": \"S3 Bucket Logging\",\n          \"Description\": \"Ensures S3 bucket logging is enabled for S3 buckets\",\n          \"Message\": \"Bucket has logging disabled\",\n          \"Namespace\": \"builtin.aws.s3.aws0089\",\n          \"Query\": \"data.builtin.aws.s3.aws0089.deny\",\n          \"Resolution\": \"Add a logging block to the resource to enable access logging\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0089\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0089\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 25,\n            \"EndLine\": 33,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_embeddings\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_embeddings\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"    Purpose     = \\\"Processed embeddings storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Processed embeddings storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0089\",\n          \"AVDID\": \"AVD-AWS-0089\",\n          \"Title\": \"S3 Bucket Logging\",\n          \"Description\": \"Ensures S3 bucket logging is enabled for S3 buckets\",\n          \"Message\": \"Bucket has logging disabled\",\n          \"Namespace\": \"builtin.aws.s3.aws0089\",\n          \"Query\": \"data.builtin.aws.s3.aws0089.deny\",\n          \"Resolution\": \"Add a logging block to the resource to enable access logging\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0089\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0089\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 15,\n            \"EndLine\": 23,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 15,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_raw\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_raw\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 16,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 17,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 18,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"    Purpose     = \\\"Raw document storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Raw document storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0090\",\n          \"AVDID\": \"AVD-AWS-0090\",\n          \"Title\": \"S3 Data should be versioned\",\n          \"Description\": \"\\nVersioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket. \\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. \\nWith versioning you can recover more easily from both unintended user actions and application failures.\\n\",\n          \"Message\": \"Bucket does not have versioning enabled\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable versioning to protect against accidental/malicious removal or modification\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0090\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0090\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 25,\n            \"EndLine\": 33,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_embeddings\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_embeddings\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"    Purpose     = \\\"Processed embeddings storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Processed embeddings storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0090\",\n          \"AVDID\": \"AVD-AWS-0090\",\n          \"Title\": \"S3 Data should be versioned\",\n          \"Description\": \"\\nVersioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket. \\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. \\nWith versioning you can recover more easily from both unintended user actions and application failures.\\n\",\n          \"Message\": \"Bucket does not have versioning enabled\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable versioning to protect against accidental/malicious removal or modification\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0090\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0090\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 25,\n            \"EndLine\": 33,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_embeddings\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_embeddings\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"    Purpose     = \\\"Processed embeddings storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Processed embeddings storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0090\",\n          \"AVDID\": \"AVD-AWS-0090\",\n          \"Title\": \"S3 Data should be versioned\",\n          \"Description\": \"\\nVersioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket. \\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. \\nWith versioning you can recover more easily from both unintended user actions and application failures.\\n\",\n          \"Message\": \"Bucket does not have versioning enabled\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable versioning to protect against accidental/malicious removal or modification\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0090\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0090\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 35,\n            \"EndLine\": 43,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 35,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_config\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_config\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 37,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 38,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 39,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 40,\n                  \"Content\": \"    Purpose     = \\\"Configuration and secrets\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Configuration and secrets\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 41,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 42,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 43,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0090\",\n          \"AVDID\": \"AVD-AWS-0090\",\n          \"Title\": \"S3 Data should be versioned\",\n          \"Description\": \"\\nVersioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket. \\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. \\nWith versioning you can recover more easily from both unintended user actions and application failures.\\n\",\n          \"Message\": \"Bucket does not have versioning enabled\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable versioning to protect against accidental/malicious removal or modification\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0090\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0090\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 35,\n            \"EndLine\": 43,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 35,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_config\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_config\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 37,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 38,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 39,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 40,\n                  \"Content\": \"    Purpose     = \\\"Configuration and secrets\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Configuration and secrets\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 41,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 42,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 43,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0091\",\n          \"AVDID\": \"AVD-AWS-0091\",\n          \"Title\": \"S3 Access Block should Ignore Public Acl\",\n          \"Description\": \"\\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\\n\",\n          \"Message\": \"No public access block so not ignoring public acls\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable ignoring the application of public ACLs in PUT calls\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0091\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0091\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 15,\n            \"EndLine\": 23,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 15,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_raw\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_raw\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 16,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 17,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 18,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"    Purpose     = \\\"Raw document storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Raw document storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0091\",\n          \"AVDID\": \"AVD-AWS-0091\",\n          \"Title\": \"S3 Access Block should Ignore Public Acl\",\n          \"Description\": \"\\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\\n\",\n          \"Message\": \"No public access block so not ignoring public acls\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable ignoring the application of public ACLs in PUT calls\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0091\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0091\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 35,\n            \"EndLine\": 43,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 35,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_config\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_config\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 37,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 38,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 39,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 40,\n                  \"Content\": \"    Purpose     = \\\"Configuration and secrets\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Configuration and secrets\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 41,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 42,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 43,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0091\",\n          \"AVDID\": \"AVD-AWS-0091\",\n          \"Title\": \"S3 Access Block should Ignore Public Acl\",\n          \"Description\": \"\\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\\n\",\n          \"Message\": \"No public access block so not ignoring public acls\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable ignoring the application of public ACLs in PUT calls\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0091\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0091\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 35,\n            \"EndLine\": 43,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 35,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_config\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_config\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 37,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 38,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 39,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 40,\n                  \"Content\": \"    Purpose     = \\\"Configuration and secrets\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Configuration and secrets\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 41,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 42,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 43,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0091\",\n          \"AVDID\": \"AVD-AWS-0091\",\n          \"Title\": \"S3 Access Block should Ignore Public Acl\",\n          \"Description\": \"\\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\\n\",\n          \"Message\": \"No public access block so not ignoring public acls\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable ignoring the application of public ACLs in PUT calls\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0091\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0091\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 25,\n            \"EndLine\": 33,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_embeddings\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_embeddings\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"    Purpose     = \\\"Processed embeddings storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Processed embeddings storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0091\",\n          \"AVDID\": \"AVD-AWS-0091\",\n          \"Title\": \"S3 Access Block should Ignore Public Acl\",\n          \"Description\": \"\\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\\n\",\n          \"Message\": \"No public access block so not ignoring public acls\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable ignoring the application of public ACLs in PUT calls\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0091\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0091\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 15,\n            \"EndLine\": 23,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 15,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_raw\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_raw\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 16,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 17,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 18,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"    Purpose     = \\\"Raw document storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Raw document storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0091\",\n          \"AVDID\": \"AVD-AWS-0091\",\n          \"Title\": \"S3 Access Block should Ignore Public Acl\",\n          \"Description\": \"\\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\\n\",\n          \"Message\": \"No public access block so not ignoring public acls\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable ignoring the application of public ACLs in PUT calls\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0091\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0091\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 25,\n            \"EndLine\": 33,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_embeddings\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_embeddings\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"    Purpose     = \\\"Processed embeddings storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Processed embeddings storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0093\",\n          \"AVDID\": \"AVD-AWS-0093\",\n          \"Title\": \"S3 Access block should restrict public bucket to limit access\",\n          \"Description\": \"S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\",\n          \"Message\": \"No public access block so not restricting public buckets\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0093\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0093\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 25,\n            \"EndLine\": 33,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_embeddings\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_embeddings\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"    Purpose     = \\\"Processed embeddings storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Processed embeddings storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0093\",\n          \"AVDID\": \"AVD-AWS-0093\",\n          \"Title\": \"S3 Access block should restrict public bucket to limit access\",\n          \"Description\": \"S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\",\n          \"Message\": \"No public access block so not restricting public buckets\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0093\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0093\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 25,\n            \"EndLine\": 33,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_embeddings\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_embeddings\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"    Purpose     = \\\"Processed embeddings storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Processed embeddings storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0093\",\n          \"AVDID\": \"AVD-AWS-0093\",\n          \"Title\": \"S3 Access block should restrict public bucket to limit access\",\n          \"Description\": \"S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\",\n          \"Message\": \"No public access block so not restricting public buckets\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0093\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0093\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 15,\n            \"EndLine\": 23,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 15,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_raw\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_raw\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 16,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 17,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 18,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"    Purpose     = \\\"Raw document storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Raw document storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0093\",\n          \"AVDID\": \"AVD-AWS-0093\",\n          \"Title\": \"S3 Access block should restrict public bucket to limit access\",\n          \"Description\": \"S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\",\n          \"Message\": \"No public access block so not restricting public buckets\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0093\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0093\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 15,\n            \"EndLine\": 23,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 15,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_raw\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_raw\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 16,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 17,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 18,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"    Purpose     = \\\"Raw document storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Raw document storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0093\",\n          \"AVDID\": \"AVD-AWS-0093\",\n          \"Title\": \"S3 Access block should restrict public bucket to limit access\",\n          \"Description\": \"S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\",\n          \"Message\": \"No public access block so not restricting public buckets\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0093\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0093\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 35,\n            \"EndLine\": 43,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 35,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_config\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_config\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 37,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 38,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 39,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 40,\n                  \"Content\": \"    Purpose     = \\\"Configuration and secrets\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Configuration and secrets\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 41,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 42,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 43,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0093\",\n          \"AVDID\": \"AVD-AWS-0093\",\n          \"Title\": \"S3 Access block should restrict public bucket to limit access\",\n          \"Description\": \"S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\",\n          \"Message\": \"No public access block so not restricting public buckets\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0093\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0093\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 35,\n            \"EndLine\": 43,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 35,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_config\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_config\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 37,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 38,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 39,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 40,\n                  \"Content\": \"    Purpose     = \\\"Configuration and secrets\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Configuration and secrets\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 41,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 42,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 43,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0094\",\n          \"AVDID\": \"AVD-AWS-0094\",\n          \"Title\": \"S3 buckets should each define an aws_s3_bucket_public_access_block\",\n          \"Description\": \"The \\\"block public access\\\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\",\n          \"Message\": \"Bucket does not have a corresponding public access block.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0094\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0094\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 15,\n            \"EndLine\": 23,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 15,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_raw\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_raw\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 16,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 17,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 18,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"    Purpose     = \\\"Raw document storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Raw document storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0094\",\n          \"AVDID\": \"AVD-AWS-0094\",\n          \"Title\": \"S3 buckets should each define an aws_s3_bucket_public_access_block\",\n          \"Description\": \"The \\\"block public access\\\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\",\n          \"Message\": \"Bucket does not have a corresponding public access block.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0094\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0094\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 35,\n            \"EndLine\": 43,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 35,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_config\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_config\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 37,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 38,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 39,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 40,\n                  \"Content\": \"    Purpose     = \\\"Configuration and secrets\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Configuration and secrets\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 41,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 42,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 43,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0094\",\n          \"AVDID\": \"AVD-AWS-0094\",\n          \"Title\": \"S3 buckets should each define an aws_s3_bucket_public_access_block\",\n          \"Description\": \"The \\\"block public access\\\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\",\n          \"Message\": \"Bucket does not have a corresponding public access block.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0094\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0094\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 25,\n            \"EndLine\": 33,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_embeddings\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_embeddings\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"    Purpose     = \\\"Processed embeddings storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Processed embeddings storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0094\",\n          \"AVDID\": \"AVD-AWS-0094\",\n          \"Title\": \"S3 buckets should each define an aws_s3_bucket_public_access_block\",\n          \"Description\": \"The \\\"block public access\\\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\",\n          \"Message\": \"Bucket does not have a corresponding public access block.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0094\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0094\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 25,\n            \"EndLine\": 33,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_embeddings\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_embeddings\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"    Purpose     = \\\"Processed embeddings storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Processed embeddings storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0094\",\n          \"AVDID\": \"AVD-AWS-0094\",\n          \"Title\": \"S3 buckets should each define an aws_s3_bucket_public_access_block\",\n          \"Description\": \"The \\\"block public access\\\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\",\n          \"Message\": \"Bucket does not have a corresponding public access block.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0094\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0094\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 35,\n            \"EndLine\": 43,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 35,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_config\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_config\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 37,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 38,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 39,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 40,\n                  \"Content\": \"    Purpose     = \\\"Configuration and secrets\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Configuration and secrets\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 41,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 42,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 43,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0094\",\n          \"AVDID\": \"AVD-AWS-0094\",\n          \"Title\": \"S3 buckets should each define an aws_s3_bucket_public_access_block\",\n          \"Description\": \"The \\\"block public access\\\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\",\n          \"Message\": \"Bucket does not have a corresponding public access block.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0094\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0094\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 15,\n            \"EndLine\": 23,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 15,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_raw\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_raw\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 16,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 17,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 18,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"    Purpose     = \\\"Raw document storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Raw document storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0096\",\n          \"AVDID\": \"AVD-AWS-0096\",\n          \"Title\": \"Unencrypted SQS queue.\",\n          \"Description\": \"Queues should be encrypted to protect queue contents.\",\n          \"Message\": \"Queue is not encrypted\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Turn on SQS Queue encryption\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0096\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0096\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"sqs\",\n            \"StartLine\": 194,\n            \"EndLine\": 204,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 194,\n                  \"Content\": \"resource \\\"aws_sqs_queue\\\" \\\"ingestion_queue\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_sqs_queue\\\"\\u001b[0m \\u001b[38;5;37m\\\"ingestion_queue\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 195,\n                  \"Content\": \"  name                       = \\\"${var.project_name}-ingestion-queue\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m                       = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-ingestion-queue\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 196,\n                  \"Content\": \"  visibility_timeout_seconds = 300\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mvisibility_timeout_seconds\\u001b[0m = \\u001b[38;5;37m300\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 197,\n                  \"Content\": \"  message_retention_seconds  = 86400\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mmessage_retention_seconds\\u001b[0m  = \\u001b[38;5;37m86400\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 198,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 199,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 200,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-ingestion-queue\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-ingestion-queue\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 201,\n                  \"Content\": \"    Purpose     = \\\"Document ingestion queue\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Document ingestion queue\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 202,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 203,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0096\",\n          \"AVDID\": \"AVD-AWS-0096\",\n          \"Title\": \"Unencrypted SQS queue.\",\n          \"Description\": \"Queues should be encrypted to protect queue contents.\",\n          \"Message\": \"Queue is not encrypted\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Turn on SQS Queue encryption\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0096\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0096\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"sqs\",\n            \"StartLine\": 220,\n            \"EndLine\": 229,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 220,\n                  \"Content\": \"resource \\\"aws_sqs_queue\\\" \\\"ingestion_dlq\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_sqs_queue\\\"\\u001b[0m \\u001b[38;5;37m\\\"ingestion_dlq\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 221,\n                  \"Content\": \"  name                      = \\\"${var.project_name}-ingestion-dlq\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m                      = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-ingestion-dlq\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 222,\n                  \"Content\": \"  message_retention_seconds = 1209600  # 14 days\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mmessage_retention_seconds\\u001b[0m = \\u001b[38;5;37m1209600\\u001b[0m\\u001b[38;5;239m  # 14 days\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 223,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 224,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 225,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-ingestion-dlq\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-ingestion-dlq\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 226,\n                  \"Content\": \"    Purpose     = \\\"Dead letter queue for failed messages\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Dead letter queue for failed messages\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 227,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 228,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 229,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0096\",\n          \"AVDID\": \"AVD-AWS-0096\",\n          \"Title\": \"Unencrypted SQS queue.\",\n          \"Description\": \"Queues should be encrypted to protect queue contents.\",\n          \"Message\": \"Queue is not encrypted\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Turn on SQS Queue encryption\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0096\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0096\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"sqs\",\n            \"StartLine\": 207,\n            \"EndLine\": 217,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 207,\n                  \"Content\": \"resource \\\"aws_sqs_queue\\\" \\\"embedding_queue\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_sqs_queue\\\"\\u001b[0m \\u001b[38;5;37m\\\"embedding_queue\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 208,\n                  \"Content\": \"  name                       = \\\"${var.project_name}-embedding-queue\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m                       = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embedding-queue\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 209,\n                  \"Content\": \"  visibility_timeout_seconds = 300\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mvisibility_timeout_seconds\\u001b[0m = \\u001b[38;5;37m300\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 210,\n                  \"Content\": \"  message_retention_seconds  = 86400\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mmessage_retention_seconds\\u001b[0m  = \\u001b[38;5;37m86400\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 211,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 212,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 213,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embedding-queue\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embedding-queue\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 214,\n                  \"Content\": \"    Purpose     = \\\"Embedding generation queue\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Embedding generation queue\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 215,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 216,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0096\",\n          \"AVDID\": \"AVD-AWS-0096\",\n          \"Title\": \"Unencrypted SQS queue.\",\n          \"Description\": \"Queues should be encrypted to protect queue contents.\",\n          \"Message\": \"Queue is not encrypted\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Turn on SQS Queue encryption\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0096\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0096\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"sqs\",\n            \"StartLine\": 220,\n            \"EndLine\": 229,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 220,\n                  \"Content\": \"resource \\\"aws_sqs_queue\\\" \\\"ingestion_dlq\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_sqs_queue\\\"\\u001b[0m \\u001b[38;5;37m\\\"ingestion_dlq\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 221,\n                  \"Content\": \"  name                      = \\\"${var.project_name}-ingestion-dlq\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m                      = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-ingestion-dlq\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 222,\n                  \"Content\": \"  message_retention_seconds = 1209600  # 14 days\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mmessage_retention_seconds\\u001b[0m = \\u001b[38;5;37m1209600\\u001b[0m\\u001b[38;5;239m  # 14 days\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 223,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 224,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 225,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-ingestion-dlq\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-ingestion-dlq\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 226,\n                  \"Content\": \"    Purpose     = \\\"Dead letter queue for failed messages\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Dead letter queue for failed messages\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 227,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 228,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 229,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0096\",\n          \"AVDID\": \"AVD-AWS-0096\",\n          \"Title\": \"Unencrypted SQS queue.\",\n          \"Description\": \"Queues should be encrypted to protect queue contents.\",\n          \"Message\": \"Queue is not encrypted\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Turn on SQS Queue encryption\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0096\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0096\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"sqs\",\n            \"StartLine\": 207,\n            \"EndLine\": 217,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 207,\n                  \"Content\": \"resource \\\"aws_sqs_queue\\\" \\\"embedding_queue\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_sqs_queue\\\"\\u001b[0m \\u001b[38;5;37m\\\"embedding_queue\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 208,\n                  \"Content\": \"  name                       = \\\"${var.project_name}-embedding-queue\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m                       = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embedding-queue\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 209,\n                  \"Content\": \"  visibility_timeout_seconds = 300\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mvisibility_timeout_seconds\\u001b[0m = \\u001b[38;5;37m300\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 210,\n                  \"Content\": \"  message_retention_seconds  = 86400\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mmessage_retention_seconds\\u001b[0m  = \\u001b[38;5;37m86400\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 211,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 212,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 213,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embedding-queue\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embedding-queue\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 214,\n                  \"Content\": \"    Purpose     = \\\"Embedding generation queue\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Embedding generation queue\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 215,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 216,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0096\",\n          \"AVDID\": \"AVD-AWS-0096\",\n          \"Title\": \"Unencrypted SQS queue.\",\n          \"Description\": \"Queues should be encrypted to protect queue contents.\",\n          \"Message\": \"Queue is not encrypted\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Turn on SQS Queue encryption\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0096\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0096\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"sqs\",\n            \"StartLine\": 194,\n            \"EndLine\": 204,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 194,\n                  \"Content\": \"resource \\\"aws_sqs_queue\\\" \\\"ingestion_queue\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_sqs_queue\\\"\\u001b[0m \\u001b[38;5;37m\\\"ingestion_queue\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 195,\n                  \"Content\": \"  name                       = \\\"${var.project_name}-ingestion-queue\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mname\\u001b[0m                       = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-ingestion-queue\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 196,\n                  \"Content\": \"  visibility_timeout_seconds = 300\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mvisibility_timeout_seconds\\u001b[0m = \\u001b[38;5;37m300\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 197,\n                  \"Content\": \"  message_retention_seconds  = 86400\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;245mmessage_retention_seconds\\u001b[0m  = \\u001b[38;5;37m86400\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 198,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 199,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 200,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-ingestion-queue\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-ingestion-queue\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 201,\n                  \"Content\": \"    Purpose     = \\\"Document ingestion queue\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Document ingestion queue\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 202,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                },\n                {\n                  \"Number\": 203,\n                  \"Content\": \"\",\n                  \"IsCause\": false,\n                  \"Annotation\": \"\",\n                  \"Truncated\": true,\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0132\",\n          \"AVDID\": \"AVD-AWS-0132\",\n          \"Title\": \"S3 encryption should use Customer Managed Keys\",\n          \"Description\": \"Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\",\n          \"Message\": \"Bucket does not encrypt data with a customer managed key.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable encryption using customer managed keys\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0132\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0132\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 15,\n            \"EndLine\": 23,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 15,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_raw\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_raw\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 16,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 17,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 18,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"    Purpose     = \\\"Raw document storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Raw document storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0132\",\n          \"AVDID\": \"AVD-AWS-0132\",\n          \"Title\": \"S3 encryption should use Customer Managed Keys\",\n          \"Description\": \"Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\",\n          \"Message\": \"Bucket does not encrypt data with a customer managed key.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable encryption using customer managed keys\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0132\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0132\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 15,\n            \"EndLine\": 23,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 15,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_raw\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_raw\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 16,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 17,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 18,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 19,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-raw\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-raw\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 20,\n                  \"Content\": \"    Purpose     = \\\"Raw document storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Raw document storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 21,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 22,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 23,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0132\",\n          \"AVDID\": \"AVD-AWS-0132\",\n          \"Title\": \"S3 encryption should use Customer Managed Keys\",\n          \"Description\": \"Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\",\n          \"Message\": \"Bucket does not encrypt data with a customer managed key.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable encryption using customer managed keys\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0132\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0132\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 25,\n            \"EndLine\": 33,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_embeddings\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_embeddings\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"    Purpose     = \\\"Processed embeddings storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Processed embeddings storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0132\",\n          \"AVDID\": \"AVD-AWS-0132\",\n          \"Title\": \"S3 encryption should use Customer Managed Keys\",\n          \"Description\": \"Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\",\n          \"Message\": \"Bucket does not encrypt data with a customer managed key.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable encryption using customer managed keys\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0132\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0132\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 35,\n            \"EndLine\": 43,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 35,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_config\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_config\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 37,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 38,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 39,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 40,\n                  \"Content\": \"    Purpose     = \\\"Configuration and secrets\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Configuration and secrets\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 41,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 42,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 43,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s2-terraform-localstack/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 94,\n                  \"EndLine\": 99\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0132\",\n          \"AVDID\": \"AVD-AWS-0132\",\n          \"Title\": \"S3 encryption should use Customer Managed Keys\",\n          \"Description\": \"Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\",\n          \"Message\": \"Bucket does not encrypt data with a customer managed key.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable encryption using customer managed keys\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0132\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0132\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 25,\n            \"EndLine\": 33,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 25,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_embeddings\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_embeddings\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 26,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 27,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 28,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 29,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-embeddings\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-embeddings\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 30,\n                  \"Content\": \"    Purpose     = \\\"Processed embeddings storage\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Processed embeddings storage\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 31,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 32,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 33,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"Type\": \"Terraform Security Check\",\n          \"ID\": \"AVD-AWS-0132\",\n          \"AVDID\": \"AVD-AWS-0132\",\n          \"Title\": \"S3 encryption should use Customer Managed Keys\",\n          \"Description\": \"Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\",\n          \"Message\": \"Bucket does not encrypt data with a customer managed key.\",\n          \"Query\": \"data..\",\n          \"Resolution\": \"Enable encryption using customer managed keys\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/avd-aws-0132\",\n          \"References\": [\n            \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html\",\n            \"https://avd.aquasec.com/misconfig/avd-aws-0132\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Resource\": \"module.storage\",\n            \"Provider\": \"AWS\",\n            \"Service\": \"s3\",\n            \"StartLine\": 35,\n            \"EndLine\": 43,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 35,\n                  \"Content\": \"resource \\\"aws_s3_bucket\\\" \\\"portfolio_config\\\" {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[38;5;33mresource\\u001b[0m \\u001b[38;5;37m\\\"aws_s3_bucket\\\"\\u001b[0m \\u001b[38;5;37m\\\"portfolio_config\\\"\\u001b[0m {\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 36,\n                  \"Content\": \"  bucket = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mbucket\\u001b[0m = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 37,\n                  \"Content\": \"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 38,\n                  \"Content\": \"  tags = merge(var.tags, {\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;245mtags\\u001b[0m =\\u001b[38;5;33m merge\\u001b[0m(\\u001b[38;5;33mvar\\u001b[0m.tags, {\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 39,\n                  \"Content\": \"    Name        = \\\"${var.project_name}-config\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"    \\u001b[38;5;245mName\\u001b[0m        = \\u001b[38;5;37m\\\"\\u001b[0m\\u001b[38;5;37m${\\u001b[0m\\u001b[38;5;33mvar\\u001b[0m.project_name\\u001b[38;5;37m}\\u001b[0m\\u001b[38;5;37m-config\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 40,\n                  \"Content\": \"    Purpose     = \\\"Configuration and secrets\\\"\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mPurpose\\u001b[0m     = \\u001b[38;5;37m\\\"Configuration and secrets\\\"\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 41,\n                  \"Content\": \"    Environment = var.environment\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m    \\u001b[38;5;245mEnvironment\\u001b[0m = \\u001b[38;5;33mvar\\u001b[0m.environment\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 42,\n                  \"Content\": \"  })\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  })\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 43,\n                  \"Content\": \"}\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"}\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            },\n            \"Occurrences\": [\n              {\n                \"Resource\": \"module.storage\",\n                \"Filename\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws/main.tf\",\n                \"Location\": {\n                  \"StartLine\": 72,\n                  \"EndLine\": 84\n                }\n              }\n            ]\n          }\n        }\n      ]\n    },\n    {\n      \"Target\": \"infrastructure/method2-terraform-localstack/s3-terrafrom-real-aws\",\n      \"Class\": \"config\",\n      \"Type\": \"terraform\",\n      \"MisconfSummary\": {\n        \"Successes\": 2,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method3-helm-argocd/argocd/portfolio-application.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/deployment-api.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"helm\",\n      \"MisconfSummary\": {\n        \"Successes\": 148,\n        \"Failures\": 9,\n        \"Exceptions\": 0\n      },\n      \"Misconfigurations\": [\n        {\n          \"Type\": \"Helm Security Check\",\n          \"ID\": \"KSV011\",\n          \"AVDID\": \"AVD-KSV-0011\",\n          \"Title\": \"CPU not limited\",\n          \"Description\": \"Enforcing CPU limits prevents DoS via resource exhaustion.\",\n          \"Message\": \"Container 'fix-perms' of Deployment 'portfolio-api' should set 'resources.limits.cpu'\",\n          \"Namespace\": \"builtin.kubernetes.KSV011\",\n          \"Query\": \"data.builtin.kubernetes.KSV011.deny\",\n          \"Resolution\": \"Set a limit value under 'containers[].resources.limits.cpu'.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv011\",\n          \"References\": [\n            \"https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits\",\n            \"https://avd.aquasec.com/misconfig/ksv011\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 38,\n            \"EndLine\": 64,\n            \"Code\": {\n              \"Lines\": null\n            }\n          }\n        },\n        {\n          \"Type\": \"Helm Security Check\",\n          \"ID\": \"KSV015\",\n          \"AVDID\": \"AVD-KSV-0015\",\n          \"Title\": \"CPU requests not specified\",\n          \"Description\": \"When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.\",\n          \"Message\": \"Container 'fix-perms' of Deployment 'portfolio-api' should set 'resources.requests.cpu'\",\n          \"Namespace\": \"builtin.kubernetes.KSV015\",\n          \"Query\": \"data.builtin.kubernetes.KSV015.deny\",\n          \"Resolution\": \"Set 'containers[].resources.requests.cpu'.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv015\",\n          \"References\": [\n            \"https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits\",\n            \"https://avd.aquasec.com/misconfig/ksv015\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 38,\n            \"EndLine\": 64,\n            \"Code\": {\n              \"Lines\": null\n            }\n          }\n        },\n        {\n          \"Type\": \"Helm Security Check\",\n          \"ID\": \"KSV016\",\n          \"AVDID\": \"AVD-KSV-0016\",\n          \"Title\": \"Memory requests not specified\",\n          \"Description\": \"When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.\",\n          \"Message\": \"Container 'fix-perms' of Deployment 'portfolio-api' should set 'resources.requests.memory'\",\n          \"Namespace\": \"builtin.kubernetes.KSV016\",\n          \"Query\": \"data.builtin.kubernetes.KSV016.deny\",\n          \"Resolution\": \"Set 'containers[].resources.requests.memory'.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv016\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-resources-limits-memory/\",\n            \"https://avd.aquasec.com/misconfig/ksv016\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 38,\n            \"EndLine\": 64,\n            \"Code\": {\n              \"Lines\": null\n            }\n          }\n        },\n        {\n          \"Type\": \"Helm Security Check\",\n          \"ID\": \"KSV018\",\n          \"AVDID\": \"AVD-KSV-0018\",\n          \"Title\": \"Memory not limited\",\n          \"Description\": \"Enforcing memory limits prevents DoS via resource exhaustion.\",\n          \"Message\": \"Container 'fix-perms' of Deployment 'portfolio-api' should set 'resources.limits.memory'\",\n          \"Namespace\": \"builtin.kubernetes.KSV018\",\n          \"Query\": \"data.builtin.kubernetes.KSV018.deny\",\n          \"Resolution\": \"Set a limit value under 'containers[].resources.limits.memory'.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv018\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-resources-limits-memory/\",\n            \"https://avd.aquasec.com/misconfig/ksv018\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 38,\n            \"EndLine\": 64,\n            \"Code\": {\n              \"Lines\": null\n            }\n          }\n        },\n        {\n          \"Type\": \"Helm Security Check\",\n          \"ID\": \"KSV020\",\n          \"AVDID\": \"AVD-KSV-0020\",\n          \"Title\": \"Runs with UID \\u003c= 10000\",\n          \"Description\": \"Force the container to run with user ID \\u003e 10000 to avoid conflicts with the host\u2019s user table.\",\n          \"Message\": \"Container 'fix-perms' of Deployment 'portfolio-api' should set 'securityContext.runAsUser' \\u003e 10000\",\n          \"Namespace\": \"builtin.kubernetes.KSV020\",\n          \"Query\": \"data.builtin.kubernetes.KSV020.deny\",\n          \"Resolution\": \"Set 'containers[].securityContext.runAsUser' to an integer \\u003e 10000.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv020\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-runasuser/\",\n            \"https://avd.aquasec.com/misconfig/ksv020\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 38,\n            \"EndLine\": 64,\n            \"Code\": {\n              \"Lines\": null\n            }\n          }\n        },\n        {\n          \"Type\": \"Helm Security Check\",\n          \"ID\": \"KSV021\",\n          \"AVDID\": \"AVD-KSV-0021\",\n          \"Title\": \"Runs with GID \\u003c= 10000\",\n          \"Description\": \"Force the container to run with group ID \\u003e 10000 to avoid conflicts with the host\u2019s user table.\",\n          \"Message\": \"Container 'fix-perms' of Deployment 'portfolio-api' should set 'securityContext.runAsGroup' \\u003e 10000\",\n          \"Namespace\": \"builtin.kubernetes.KSV021\",\n          \"Query\": \"data.builtin.kubernetes.KSV021.deny\",\n          \"Resolution\": \"Set 'containers[].securityContext.runAsGroup' to an integer \\u003e 10000.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv021\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-runasuser/\",\n            \"https://avd.aquasec.com/misconfig/ksv021\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 38,\n            \"EndLine\": 64,\n            \"Code\": {\n              \"Lines\": null\n            }\n          }\n        },\n        {\n          \"Type\": \"Helm Security Check\",\n          \"ID\": \"KSV022\",\n          \"AVDID\": \"AVD-KSV-0022\",\n          \"Title\": \"Specific capabilities added\",\n          \"Description\": \"According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.\",\n          \"Message\": \"Container 'fix-perms' of Deployment 'portfolio-api' should not set 'securityContext.capabilities.add'\",\n          \"Namespace\": \"builtin.kubernetes.KSV022\",\n          \"Query\": \"data.builtin.kubernetes.KSV022.deny\",\n          \"Resolution\": \"Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv022\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline\",\n            \"https://avd.aquasec.com/misconfig/ksv022\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 38,\n            \"EndLine\": 64,\n            \"Code\": {\n              \"Lines\": null\n            }\n          }\n        },\n        {\n          \"Type\": \"Helm Security Check\",\n          \"ID\": \"KSV105\",\n          \"AVDID\": \"AVD-KSV-0105\",\n          \"Title\": \"Containers must not set runAsUser to 0\",\n          \"Description\": \"Containers should be forbidden from running with a root UID.\",\n          \"Message\": \"securityContext.runAsUser should be set to a value greater than 0\",\n          \"Namespace\": \"builtin.kubernetes.KSV105\",\n          \"Query\": \"data.builtin.kubernetes.KSV105.deny\",\n          \"Resolution\": \"Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv105\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted\",\n            \"https://avd.aquasec.com/misconfig/ksv105\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 41,\n            \"EndLine\": 54,\n            \"Code\": {\n              \"Lines\": null\n            }\n          }\n        },\n        {\n          \"Type\": \"Helm Security Check\",\n          \"ID\": \"KSV106\",\n          \"AVDID\": \"AVD-KSV-0106\",\n          \"Title\": \"Container capabilities must only include NET_BIND_SERVICE\",\n          \"Description\": \"Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.\",\n          \"Message\": \"container should not add stuff\",\n          \"Namespace\": \"builtin.kubernetes.KSV106\",\n          \"Query\": \"data.builtin.kubernetes.KSV106.deny\",\n          \"Resolution\": \"Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv106\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted\",\n            \"https://avd.aquasec.com/misconfig/ksv106\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 43,\n            \"EndLine\": 47,\n            \"Code\": {\n              \"Lines\": null\n            }\n          }\n        }\n      ]\n    },\n    {\n      \"Target\": \"infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/deployment-chroma.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"helm\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 1,\n        \"Exceptions\": 0\n      },\n      \"Misconfigurations\": [\n        {\n          \"Type\": \"Helm Security Check\",\n          \"ID\": \"KSV014\",\n          \"AVDID\": \"AVD-KSV-0014\",\n          \"Title\": \"Root file system is not read-only\",\n          \"Description\": \"An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.\",\n          \"Message\": \"Container 'chroma' of Deployment 'portfolio-chroma' should set 'securityContext.readOnlyRootFilesystem' to true\",\n          \"Namespace\": \"builtin.kubernetes.KSV014\",\n          \"Query\": \"data.builtin.kubernetes.KSV014.deny\",\n          \"Resolution\": \"Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv014\",\n          \"References\": [\n            \"https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/\",\n            \"https://avd.aquasec.com/misconfig/ksv014\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 37,\n            \"EndLine\": 87,\n            \"Code\": {\n              \"Lines\": null\n            }\n          }\n        }\n      ]\n    },\n    {\n      \"Target\": \"infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/deployment-ui.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"helm\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/falco-rules.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"helm\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/ingress.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"helm\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/namespace.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"helm\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/networkpolicy.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"helm\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/pvc.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"helm\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/resourcequota.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"helm\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/secret.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"helm\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/securitycontext.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"helm\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/service.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"helm\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/method3-helm-argocd/helm-chart/portfolio/templates/serviceaccount.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"helm\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/shared-security/kubernetes/network-policies/allow-dns.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/shared-security/kubernetes/network-policies/default-deny-all.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/shared-security/kubernetes/pod-security/security-standards.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/shared-security/kubernetes/rbac/role-bindings.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"infrastructure/shared-security/kubernetes/rbac/roles.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 156,\n        \"Failures\": 1,\n        \"Exceptions\": 0\n      },\n      \"Misconfigurations\": [\n        {\n          \"Type\": \"Kubernetes Security Check\",\n          \"ID\": \"KSV113\",\n          \"AVDID\": \"AVD-KSV-0113\",\n          \"Title\": \"Manage namespace secrets\",\n          \"Description\": \"Viewing secrets at the namespace scope can lead to escalation if another service account in that namespace has a higher privileged rolebinding or clusterrolebinding bound.\",\n          \"Message\": \"Role 'app-role' shouldn't have access to manage secrets in namespace 'default'\",\n          \"Namespace\": \"builtin.kubernetes.KSV113\",\n          \"Query\": \"data.builtin.kubernetes.KSV113.deny\",\n          \"Resolution\": \"Manage namespace secrets are not allowed. Remove resource 'secrets' from role\",\n          \"Severity\": \"MEDIUM\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ksv113\",\n          \"References\": [\n            \"https://kubernetes.io/docs/concepts/security/rbac-good-practices/\",\n            \"https://avd.aquasec.com/misconfig/ksv113\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Kubernetes\",\n            \"Service\": \"general\",\n            \"StartLine\": 7,\n            \"EndLine\": 14,\n            \"Code\": {\n              \"Lines\": [\n                {\n                  \"Number\": 7,\n                  \"Content\": \"- apiGroups:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"- \\u001b[38;5;33mapiGroups\\u001b[0m:\",\n                  \"FirstCause\": true,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 8,\n                  \"Content\": \"  - ''\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  - \\u001b[38;5;37m''\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 9,\n                  \"Content\": \"  resources:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"\\u001b[0m  \\u001b[38;5;33mresources\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 10,\n                  \"Content\": \"  - configmaps\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  - configmaps\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 11,\n                  \"Content\": \"  - secrets\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  - secrets\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 12,\n                  \"Content\": \"  verbs:\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  \\u001b[38;5;33mverbs\\u001b[0m:\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 13,\n                  \"Content\": \"  - get\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  - get\",\n                  \"FirstCause\": false,\n                  \"LastCause\": false\n                },\n                {\n                  \"Number\": 14,\n                  \"Content\": \"  - list\",\n                  \"IsCause\": true,\n                  \"Annotation\": \"\",\n                  \"Truncated\": false,\n                  \"Highlighted\": \"  - list\",\n                  \"FirstCause\": false,\n                  \"LastCause\": true\n                }\n              ]\n            }\n          }\n        }\n      ]\n    },\n    {\n      \"Target\": \"infrastructure/shared-security/kubernetes/rbac/service-accounts.yaml\",\n      \"Class\": \"config\",\n      \"Type\": \"kubernetes\",\n      \"MisconfSummary\": {\n        \"Successes\": 157,\n        \"Failures\": 0,\n        \"Exceptions\": 0\n      }\n    },\n    {\n      \"Target\": \"ui/Dockerfile\",\n      \"Class\": \"config\",\n      \"Type\": \"dockerfile\",\n      \"MisconfSummary\": {\n        \"Successes\": 25,\n        \"Failures\": 2,\n        \"Exceptions\": 0\n      },\n      \"Misconfigurations\": [\n        {\n          \"Type\": \"Dockerfile Security Check\",\n          \"ID\": \"DS002\",\n          \"AVDID\": \"AVD-DS-0002\",\n          \"Title\": \"Image user should not be 'root'\",\n          \"Description\": \"Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.\",\n          \"Message\": \"Specify at least 1 USER command in Dockerfile with non-root user as argument\",\n          \"Namespace\": \"builtin.dockerfile.DS002\",\n          \"Query\": \"data.builtin.dockerfile.DS002.deny\",\n          \"Resolution\": \"Add 'USER \\u003cnon root user name\\u003e' line to the Dockerfile\",\n          \"Severity\": \"HIGH\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ds002\",\n          \"References\": [\n            \"https://docs.docker.com/develop/develop-images/dockerfile_best-practices/\",\n            \"https://avd.aquasec.com/misconfig/ds002\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Dockerfile\",\n            \"Service\": \"general\",\n            \"Code\": {\n              \"Lines\": null\n            }\n          }\n        },\n        {\n          \"Type\": \"Dockerfile Security Check\",\n          \"ID\": \"DS026\",\n          \"AVDID\": \"AVD-DS-0026\",\n          \"Title\": \"No HEALTHCHECK defined\",\n          \"Description\": \"You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.\",\n          \"Message\": \"Add HEALTHCHECK instruction in your Dockerfile\",\n          \"Namespace\": \"builtin.dockerfile.DS026\",\n          \"Query\": \"data.builtin.dockerfile.DS026.deny\",\n          \"Resolution\": \"Add HEALTHCHECK instruction in Dockerfile\",\n          \"Severity\": \"LOW\",\n          \"PrimaryURL\": \"https://avd.aquasec.com/misconfig/ds026\",\n          \"References\": [\n            \"https://blog.aquasec.com/docker-security-best-practices\",\n            \"https://avd.aquasec.com/misconfig/ds026\"\n          ],\n          \"Status\": \"FAIL\",\n          \"Layer\": {},\n          \"CauseMetadata\": {\n            \"Provider\": \"Dockerfile\",\n            \"Service\": \"general\",\n            \"Code\": {\n              \"Lines\": null\n            }\n          }\n        }\n      ]\n    },\n    {\n      \"Target\": \"GP-copilot/scan-results/gitleaksnpc.json\",\n      \"Class\": \"secret\",\n      \"Secrets\": [\n        {\n          \"RuleID\": \"github-pat\",\n          \"Category\": \"GitHub\",\n          \"Severity\": \"CRITICAL\",\n          \"Title\": \"GitHub Personal Access Token\",\n          \"StartLine\": 2005,\n          \"EndLine\": 2005,\n          \"Code\": {\n            \"Lines\": [\n              {\n                \"Number\": 2003,\n                \"Content\": \"        \\\"StartColumn\\\": 11,\",\n                \"IsCause\": false,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"StartColumn\\\": 11,\",\n                \"FirstCause\": false,\n                \"LastCause\": false\n              },\n              {\n                \"Number\": 2004,\n                \"Content\": \"        \\\"EndColumn\\\": 50,\",\n                \"IsCause\": false,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"EndColumn\\\": 50,\",\n                \"FirstCause\": false,\n                \"LastCause\": false\n              },\n              {\n                \"Number\": 2005,\n                \"Content\": \"        \\\"Match\\\": \\\"****************************************\\\",\",\n                \"IsCause\": true,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"Match\\\": \\\"****************************************\\\",\",\n                \"FirstCause\": true,\n                \"LastCause\": true\n              },\n              {\n                \"Number\": 2006,\n                \"Content\": \"        \\\"Secret\\\": \\\"****************************************\\\",\",\n                \"IsCause\": false,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"Secret\\\": \\\"****************************************\\\",\",\n                \"FirstCause\": false,\n                \"LastCause\": false\n              }\n            ]\n          },\n          \"Match\": \"        \\\"Match\\\": \\\"****************************************\\\",\",\n          \"Layer\": {}\n        },\n        {\n          \"RuleID\": \"github-pat\",\n          \"Category\": \"GitHub\",\n          \"Severity\": \"CRITICAL\",\n          \"Title\": \"GitHub Personal Access Token\",\n          \"StartLine\": 2006,\n          \"EndLine\": 2006,\n          \"Code\": {\n            \"Lines\": [\n              {\n                \"Number\": 2004,\n                \"Content\": \"        \\\"EndColumn\\\": 50,\",\n                \"IsCause\": false,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"EndColumn\\\": 50,\",\n                \"FirstCause\": false,\n                \"LastCause\": false\n              },\n              {\n                \"Number\": 2005,\n                \"Content\": \"        \\\"Match\\\": \\\"****************************************\\\",\",\n                \"IsCause\": false,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"Match\\\": \\\"****************************************\\\",\",\n                \"FirstCause\": false,\n                \"LastCause\": false\n              },\n              {\n                \"Number\": 2006,\n                \"Content\": \"        \\\"Secret\\\": \\\"****************************************\\\",\",\n                \"IsCause\": true,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"Secret\\\": \\\"****************************************\\\",\",\n                \"FirstCause\": true,\n                \"LastCause\": true\n              },\n              {\n                \"Number\": 2007,\n                \"Content\": \"        \\\"File\\\": \\\".env\\\",\",\n                \"IsCause\": false,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"File\\\": \\\".env\\\",\",\n                \"FirstCause\": false,\n                \"LastCause\": false\n              }\n            ]\n          },\n          \"Match\": \"        \\\"Secret\\\": \\\"****************************************\\\",\",\n          \"Layer\": {}\n        },\n        {\n          \"RuleID\": \"github-pat\",\n          \"Category\": \"GitHub\",\n          \"Severity\": \"CRITICAL\",\n          \"Title\": \"GitHub Personal Access Token\",\n          \"StartLine\": 2365,\n          \"EndLine\": 2365,\n          \"Code\": {\n            \"Lines\": [\n              {\n                \"Number\": 2363,\n                \"Content\": \"        \\\"StartColumn\\\": 15,\",\n                \"IsCause\": false,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"StartColumn\\\": 15,\",\n                \"FirstCause\": false,\n                \"LastCause\": false\n              },\n              {\n                \"Number\": 2364,\n                \"Content\": \"        \\\"EndColumn\\\": 54,\",\n                \"IsCause\": false,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"EndColumn\\\": 54,\",\n                \"FirstCause\": false,\n                \"LastCause\": false\n              },\n              {\n                \"Number\": 2365,\n                \"Content\": \"        \\\"Match\\\": \\\"****************************************\\\",\",\n                \"IsCause\": true,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"Match\\\": \\\"****************************************\\\",\",\n                \"FirstCause\": true,\n                \"LastCause\": true\n              },\n              {\n                \"Number\": 2366,\n                \"Content\": \"        \\\"Secret\\\": \\\"****************************************\\\",\",\n                \"IsCause\": false,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"Secret\\\": \\\"****************************************\\\",\",\n                \"FirstCause\": false,\n                \"LastCause\": false\n              }\n            ]\n          },\n          \"Match\": \"        \\\"Match\\\": \\\"****************************************\\\",\",\n          \"Layer\": {}\n        },\n        {\n          \"RuleID\": \"github-pat\",\n          \"Category\": \"GitHub\",\n          \"Severity\": \"CRITICAL\",\n          \"Title\": \"GitHub Personal Access Token\",\n          \"StartLine\": 2366,\n          \"EndLine\": 2366,\n          \"Code\": {\n            \"Lines\": [\n              {\n                \"Number\": 2364,\n                \"Content\": \"        \\\"EndColumn\\\": 54,\",\n                \"IsCause\": false,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"EndColumn\\\": 54,\",\n                \"FirstCause\": false,\n                \"LastCause\": false\n              },\n              {\n                \"Number\": 2365,\n                \"Content\": \"        \\\"Match\\\": \\\"****************************************\\\",\",\n                \"IsCause\": false,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"Match\\\": \\\"****************************************\\\",\",\n                \"FirstCause\": false,\n                \"LastCause\": false\n              },\n              {\n                \"Number\": 2366,\n                \"Content\": \"        \\\"Secret\\\": \\\"****************************************\\\",\",\n                \"IsCause\": true,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"Secret\\\": \\\"****************************************\\\",\",\n                \"FirstCause\": true,\n                \"LastCause\": true\n              },\n              {\n                \"Number\": 2367,\n                \"Content\": \"        \\\"File\\\": \\\".env\\\",\",\n                \"IsCause\": false,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"File\\\": \\\".env\\\",\",\n                \"FirstCause\": false,\n                \"LastCause\": false\n              }\n            ]\n          },\n          \"Match\": \"        \\\"Secret\\\": \\\"****************************************\\\",\",\n          \"Layer\": {}\n        },\n        {\n          \"RuleID\": \"stripe-secret-token\",\n          \"Category\": \"Stripe\",\n          \"Severity\": \"CRITICAL\",\n          \"Title\": \"Stripe Secret Key\",\n          \"StartLine\": 889,\n          \"EndLine\": 889,\n          \"Code\": {\n            \"Lines\": [\n              {\n                \"Number\": 887,\n                \"Content\": \"        \\\"StartColumn\\\": 75,\",\n                \"IsCause\": false,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"StartColumn\\\": 75,\",\n                \"FirstCause\": false,\n                \"LastCause\": false\n              },\n              {\n                \"Number\": 888,\n                \"Content\": \"        \\\"EndColumn\\\": 94,\",\n                \"IsCause\": false,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"EndColumn\\\": 94,\",\n                \"FirstCause\": false,\n                \"LastCause\": false\n              },\n              {\n                \"Number\": 889,\n                \"Content\": \"        \\\"Match\\\": \\\"********************\\\",\",\n                \"IsCause\": true,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"Match\\\": \\\"********************\\\",\",\n                \"FirstCause\": true,\n                \"LastCause\": true\n              },\n              {\n                \"Number\": 890,\n                \"Content\": \"        \\\"Secret\\\": \\\"********************\\\",\",\n                \"IsCause\": false,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"Secret\\\": \\\"********************\\\",\",\n                \"FirstCause\": false,\n                \"LastCause\": false\n              }\n            ]\n          },\n          \"Match\": \"        \\\"Match\\\": \\\"********************\\\",\",\n          \"Layer\": {}\n        },\n        {\n          \"RuleID\": \"stripe-secret-token\",\n          \"Category\": \"Stripe\",\n          \"Severity\": \"CRITICAL\",\n          \"Title\": \"Stripe Secret Key\",\n          \"StartLine\": 890,\n          \"EndLine\": 890,\n          \"Code\": {\n            \"Lines\": [\n              {\n                \"Number\": 888,\n                \"Content\": \"        \\\"EndColumn\\\": 94,\",\n                \"IsCause\": false,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"EndColumn\\\": 94,\",\n                \"FirstCause\": false,\n                \"LastCause\": false\n              },\n              {\n                \"Number\": 889,\n                \"Content\": \"        \\\"Match\\\": \\\"********************\\\",\",\n                \"IsCause\": false,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"Match\\\": \\\"********************\\\",\",\n                \"FirstCause\": false,\n                \"LastCause\": false\n              },\n              {\n                \"Number\": 890,\n                \"Content\": \"        \\\"Secret\\\": \\\"********************\\\",\",\n                \"IsCause\": true,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"Secret\\\": \\\"********************\\\",\",\n                \"FirstCause\": true,\n                \"LastCause\": true\n              },\n              {\n                \"Number\": 891,\n                \"Content\": \"        \\\"File\\\": \\\"rag-pipeline/01-preprocessing-stages/stages/sanitize_npc.py\\\",\",\n                \"IsCause\": false,\n                \"Annotation\": \"\",\n                \"Truncated\": false,\n                \"Highlighted\": \"        \\\"File\\\": \\\"rag-pipeline/01-preprocessing-stages/stages/sanitize_npc.py\\\",\",\n                \"FirstCause\": false,\n                \"LastCause\": false\n              }\n            ]\n          },\n          \"Match\": \"        \\\"Secret\\\": \\\"********************\\\",\",\n          \"Layer\": {}\n        }\n      ]\n    }\n  ]\n}\n",
  "metadata": {
    "npc_name": "TrivyNPC",
    "tool_name": "trivy",
    "version": "Version: 0.48.0\nVulnerability DB:\n  Version: 2\n  UpdatedAt: 2025-12-08 00:35:48.423342038 +0000 UTC\n  NextUpdate: 2025-12-09 00:35:48.423341768 +0000 UTC\n  DownloadedAt: 2025-12-08 05:45:01.22500462 +0000 UTC\nPolicy Bundle:\n  Digest: sha256:5c4c5f5b566ddbc83888108ba8d6c6f23098cf51a848a8d4f40e2865f18861aa\n  DownloadedAt: 2025-12-29 17:06:40.882095147 +0000 UTC",
    "available": true,
    "type": "npc",
    "requires_ai": false
  },
  "scan_type": "fs",
  "stats": {
    "total_findings": 152,
    "by_severity": {
      "CRITICAL": 6,
      "HIGH": 57,
      "MEDIUM": 23,
      "LOW": 66,
      "INFO": 0
    }
  },
  "timestamp": "2025-12-30T00:46:30.753612",
  "npc_metadata": {
    "npc_name": "TrivyNPC",
    "tool_name": "trivy",
    "version": "Version: 0.48.0\nVulnerability DB:\n  Version: 2\n  UpdatedAt: 2025-12-08 00:35:48.423342038 +0000 UTC\n  NextUpdate: 2025-12-09 00:35:48.423341768 +0000 UTC\n  DownloadedAt: 2025-12-08 05:45:01.22500462 +0000 UTC\nPolicy Bundle:\n  Digest: sha256:5c4c5f5b566ddbc83888108ba8d6c6f23098cf51a848a8d4f40e2865f18861aa\n  DownloadedAt: 2025-12-29 17:06:40.882095147 +0000 UTC",
    "available": true,
    "type": "npc",
    "requires_ai": false
  }
}