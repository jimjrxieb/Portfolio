{{- if .Values.configMap.create }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Values.configMap.name | default (printf "%s-config" (include "portfolio.fullname" .)) }}
  namespace: {{ .Values.global.namespace }}
  labels:
    {{- include "portfolio.labels" . | nindent 4 }}
data:
  # ChromaDB Configuration
  CHROMA_DB_IMPL: {{ .Values.chromadb.env.CHROMA_DB_IMPL | quote }}
  CHROMA_PERSIST_DIRECTORY: {{ .Values.chromadb.env.CHROMA_PERSIST_DIRECTORY | quote }}

  # API Configuration (includes integrated Jade-Brain)
  PYTHONPATH: {{ .Values.api.env.PYTHONPATH | quote }}
  DATA_DIR: {{ .Values.api.env.DATA_DIR | quote }}
  CHROMA_URL: {{ .Values.api.env.CHROMA_URL | quote }}
  GPT_MODEL: {{ .Values.api.env.GPT_MODEL | quote }}

  # UI Environment Variables
  VITE_API_BASE_URL: {{ .Values.ui.env.VITE_API_BASE_URL | quote }}
  VITE_CHROMA_URL: {{ .Values.ui.env.VITE_CHROMA_URL | quote }}
{{- end }}
