# Global configuration
global:
  imageRegistry: ghcr.io
  imagePrefix: jimjrxieb/portfolio
  pullPolicy: Always
  namespace: portfolio

# UI Service (React Frontend)
ui:
  enabled: true
  replicaCount: 1
  image:
    repository: ghcr.io/jimjrxieb/portfolio-ui
    tag: "latest"
    pullPolicy: Always
  service:
    type: LoadBalancer
    port: 3000
    targetPort: 80
  ingress:
    enabled: false # Using LoadBalancer for local testing
  resources:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "256Mi"
      cpu: "500m"
  env:
    VITE_API_BASE_URL: "http://localhost:8000"
    VITE_CHROMA_URL: "http://localhost:8001"

# API Service (FastAPI Backend with integrated Jade-Brain)
api:
  enabled: true
  replicaCount: 1
  image:
    repository: ghcr.io/jimjrxieb/portfolio-api
    tag: "latest"
    pullPolicy: Always
  service:
    type: LoadBalancer
    port: 8000
    targetPort: 8000
  resources:
    requests:
      memory: "512Mi"
      cpu: "200m"
    limits:
      memory: "1Gi"
      cpu: "1000m"
  env:
    PYTHONPATH: "/app"
    DATA_DIR: "/data"
    CHROMA_URL: "http://chromadb:8000"
    GPT_MODEL: "gpt-4o-mini"
    # Jade-Brain is now integrated into API service
  volumeMounts:
    - name: data-volume
      mountPath: /data
  livenessProbe:
    httpGet:
      path: /health
      port: 8000
    initialDelaySeconds: 30
    periodSeconds: 10
  readinessProbe:
    httpGet:
      path: /health
      port: 8000
    initialDelaySeconds: 10
    periodSeconds: 5

# ChromaDB (Vector Database)
chromadb:
  enabled: true
  replicaCount: 1
  image:
    repository: chromadb/chroma
    tag: "latest"
    pullPolicy: Always
  service:
    type: LoadBalancer
    port: 8001
    targetPort: 8000
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  env:
    CHROMA_DB_IMPL: "duckdb+parquet"
    CHROMA_PERSIST_DIRECTORY: "/chroma/data"
  persistence:
    enabled: true
    size: 2Gi
    storageClass: ""
    mountPath: /chroma/data
  livenessProbe:
    httpGet:
      path: /api/v1/heartbeat
      port: 8000
    initialDelaySeconds: 30
    periodSeconds: 10
  readinessProbe:
    httpGet:
      path: /api/v1/heartbeat
      port: 8000
    initialDelaySeconds: 5
    periodSeconds: 5

# NOTE: Avatar Creation and RAG Pipeline services removed
# - Avatar Creation: Functionality integrated into API service
# - RAG Pipeline: Local development tool only, not deployed to Kubernetes

# Secrets configuration
secrets:
  create: true
  name: portfolio-secrets
  data:
    OPENAI_API_KEY: "" # To be provided via values override or Sealed Secrets

# ConfigMap configuration
configMap:
  create: true
  name: portfolio-config
  data:
    # Will be populated from env values above

# Persistence volumes
persistence:
  chromaData:
    enabled: true
    size: 2Gi
    storageClass: ""
    accessModes:
      - ReadWriteOnce
  apiData:
    enabled: true
    size: 1Gi
    storageClass: ""
    accessModes:
      - ReadWriteOnce

# Security context
securityContext:
  runAsNonRoot: true
  runAsUser: 10001
  fsGroup: 10001

# Pod security context
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 10001
  fsGroup: 10001

# Service account
serviceAccount:
  create: true
  annotations: {}
  name: ""

# Network policies
networkPolicy:
  enabled: false
  ingress: []
  egress: []

# Monitoring
monitoring:
  enabled: false
  serviceMonitor:
    enabled: false
    interval: 30s
    scrapeTimeout: 10s
